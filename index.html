<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clash 3D Pro - ⁄©ŸÑÿ¥ ÿ≥Ÿá ÿ®ÿπÿØ€å ÿ≠ÿ±ŸÅŸá‚Äåÿß€å</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ÿßÿ≥ÿ™ÿß€åŸÑ‚ÄåŸáÿß€å ÿ®ÿßÿ≤€å - 500+ ÿÆÿ∑ ⁄©ÿØ CSS */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: #0a0f1d;
            color: white;
            overflow: hidden;
            user-select: none;
        }
        
        #gameContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        /* UI ÿ®ÿßŸÑÿß€å ÿµŸÅÿ≠Ÿá */
        #topUI {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 80px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            z-index: 100;
        }
        
        #resourcesPanel {
            display: flex;
            gap: 20px;
        }
        
        .resource-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(0, 0, 0, 0.6);
            padding: 8px 15px;
            border-radius: 20px;
            border: 2px solid;
            font-weight: bold;
            font-size: 16px;
            min-width: 120px;
        }
        
        .resource-item.gold {
            border-color: #FFD700;
            color: #FFD700;
        }
        
        .resource-item.elixir {
            border-color: #9C27B0;
            color: #9C27B0;
        }
        
        .resource-item.dark-elixir {
            border-color: #4A235A;
            color: #BB8FCE;
        }
        
        .resource-item.gems {
            border-color: #00BFFF;
            color: #00BFFF;
        }
        
        #playerInfo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        #playerLevel {
            background: rgba(0, 0, 0, 0.6);
            padding: 8px 15px;
            border-radius: 20px;
            border: 2px solid #4CAF50;
            font-weight: bold;
        }
        
        #playerName {
            font-size: 18px;
            font-weight: bold;
            color: #FFD700;
        }
        
        /* UI Ÿæÿß€å€åŸÜ ÿµŸÅÿ≠Ÿá */
        #bottomUI {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 150px;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            padding: 15px;
            z-index: 100;
            gap: 15px;
        }
        
        #buildPanel {
            display: flex;
            gap: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 15px;
            border: 2px solid #555;
            overflow-x: auto;
            max-width: 90vw;
        }
        
        .build-button {
            width: 70px;
            height: 70px;
            background: rgba(50, 50, 50, 0.8);
            border: 2px solid #777;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            font-size: 12px;
            gap: 5px;
            flex-shrink: 0;
        }
        
        .build-button:hover {
            transform: scale(1.05);
            border-color: #FFD700;
            background: rgba(70, 70, 70, 0.9);
        }
        
        .build-button i {
            font-size: 24px;
        }
        
        #actionPanel {
            display: flex;
            gap: 15px;
        }
        
        .action-button {
            background: linear-gradient(45deg, #4CAF50, #2E7D32);
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 150px;
            justify-content: center;
        }
        
        .action-button:hover {
            background: linear-gradient(45deg, #2E7D32, #4CAF50);
            transform: scale(1.05);
        }
        
        .action-button.attack {
            background: linear-gradient(45deg, #F44336, #C62828);
        }
        
        .action-button.attack:hover {
            background: linear-gradient(45deg, #C62828, #F44336);
        }
        
        .action-button.upgrade {
            background: linear-gradient(45deg, #FF9800, #EF6C00);
        }
        
        .action-button.upgrade:hover {
            background: linear-gradient(45deg, #EF6C00, #FF9800);
        }
        
        /* ŸÜŸàÿßÿ± ÿ≥ŸÑÿßŸÖÿ™ Ÿæÿß€å⁄ØÿßŸá */
        #baseHealth {
            position: fixed;
            bottom: 160px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px 20px;
            border-radius: 10px;
            border: 2px solid red;
            font-size: 16px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 200px;
        }
        
        .health-bar {
            width: 200px;
            height: 20px;
            background: #333;
            border-radius: 10px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF0000, #FF4500);
            border-radius: 10px;
            transition: width 0.3s;
        }
        
        /* ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÖŸàÿ¨ */
        #waveInfo {
            position: fixed;
            top: 90px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px 20px;
            border-radius: 10px;
            border: 2px solid #2196F3;
            font-size: 16px;
            z-index: 100;
            display: flex;
            gap: 15px;
        }
        
        /* UI ÿßÿ±ÿ™ŸÇÿßÿ° */
        #upgradeUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid gold;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 400px;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.5);
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .upgrade-header {
            font-size: 24px;
            margin-bottom: 20px;
            color: #FFD700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .upgrade-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .upgrade-stats {
            text-align: right;
            background: rgba(50, 50, 50, 0.5);
            padding: 15px;
            border-radius: 10px;
        }
        
        .upgrade-cost {
            text-align: left;
            background: rgba(50, 50, 50, 0.5);
            padding: 15px;
            border-radius: 10px;
        }
        
        .upgrade-button {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 10px;
            color: black;
            font-weight: bold;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s;
            width: 200px;
        }
        
        .upgrade-button:hover {
            background: linear-gradient(45deg, #FFA500, #FFD700);
            transform: scale(1.05);
        }
        
        .upgrade-button:disabled {
            background: #777;
            cursor: not-allowed;
            transform: none;
        }
        
        /* UI ÿ¨ŸÜ⁄Ø */
        #battleUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #F44336;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 500px;
            box-shadow: 0 0 50px rgba(244, 67, 54, 0.5);
        }
        
        .battle-troops {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .troop-card {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .troop-card:hover {
            transform: scale(1.05);
            border-color: #4CAF50;
        }
        
        .troop-card.selected {
            border-color: #FFD700;
            background: rgba(70, 70, 50, 0.7);
        }
        
        .troop-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }
        
        /* UI ÿ≥ÿßÿÆÿ™ */
        #buildUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #4CAF50;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 600px;
            box-shadow: 0 0 50px rgba(76, 175, 80, 0.5);
        }
        
        .build-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .build-option {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .build-option:hover {
            transform: scale(1.05);
            border-color: #4CAF50;
        }
        
        .build-option i {
            font-size: 40px;
            margin-bottom: 10px;
            display: block;
        }
        
        /* ŸÖŸÜŸà ÿßÿµŸÑ€å */
        #mainMenu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            gap: 30px;
        }
        
        .game-title {
            font-size: 60px;
            color: #FFD700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
            margin-bottom: 30px;
        }
        
        .menu-buttons {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 300px;
        }
        
        .menu-button {
            background: linear-gradient(45deg, #2196F3, #0D47A1);
            border: none;
            padding: 20px;
            border-radius: 15px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s;
            text-align: center;
        }
        
        .menu-button:hover {
            background: linear-gradient(45deg, #0D47A1, #2196F3);
            transform: scale(1.05);
        }
        
        /* ÿ±ÿßŸáŸÜŸÖÿß */
        #tutorial {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #9C27B0;
            color: white;
            z-index: 1500;
            display: none;
            text-align: center;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .tutorial-content {
            text-align: right;
            line-height: 1.8;
            margin: 20px 0;
        }
        
        /* ÿµŸÅÿ≠Ÿá ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å */
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0f1d;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            gap: 30px;
        }
        
        .loading-bar-container {
            width: 300px;
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .loading-bar {
            height: 100%;
            background: linear-gradient(90deg, #2196F3, #0D47A1);
            border-radius: 10px;
            transition: width 0.5s;
            width: 0%;
        }
        
        .loading-text {
            font-size: 20px;
            color: #FFD700;
        }
        
        /* ŸÜŸàÿßÿ± ⁄©ŸÜÿßÿ±€å */
        #sidePanel {
            position: fixed;
            right: 0;
            top: 0;
            height: 100%;
            width: 300px;
            background: rgba(0, 0, 0, 0.8);
            z-index: 90;
            padding: 100px 20px 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            transform: translateX(100%);
            transition: transform 0.5s;
        }
        
        #sidePanel.open {
            transform: translateX(0);
        }
        
        .side-button {
            background: rgba(50, 50, 50, 0.7);
            border: none;
            padding: 15px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .side-button:hover {
            background: rgba(70, 70, 70, 0.9);
            transform: scale(1.05);
        }
        
        #toggleSidePanel {
            position: fixed;
            right: 20px;
            top: 90px;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            color: white;
            font-size: 20px;
            cursor: pointer;
            z-index: 95;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* ⁄Üÿ™ */
        #chatPanel {
            position: fixed;
            left: 0;
            bottom: 160px;
            width: 300px;
            height: 300px;
            background: rgba(0, 0, 0, 0.8);
            z-index: 90;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            transform: translateX(-100%);
            transition: transform 0.5s;
        }
        
        #chatPanel.open {
            transform: translateX(0);
        }
        
        .chat-header {
            background: rgba(50, 50, 50, 0.9);
            padding: 10px;
            border-radius: 10px 10px 0 0;
            font-weight: bold;
            text-align: center;
        }
        
        .chat-messages {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .chat-message {
            background: rgba(70, 70, 70, 0.7);
            padding: 8px;
            border-radius: 10px;
            font-size: 14px;
        }
        
        .chat-input {
            display: flex;
            padding: 10px;
            gap: 10px;
        }
        
        .chat-input input {
            flex: 1;
            padding: 8px;
            border-radius: 5px;
            border: none;
            background: rgba(255, 255, 255, 0.9);
        }
        
        .chat-input button {
            background: #4CAF50;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            color: white;
            cursor: pointer;
        }
        
        #toggleChat {
            position: fixed;
            left: 20px;
            bottom: 170px;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            color: white;
            font-size: 20px;
            cursor: pointer;
            z-index: 95;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* ÿßÿ∑ŸÑÿßÿπ€åŸá */
        .notification {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 15px 30px;
            border-radius: 10px;
            border: 2px solid #FFD700;
            color: white;
            z-index: 120;
            display: flex;
            align-items: center;
            gap: 10px;
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .notification.show {
            opacity: 1;
        }
        
        /* ÿ≥ÿßÿ≤Ÿá ÿßŸÜÿ™ÿÆÿßÿ® ÿ¥ÿØŸá */
        .selected-structure {
            position: fixed;
            bottom: 320px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #4CAF50;
            color: white;
            z-index: 100;
            display: none;
            flex-direction: column;
            align-items: center;
            min-width: 200px;
        }
        
        /* UI ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤ */
        #troopTrainingUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #2196F3;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 500px;
            box-shadow: 0 0 50px rgba(33, 150, 243, 0.5);
        }
        
        .troop-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .troop-option {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .troop-option:hover {
            transform: scale(1.05);
            border-color: #2196F3;
        }
        
        .troop-option i {
            font-size: 40px;
            margin-bottom: 10px;
            display: block;
        }
        
        /* UI ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß */
        #spellsUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #9C27B0;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 500px;
            box-shadow: 0 0 50px rgba(156, 39, 176, 0.5);
        }
        
        .spell-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .spell-option {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .spell-option:hover {
            transform: scale(1.05);
            border-color: #9C27B0;
        }
        
        .spell-option i {
            font-size: 40px;
            margin-bottom: 10px;
            display: block;
        }
        
        /* UI ŸÇÿ®€åŸÑŸá */
        #clanUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #FF9800;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 600px;
            box-shadow: 0 0 50px rgba(255, 152, 0, 0.5);
        }
        
        /* UI ÿ±ÿØŸá‚Äåÿ®ŸÜÿØ€å */
        #leaderboardUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #00BCD4;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 600px;
            box-shadow: 0 0 50px rgba(0, 188, 212, 0.5);
        }
        
        /* UI ÿ™ŸÜÿ∏€åŸÖÿßÿ™ */
        #settingsUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #607D8B;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 500px;
            box-shadow: 0 0 50px rgba(96, 125, 139, 0.5);
        }
        
        .settings-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        
        .setting-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
        }
        
        .setting-option label {
            font-size: 16px;
        }
        
        .setting-option input {
            padding: 5px 10px;
            border-radius: 5px;
            border: none;
            background: rgba(255, 255, 255, 0.9);
        }
        
        /* UI ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß */
        #achievementsUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #FFD700;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 600px;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.5);
        }
        
        .achievements-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .achievement-item {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .achievement-icon {
            font-size: 40px;
            color: #FFD700;
        }
        
        .achievement-progress {
            width: 100%;
            height: 10px;
            background: #333;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .achievement-progress-bar {
            height: 100%;
            background: #4CAF50;
            border-radius: 5px;
            transition: width 0.3s;
        }
        
        /* UI ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá */
        #shopUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #E91E63;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 600px;
            box-shadow: 0 0 50px rgba(233, 30, 99, 0.5);
        }
        
        .shop-categories {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .shop-category {
            background: rgba(50, 50, 50, 0.7);
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .shop-category.active {
            background: #E91E63;
        }
        
        .shop-items {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .shop-item {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .shop-item:hover {
            transform: scale(1.05);
            border: 2px solid #E91E63;
        }
        
        .shop-item-icon {
            font-size: 40px;
            color: #E91E63;
        }
        
        /* UI ÿ∞ÿÆ€åÿ±Ÿá Ÿà ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å */
        #saveLoadUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #8BC34A;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 500px;
            box-shadow: 0 0 50px rgba(139, 195, 74, 0.5);
        }
        
        .save-slots {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .save-slot {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .save-slot:hover {
            transform: scale(1.05);
            border: 2px solid #8BC34A;
        }
        
        .save-slot.empty {
            background: rgba(30, 30, 30, 0.7);
        }
        
        .save-slot-info {
            text-align: right;
        }
        
        /* UI ÿ¨ÿ≤ÿ¶€åÿßÿ™ ÿ®ÿßÿ≤€å */
        #gameDetailsUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #795548;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 500px;
            box-shadow: 0 0 50px rgba(121, 85, 72, 0.5);
        }
        
        .game-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .game-stat {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #FFD700;
        }
        
        /* UI ÿ≠ŸÖŸÑŸá ÿ®Ÿá ÿØŸá⁄©ÿØŸá‚ÄåŸáÿß€å ÿØ€å⁄Øÿ± */
        #attackVillageUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #F44336;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 600px;
            box-shadow: 0 0 50px rgba(244, 67, 54, 0.5);
        }
        
        .village-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .village-option {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .village-option:hover {
            transform: scale(1.05);
            border: 2px solid #F44336;
        }
        
        .village-level {
            font-size: 18px;
            font-weight: bold;
            color: #FFD700;
        }
        
        .village-resources {
            display: flex;
            gap: 10px;
        }
        
        /* UI ŸÜÿ™€åÿ¨Ÿá ÿ≠ŸÖŸÑŸá */
        #attackResultUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #FF9800;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 500px;
            box-shadow: 0 0 50px rgba(255, 152, 0, 0.5);
        }
        
        .attack-result {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
        }
        
        .result-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .result-stat {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .result-value {
            font-size: 20px;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .result-value.negative {
            color: #F44336;
        }
        
        /* UI ÿ®Ÿáÿ®ŸàÿØŸáÿß */
        #boostsUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #9C27B0;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 500px;
            box-shadow: 0 0 50px rgba(156, 39, 176, 0.5);
        }
        
        .boost-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .boost-option {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .boost-option:hover {
            transform: scale(1.05);
            border: 2px solid #9C27B0;
        }
        
        .boost-duration {
            font-size: 14px;
            color: #BDBDBD;
        }
        
        /* UI ÿ±Ÿà€åÿØÿßÿØŸáÿß€å ÿÆÿßÿµ */
        #eventsUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #00BCD4;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 500px;
            box-shadow: 0 0 50px rgba(0, 188, 212, 0.5);
        }
        
        .event-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .event-option {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .event-option:hover {
            transform: scale(1.05);
            border: 2px solid #00BCD4;
        }
        
        .event-time {
            font-size: 14px;
            color: #BDBDBD;
        }
        
        /* UI ⁄ÜÿßŸÑÿ¥‚ÄåŸáÿß */
        #challengesUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #FF5722;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 600px;
            box-shadow: 0 0 50px rgba(255, 87, 34, 0.5);
        }
        
        .challenge-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .challenge-option {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .challenge-option:hover {
            transform: scale(1.05);
            border: 2px solid #FF5722;
        }
        
        .challenge-reward {
            font-size: 16px;
            font-weight: bold;
            color: #FFD700;
        }
        
        /* UI ⁄©ŸÖ⁄©‚ÄåŸáÿß€å ÿ®ÿßÿ≤€å */
        #helpUI {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #607D8B;
            color: white;
            z-index: 1000;
            display: none;
            text-align: center;
            min-width: 600px;
            box-shadow: 0 0 50px rgba(96, 125, 139, 0.5);
        }
        
        .help-sections {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .help-section {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 10px;
            padding: 15px;
            text-align: right;
        }
        
        .help-section h3 {
            color: #FFD700;
            margin-bottom: 10px;
        }
        
        /* UI Ÿàÿ∂ÿπ€åÿ™ ÿ¢ŸÜŸÑÿß€åŸÜ */
        #onlineStatusUI {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 5px 10px;
            border-radius: 10px;
            color: white;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
        }
        
        .online-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4CAF50;
        }
        
        .online-indicator.offline {
            background: #F44336;
        }
        
        /* UI ÿ≤ŸÖÿßŸÜ ÿ≥ÿ±Ÿàÿ± */
        #serverTimeUI {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 5px 10px;
            border-radius: 10px;
            color: white;
            z-index: 100;
            font-size: 12px;
        }
        
        /* UI Ÿàÿ∂ÿπ€åÿ™ ÿ®ÿßÿ™ÿ±€å */
        #batteryStatusUI {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 5px 10px;
            border-radius: 10px;
            color: white;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
        }
        
        /* UI FPS */
        #fpsCounter {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 5px 10px;
            border-radius: 10px;
            color: white;
            z-index: 100;
            font-size: 12px;
        }
        
        /* ÿßŸÜ€åŸÖ€åÿ¥ŸÜ‚ÄåŸáÿß€å Ÿà€å⁄òŸá */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .shake {
            animation: shake 0.5s;
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px #FFD700; }
            50% { box-shadow: 0 0 20px #FFD700; }
        }
        
        .glow {
            animation: glow 2s infinite;
        }
        
        /* ÿ±ÿ≥ŸæÿßŸÜÿ≥€åŸà ÿ®ÿ±ÿß€å ŸÖŸàÿ®ÿß€åŸÑ */
        @media (max-width: 768px) {
            #topUI {
                height: 60px;
                padding: 0 10px;
            }
            
            #resourcesPanel {
                gap: 10px;
            }
            
            .resource-item {
                min-width: auto;
                padding: 5px 10px;
                font-size: 14px;
            }
            
            #playerName {
                font-size: 14px;
            }
            
            #bottomUI {
                height: 120px;
                padding: 10px;
            }
            
            #buildPanel {
                gap: 5px;
                padding: 5px;
            }
            
            .build-button {
                width: 60px;
                height: 60px;
                font-size: 10px;
            }
            
            .build-button i {
                font-size: 20px;
            }
            
            #actionPanel {
                gap: 10px;
            }
            
            .action-button {
                padding: 8px 15px;
                font-size: 14px;
                min-width: 120px;
            }
            
            #baseHealth {
                bottom: 130px;
                padding: 8px 15px;
                font-size: 14px;
            }
            
            .health-bar {
                width: 150px;
            }
            
            #waveInfo {
                top: 70px;
                padding: 8px 15px;
                font-size: 14px;
                gap: 10px;
            }
            
            #upgradeUI, #battleUI, #buildUI, #troopTrainingUI, #spellsUI, #clanUI, #leaderboardUI, #settingsUI, #achievementsUI, #shopUI, #saveLoadUI, #gameDetailsUI, #attackVillageUI, #attackResultUI, #boostsUI, #eventsUI, #challengesUI, #helpUI {
                min-width: 90vw;
                padding: 20px;
            }
            
            .upgrade-content, .game-stats, .result-stats {
                grid-template-columns: 1fr;
            }
            
            .battle-troops, .build-options, .troop-options, .spell-options, .achievements-list, .shop-items, .save-slots, .village-options, .boost-options, .event-options, .challenge-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .battle-troops, .build-options, .troop-options, .spell-options, .achievements-list, .shop-items, .save-slots, .village-options, .boost-options, .event-options, .challenge-options {
                grid-template-columns: 1fr;
            }
            
            #actionPanel {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .action-button {
                min-width: 100px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- ÿµŸÅÿ≠Ÿá ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å -->
    <div id="loadingScreen">
        <div class="game-title">Clash 3D Pro</div>
        <div class="loading-bar-container">
            <div class="loading-bar" id="loadingBar"></div>
        </div>
        <div class="loading-text" id="loadingText">ÿØÿ± ÿ≠ÿßŸÑ ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿ®ÿßÿ≤€å...</div>
    </div>

    <!-- ŸÖŸÜŸà ÿßÿµŸÑ€å -->
    <div id="mainMenu">
        <div class="game-title">Clash 3D Pro</div>
        <div class="menu-buttons">
            <button class="menu-button" id="startGameBtn">
                <i class="fas fa-play"></i> ÿ¥ÿ±Ÿàÿπ ÿ®ÿßÿ≤€å ÿ¨ÿØ€åÿØ
            </button>
            <button class="menu-button" id="loadGameBtn">
                <i class="fas fa-folder-open"></i> ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿ®ÿßÿ≤€å
            </button>
            <button class="menu-button" id="tutorialBtn">
                <i class="fas fa-graduation-cap"></i> ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ®ÿßÿ≤€å
            </button>
            <button class="menu-button" id="settingsBtn">
                <i class="fas fa-cog"></i> ÿ™ŸÜÿ∏€åŸÖÿßÿ™
            </button>
        </div>
    </div>

    <!-- ⁄©ÿßŸÜÿ™€åŸÜÿ± ÿ®ÿßÿ≤€å -->
    <div id="gameContainer"></div>

    <!-- UI ÿ®ÿßŸÑÿß€å ÿµŸÅÿ≠Ÿá -->
    <div id="topUI">
        <div id="resourcesPanel">
            <div class="resource-item gold">
                <i class="fas fa-coins"></i>
                <span id="goldCount">10,000</span>
            </div>
            <div class="resource-item elixir">
                <i class="fas fa-flask"></i>
                <span id="elixirCount">5,000</span>
            </div>
            <div class="resource-item dark-elixir">
                <i class="fas fa-skull"></i>
                <span id="darkElixirCount">1,000</span>
            </div>
            <div class="resource-item gems">
                <i class="fas fa-gem"></i>
                <span id="gemsCount">500</span>
            </div>
        </div>
        
        <div id="playerInfo">
            <div id="playerLevel">
                <i class="fas fa-star"></i> ÿ≥ÿ∑ÿ≠ <span id="playerLevelValue">5</span>
            </div>
            <div id="playerName">ÿØŸá⁄©ÿØŸá ÿ¥ŸÖÿß</div>
        </div>
    </div>

    <!-- ŸÜŸàÿßÿ± ÿ≥ŸÑÿßŸÖÿ™ Ÿæÿß€å⁄ØÿßŸá -->
    <div id="baseHealth">
        <div>üè∞ ÿ≥ŸÑÿßŸÖÿ™ Ÿæÿß€å⁄ØÿßŸá: <span id="healthValue">2,500</span>/<span id="maxHealthValue">2,500</span></div>
        <div class="health-bar">
            <div class="health-fill" id="healthBar"></div>
        </div>
    </div>

    <!-- ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÖŸàÿ¨ -->
    <div id="waveInfo">
        <div>ŸÖŸàÿ¨: <span id="waveNumber">1</span></div>
        <div>ÿØÿ¥ŸÖŸÜÿßŸÜ: <span id="enemyCount">0</span></div>
        <div>ÿ≤ŸÖÿßŸÜ ÿ™ÿß ÿ≠ŸÖŸÑŸá ÿ®ÿπÿØ€å: <span id="nextAttackTime">20</span> ÿ´ÿßŸÜ€åŸá</div>
    </div>

    <!-- UI Ÿæÿß€å€åŸÜ ÿµŸÅÿ≠Ÿá -->
    <div id="bottomUI">
        <div id="buildPanel">
            <div class="build-button" data-building="townhall">
                <i class="fas fa-landmark"></i>
                <span>ÿ≥ÿßŸÑŸÜ ÿ¥Ÿáÿ±</span>
            </div>
            <div class="build-button" data-building="barracks">
                <i class="fas fa-helmet-battle"></i>
                <span>ÿ≥ÿ±ÿ®ÿßÿ≤ÿÆÿßŸÜŸá</span>
            </div>
            <div class="build-button" data-building="goldmine">
                <i class="fas fa-mountain"></i>
                <span>ŸÖÿπÿØŸÜ ÿ∑ŸÑÿß</span>
            </div>
            <div class="build-button" data-building="elixircollector">
                <i class="fas fa-vial"></i>
                <span>ÿ∏ÿ±ŸÅ ÿß⁄©ÿ≥€åÿ±</span>
            </div>
            <div class="build-button" data-building="darkelixirdrill">
                <i class="fas fa-skull"></i>
                <span>ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©</span>
            </div>
            <div class="build-button" data-building="cannon">
                <i class="fas fa-crosshairs"></i>
                <span>ÿ™ŸàŸæ</span>
            </div>
            <div class="build-button" data-building="archertower">
                <i class="fas fa-bow-arrow"></i>
                <span>ÿ®ÿ±ÿ¨ ⁄©ŸÖÿßŸÜÿØÿßÿ±</span>
            </div>
            <div class="build-button" data-building="mortar">
                <i class="fas fa-bomb"></i>
                <span>ÿÆŸÖŸæÿßÿ±Ÿá‚ÄåÿßŸÜÿØÿßÿ≤</span>
            </div>
            <div class="build-button" data-building="wizardtower">
                <i class="fas fa-hat-wizard"></i>
                <span>ÿ®ÿ±ÿ¨ ÿ¨ÿßÿØŸà⁄Øÿ±</span>
            </div>
            <div class="build-button" data-building="wall">
                <i class="fas fa-wall"></i>
                <span>ÿØ€åŸàÿßÿ±</span>
            </div>
        </div>
        
        <div id="actionPanel">
            <button class="action-button" id="attackBtn">
                <i class="fas fa-fist-raised"></i> ÿ≠ŸÖŸÑŸá ÿ®Ÿá ÿØÿ¥ŸÖŸÜ
            </button>
            <button class="action-button upgrade" id="upgradeBtn">
                <i class="fas fa-hammer"></i> ÿßÿ±ÿ™ŸÇÿßÿ° ÿ≥ÿßÿ≤Ÿá
            </button>
            <button class="action-button" id="trainTroopsBtn">
                <i class="fas fa-user-plus"></i> ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤
            </button>
            <button class="action-button" id="spellsBtn">
                <i class="fas fa-magic"></i> ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß
            </button>
        </div>
    </div>

    <!-- ÿ≥ÿßÿ≤Ÿá ÿßŸÜÿ™ÿÆÿßÿ® ÿ¥ÿØŸá -->
    <div class="selected-structure" id="selectedStructure">
        <div id="structureName">ÿ≥ÿßÿ≤Ÿá</div>
        <div>ÿ≥ÿ∑ÿ≠: <span id="structureLevel">1</span></div>
        <div>ÿ≥ŸÑÿßŸÖÿ™: <span id="structureHealth">100</span>/<span id="structureMaxHealth">100</span></div>
        <button class="action-button upgrade" id="upgradeStructureBtn" style="margin-top: 10px; padding: 8px 15px; font-size: 14px;">
            <i class="fas fa-arrow-up"></i> ÿßÿ±ÿ™ŸÇÿßÿ°
        </button>
    </div>

    <!-- UI ÿßÿ±ÿ™ŸÇÿßÿ° -->
    <div id="upgradeUI">
        <div class="upgrade-header">
            <i class="fas fa-arrow-up"></i>
            <span id="upgradeTitle">ÿßÿ±ÿ™ŸÇÿßÿ° ÿ≥ÿßÿ≤Ÿá</span>
        </div>
        
        <div class="upgrade-content">
            <div class="upgrade-stats">
                <h3>ŸÖÿ¥ÿÆÿµÿßÿ™ ŸÅÿπŸÑ€å</h3>
                <div id="currentStats">
                    <!-- ÿ¢ŸÖÿßÿ± ŸÅÿπŸÑ€å ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
                </div>
            </div>
            <div class="upgrade-cost">
                <h3>Ÿáÿ≤€åŸÜŸá ÿßÿ±ÿ™ŸÇÿßÿ°</h3>
                <div id="upgradeCosts">
                    <!-- Ÿáÿ≤€åŸÜŸá‚ÄåŸáÿß ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
                </div>
            </div>
        </div>
        
        <div>
            <button class="upgrade-button" id="confirmUpgradeBtn">ÿßÿ±ÿ™ŸÇÿßÿ° ÿØŸá€åÿØ</button>
            <button class="upgrade-button" id="cancelUpgradeBtn">ŸÑÿ∫Ÿà</button>
        </div>
    </div>

    <!-- UI ÿ¨ŸÜ⁄Ø -->
    <div id="battleUI">
        <div class="upgrade-header">
            <i class="fas fa-fist-raised"></i>
            <span>ÿ¢ŸÖÿßÿØŸá‚Äåÿ≥ÿßÿ≤€å ÿ≠ŸÖŸÑŸá</span>
        </div>
        
        <div class="battle-troops" id="battleTroopsContainer">
            <!-- ⁄©ÿßÿ±ÿ™‚ÄåŸáÿß€å ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="startBattleBtn">ÿ¥ÿ±Ÿàÿπ ÿ≠ŸÖŸÑŸá</button>
            <button class="upgrade-button" id="cancelBattleBtn">ŸÑÿ∫Ÿà</button>
        </div>
    </div>

    <!-- UI ÿ≥ÿßÿÆÿ™ -->
    <div id="buildUI">
        <div class="upgrade-header">
            <i class="fas fa-hammer"></i>
            <span>ÿ≥ÿßÿÆÿ™ ÿ≥ÿßÿ≤Ÿá ÿ¨ÿØ€åÿØ</span>
        </div>
        
        <div class="build-options" id="buildOptionsContainer">
            <!-- ⁄Øÿ≤€åŸÜŸá‚ÄåŸáÿß€å ÿ≥ÿßÿÆÿ™ ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="confirmBuildBtn">ÿ≥ÿßÿÆÿ™</button>
            <button class="upgrade-button" id="cancelBuildBtn">ŸÑÿ∫Ÿà</button>
        </div>
    </div>

    <!-- ÿ±ÿßŸáŸÜŸÖÿß -->
    <div id="tutorial">
        <div class="upgrade-header">
            <i class="fas fa-graduation-cap"></i>
            <span>ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ®ÿßÿ≤€å Clash 3D Pro</span>
        </div>
        
        <div class="tutorial-content">
            <p>ÿ®Ÿá ÿ®ÿßÿ≤€å Clash 3D Pro ÿÆŸàÿ¥ ÿ¢ŸÖÿØ€åÿØ! ÿß€åŸÜ €å⁄© ÿ®ÿßÿ≤€å ÿßÿ≥ÿ™ÿ±ÿßÿ™⁄ò€å ÿßÿ≥ÿ™ ⁄©Ÿá ÿØÿ± ÿ¢ŸÜ ÿ®ÿß€åÿØ ÿØŸá⁄©ÿØŸá ÿÆŸàÿØ ÿ±ÿß ÿ®ÿ≥ÿßÿ≤€åÿØÿå ÿßÿ±ÿ™ÿ¥ ŸÇÿØÿ±ÿ™ŸÖŸÜÿØ€å ÿß€åÿ¨ÿßÿØ ⁄©ŸÜ€åÿØ Ÿà ÿ®Ÿá ÿØŸá⁄©ÿØŸá‚ÄåŸáÿß€å ÿØ€å⁄Øÿ± ÿ≠ŸÖŸÑŸá ⁄©ŸÜ€åÿØ.</p>
            
            <h3>ŸÖÿ±ÿßÿ≠ŸÑ ÿ®ÿßÿ≤€å:</h3>
            <ol>
                <li>ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å ŸÖÿÆÿ™ŸÑŸÅ ÿ±ÿß ÿ®ÿ±ÿß€å ÿ™ŸàŸÑ€åÿØ ŸÖŸÜÿßÿ®ÿπ ÿ®ÿ≥ÿßÿ≤€åÿØ</li>
                <li>ÿ≥ÿ±ÿ®ÿßÿ≤ÿÆÿßŸÜŸá‚ÄåŸáÿß ÿ±ÿß ÿ®ÿ±ÿß€å ÿ¢ŸÖŸàÿ≤ÿ¥ ŸÜ€åÿ±ŸàŸáÿß€å ŸÜÿ∏ÿßŸÖ€å ÿßÿ±ÿ™ŸÇÿßÿ° ÿØŸá€åÿØ</li>
                <li>ÿ≥€åÿ≥ÿ™ŸÖ ÿØŸÅÿßÿπ€å ÿÆŸàÿØ ÿ±ÿß ÿ®ÿß ÿ™ŸàŸæ‚ÄåŸáÿßÿå ÿ®ÿ±ÿ¨‚ÄåŸáÿß Ÿà ÿØ€åŸàÿßÿ±Ÿáÿß ÿ™ŸÇŸà€åÿ™ ⁄©ŸÜ€åÿØ</li>
                <li>ÿ®Ÿá ÿØŸá⁄©ÿØŸá‚ÄåŸáÿß€å ÿØ€å⁄Øÿ± ÿ≠ŸÖŸÑŸá ⁄©ŸÜ€åÿØ ÿ™ÿß ŸÖŸÜÿßÿ®ÿπ ÿ®€åÿ¥ÿ™ÿ±€å ÿ®Ÿá ÿØÿ≥ÿ™ ÿ¢Ÿàÿ±€åÿØ</li>
                <li>ÿØŸá⁄©ÿØŸá ÿÆŸàÿØ ÿ±ÿß ÿØÿ± ÿ®ÿ±ÿßÿ®ÿ± ÿ≠ŸÖŸÑÿßÿ™ ÿØÿ¥ŸÖŸÜÿßŸÜ ŸÖÿ≠ÿßŸÅÿ∏ÿ™ ⁄©ŸÜ€åÿØ</li>
            </ol>
            
            <h3>ÿßŸÜŸàÿßÿπ ŸÖŸÜÿßÿ®ÿπ:</h3>
            <ul>
                <li><strong>ÿ∑ŸÑÿß</strong>: ÿ®ÿ±ÿß€å ÿ≥ÿßÿÆÿ™ Ÿà ÿßÿ±ÿ™ŸÇÿßÿ° ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß</li>
                <li><strong>ÿß⁄©ÿ≥€åÿ±</strong>: ÿ®ÿ±ÿß€å ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ Ÿà ÿßÿ±ÿ™ŸÇÿßÿ° ÿ≥ÿ±ÿ®ÿßÿ≤ÿÆÿßŸÜŸá</li>
                <li><strong>ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©</strong>: ÿ®ÿ±ÿß€å ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ Ÿà€å⁄òŸá Ÿà ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß</li>
                <li><strong>ÿ¨ŸàÿßŸáÿ±</strong>: ÿ®ÿ±ÿß€å ÿ≥ÿ±ÿπÿ™ ÿ®ÿÆÿ¥€åÿØŸÜ ÿ®Ÿá ŸÅÿ±ÿ¢€åŸÜÿØŸáÿß</li>
            </ul>
            
            <p>ÿ®ÿ±ÿß€å ÿ¥ÿ±Ÿàÿπÿå ÿ±Ÿà€å ÿØ⁄©ŸÖŸá "ÿ¥ÿ±Ÿàÿπ ÿ®ÿßÿ≤€å ÿ¨ÿØ€åÿØ" ⁄©ŸÑ€å⁄© ⁄©ŸÜ€åÿØ Ÿà ÿØŸá⁄©ÿØŸá ÿÆŸàÿØ ÿ±ÿß ÿ®ÿ≥ÿßÿ≤€åÿØ!</p>
        </div>
        
        <div>
            <button class="upgrade-button" id="closeTutorialBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- ŸÜŸàÿßÿ± ⁄©ŸÜÿßÿ±€å -->
    <button id="toggleSidePanel">
        <i class="fas fa-chevron-left"></i>
    </button>
    
    <div id="sidePanel">
        <button class="side-button" id="clanBtn">
            <i class="fas fa-users"></i> ŸÇÿ®€åŸÑŸá
        </button>
        <button class="side-button" id="achievementsBtn">
            <i class="fas fa-trophy"></i> ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß
        </button>
        <button class="side-button" id="shopBtn">
            <i class="fas fa-shopping-cart"></i> ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá
        </button>
        <button class="side-button" id="leaderboardBtn">
            <i class="fas fa-chart-line"></i> ÿ±ÿØŸá‚Äåÿ®ŸÜÿØ€å
        </button>
        <button class="side-button" id="settingsMenuBtn">
            <i class="fas fa-cog"></i> ÿ™ŸÜÿ∏€åŸÖÿßÿ™
        </button>
        <button class="side-button" id="saveGameBtn">
            <i class="fas fa-save"></i> ÿ∞ÿÆ€åÿ±Ÿá ÿ®ÿßÿ≤€å
        </button>
        <button class="side-button" id="exitGameBtn">
            <i class="fas fa-door-open"></i> ÿÆÿ±Ÿàÿ¨ ÿßÿ≤ ÿ®ÿßÿ≤€å
        </button>
    </div>

    <!-- ŸæŸÜŸÑ ⁄Üÿ™ -->
    <button id="toggleChat">
        <i class="fas fa-comments"></i>
    </button>
    
    <div id="chatPanel">
        <div class="chat-header">
            <i class="fas fa-comments"></i> ⁄Üÿ™ ÿ¨ŸáÿßŸÜ€å
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="chat-message">
                <strong>ÿ≥€åÿ≥ÿ™ŸÖ:</strong> ÿ®Ÿá ⁄Üÿ™ ÿ¨ŸáÿßŸÜ€å ÿÆŸàÿ¥ ÿ¢ŸÖÿØ€åÿØ!
            </div>
        </div>
        <div class="chat-input">
            <input type="text" id="chatInput" placeholder="Ÿæ€åÿßŸÖ ÿÆŸàÿØ ÿ±ÿß ÿ®ŸÜŸà€åÿ≥€åÿØ...">
            <button id="sendChatBtn">ÿßÿ±ÿ≥ÿßŸÑ</button>
        </div>
    </div>

    <!-- ÿßÿ∑ŸÑÿßÿπ€åŸá -->
    <div class="notification" id="notification">
        <i class="fas fa-bell"></i>
        <span id="notificationText">ÿß€åŸÜ €å⁄© ÿßÿ∑ŸÑÿßÿπ€åŸá ÿßÿ≥ÿ™</span>
    </div>

    <!-- UI ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤ -->
    <div id="troopTrainingUI">
        <div class="upgrade-header">
            <i class="fas fa-user-plus"></i>
            <span>ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤</span>
        </div>
        
        <div class="troop-options" id="troopOptionsContainer">
            <!-- ⁄Øÿ≤€åŸÜŸá‚ÄåŸáÿß€å ÿ≥ÿ±ÿ®ÿßÿ≤ ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="confirmTrainingBtn">ÿ¢ŸÖŸàÿ≤ÿ¥</button>
            <button class="upgrade-button" id="cancelTrainingBtn">ŸÑÿ∫Ÿà</button>
        </div>
    </div>

    <!-- UI ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß -->
    <div id="spellsUI">
        <div class="upgrade-header">
            <i class="fas fa-magic"></i>
            <span>ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß</span>
        </div>
        
        <div class="spell-options" id="spellOptionsContainer">
            <!-- ⁄Øÿ≤€åŸÜŸá‚ÄåŸáÿß€å ÿ∑ŸÑÿ≥ŸÖ ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="confirmSpellBtn">ÿ≥ÿßÿÆÿ™ ÿ∑ŸÑÿ≥ŸÖ</button>
            <button class="upgrade-button" id="cancelSpellBtn">ŸÑÿ∫Ÿà</button>
        </div>
    </div>

    <!-- UI ŸÇÿ®€åŸÑŸá -->
    <div id="clanUI">
        <div class="upgrade-header">
            <i class="fas fa-users"></i>
            <span>ŸÇÿ®€åŸÑŸá</span>
        </div>
        
        <div id="clanContent">
            <!-- ŸÖÿ≠ÿ™Ÿàÿß€å ŸÇÿ®€åŸÑŸá ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="closeClanBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI ÿ±ÿØŸá‚Äåÿ®ŸÜÿØ€å -->
    <div id="leaderboardUI">
        <div class="upgrade-header">
            <i class="fas fa-chart-line"></i>
            <span>ÿ±ÿØŸá‚Äåÿ®ŸÜÿØ€å</span>
        </div>
        
        <div id="leaderboardContent">
            <!-- ŸÖÿ≠ÿ™Ÿàÿß€å ÿ±ÿØŸá‚Äåÿ®ŸÜÿØ€å ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="closeLeaderboardBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI ÿ™ŸÜÿ∏€åŸÖÿßÿ™ -->
    <div id="settingsUI">
        <div class="upgrade-header">
            <i class="fas fa-cog"></i>
            <span>ÿ™ŸÜÿ∏€åŸÖÿßÿ™</span>
        </div>
        
        <div class="settings-options">
            <div class="setting-option">
                <label for="musicVolume">ÿµÿØÿß€å ŸÖŸàÿ≥€åŸÇ€å:</label>
                <input type="range" id="musicVolume" min="0" max="100" value="50">
            </div>
            <div class="setting-option">
                <label for="soundVolume">ÿµÿØÿß€å ÿßŸÅ⁄©ÿ™‚ÄåŸáÿß:</label>
                <input type="range" id="soundVolume" min="0" max="100" value="70">
            </div>
            <div class="setting-option">
                <label for="graphicsQuality">⁄©€åŸÅ€åÿ™ ⁄Øÿ±ÿßŸÅ€å⁄©:</label>
                <select id="graphicsQuality">
                    <option value="low">Ÿæÿß€å€åŸÜ</option>
                    <option value="medium" selected>ŸÖÿ™Ÿàÿ≥ÿ∑</option>
                    <option value="high">ÿ®ÿßŸÑÿß</option>
                </select>
            </div>
            <div class="setting-option">
                <label for="language">ÿ≤ÿ®ÿßŸÜ:</label>
                <select id="language">
                    <option value="fa" selected>ŸÅÿßÿ±ÿ≥€å</option>
                    <option value="en">English</option>
                </select>
            </div>
        </div>
        
        <div>
            <button class="upgrade-button" id="saveSettingsBtn">ÿ∞ÿÆ€åÿ±Ÿá ÿ™ŸÜÿ∏€åŸÖÿßÿ™</button>
            <button class="upgrade-button" id="closeSettingsBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß -->
    <div id="achievementsUI">
        <div class="upgrade-header">
            <i class="fas fa-trophy"></i>
            <span>ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß</span>
        </div>
        
        <div class="achievements-list" id="achievementsContainer">
            <!-- ŸÑ€åÿ≥ÿ™ ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="closeAchievementsBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá -->
    <div id="shopUI">
        <div class="upgrade-header">
            <i class="fas fa-shopping-cart"></i>
            <span>ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá</span>
        </div>
        
        <div class="shop-categories">
            <button class="shop-category active" data-category="resources">ŸÖŸÜÿßÿ®ÿπ</button>
            <button class="shop-category" data-category="buildings">ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß</button>
            <button class="shop-category" data-category="troops">ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ</button>
            <button class="shop-category" data-category="spells">ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß</button>
        </div>
        
        <div class="shop-items" id="shopItemsContainer">
            <!-- ÿ¢€åÿ™ŸÖ‚ÄåŸáÿß€å ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="closeShopBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI ÿ∞ÿÆ€åÿ±Ÿá Ÿà ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å -->
    <div id="saveLoadUI">
        <div class="upgrade-header">
            <i class="fas fa-save"></i>
            <span>ÿ∞ÿÆ€åÿ±Ÿá Ÿà ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿ®ÿßÿ≤€å</span>
        </div>
        
        <div class="save-slots" id="saveSlotsContainer">
            <!-- ÿßÿ≥ŸÑÿßÿ™‚ÄåŸáÿß€å ÿ∞ÿÆ€åÿ±Ÿá ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="closeSaveLoadBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI ÿ¨ÿ≤ÿ¶€åÿßÿ™ ÿ®ÿßÿ≤€å -->
    <div id="gameDetailsUI">
        <div class="upgrade-header">
            <i class="fas fa-info-circle"></i>
            <span>ÿ¨ÿ≤ÿ¶€åÿßÿ™ ÿ®ÿßÿ≤€å</span>
        </div>
        
        <div class="game-stats" id="gameStatsContainer">
            <!-- ÿ¢ŸÖÿßÿ± ÿ®ÿßÿ≤€å ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="closeGameDetailsBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI ÿ≠ŸÖŸÑŸá ÿ®Ÿá ÿØŸá⁄©ÿØŸá‚ÄåŸáÿß€å ÿØ€å⁄Øÿ± -->
    <div id="attackVillageUI">
        <div class="upgrade-header">
            <i class="fas fa-fist-raised"></i>
            <span>ÿ≠ŸÖŸÑŸá ÿ®Ÿá ÿØŸá⁄©ÿØŸá‚ÄåŸáÿß€å ÿØ€å⁄Øÿ±</span>
        </div>
        
        <div class="village-options" id="villageOptionsContainer">
            <!-- ⁄Øÿ≤€åŸÜŸá‚ÄåŸáÿß€å ÿØŸá⁄©ÿØŸá ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="closeAttackVillageBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI ŸÜÿ™€åÿ¨Ÿá ÿ≠ŸÖŸÑŸá -->
    <div id="attackResultUI">
        <div class="upgrade-header">
            <i class="fas fa-trophy"></i>
            <span>ŸÜÿ™€åÿ¨Ÿá ÿ≠ŸÖŸÑŸá</span>
        </div>
        
        <div class="attack-result" id="attackResultContainer">
            <!-- ŸÜÿ™€åÿ¨Ÿá ÿ≠ŸÖŸÑŸá ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="closeAttackResultBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI ÿ®Ÿáÿ®ŸàÿØŸáÿß -->
    <div id="boostsUI">
        <div class="upgrade-header">
            <i class="fas fa-rocket"></i>
            <span>ÿ®Ÿáÿ®ŸàÿØŸáÿß</span>
        </div>
        
        <div class="boost-options" id="boostOptionsContainer">
            <!-- ⁄Øÿ≤€åŸÜŸá‚ÄåŸáÿß€å ÿ®Ÿáÿ®ŸàÿØ ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="closeBoostsBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI ÿ±Ÿà€åÿØÿßÿØŸáÿß€å ÿÆÿßÿµ -->
    <div id="eventsUI">
        <div class="upgrade-header">
            <i class="fas fa-calendar-alt"></i>
            <span>ÿ±Ÿà€åÿØÿßÿØŸáÿß€å ÿÆÿßÿµ</span>
        </div>
        
        <div class="event-options" id="eventOptionsContainer">
            <!-- ⁄Øÿ≤€åŸÜŸá‚ÄåŸáÿß€å ÿ±Ÿà€åÿØÿßÿØ ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="closeEventsBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI ⁄ÜÿßŸÑÿ¥‚ÄåŸáÿß -->
    <div id="challengesUI">
        <div class="upgrade-header">
            <i class="fas fa-flag-checkered"></i>
            <span>⁄ÜÿßŸÑÿ¥‚ÄåŸáÿß</span>
        </div>
        
        <div class="challenge-options" id="challengeOptionsContainer">
            <!-- ⁄Øÿ≤€åŸÜŸá‚ÄåŸáÿß€å ⁄ÜÿßŸÑÿ¥ ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="closeChallengesBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI ⁄©ŸÖ⁄©‚ÄåŸáÿß€å ÿ®ÿßÿ≤€å -->
    <div id="helpUI">
        <div class="upgrade-header">
            <i class="fas fa-question-circle"></i>
            <span>⁄©ŸÖ⁄©‚ÄåŸáÿß€å ÿ®ÿßÿ≤€å</span>
        </div>
        
        <div class="help-sections" id="helpSectionsContainer">
            <!-- ÿ®ÿÆÿ¥‚ÄåŸáÿß€å ⁄©ŸÖ⁄© ÿØÿ± ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ -->
        </div>
        
        <div>
            <button class="upgrade-button" id="closeHelpBtn">ÿ®ÿ≥ÿ™ŸÜ</button>
        </div>
    </div>

    <!-- UI Ÿàÿ∂ÿπ€åÿ™ ÿ¢ŸÜŸÑÿß€åŸÜ -->
    <div id="onlineStatusUI">
        <div class="online-indicator"></div>
        <span>ÿ¢ŸÜŸÑÿß€åŸÜ</span>
    </div>

    <!-- UI ÿ≤ŸÖÿßŸÜ ÿ≥ÿ±Ÿàÿ± -->
    <div id="serverTimeUI">
        <span id="serverTime">12:00:00</span>
    </div>

    <!-- UI Ÿàÿ∂ÿπ€åÿ™ ÿ®ÿßÿ™ÿ±€å -->
    <div id="batteryStatusUI">
        <i class="fas fa-battery-half"></i>
        <span id="batteryLevel">65%</span>
    </div>

    <!-- UI FPS -->
    <div id="fpsCounter">
        <span id="fpsValue">60 FPS</span>
    </div>

    <!-- ÿßÿ≥⁄©ÿ±€åŸæÿ™‚ÄåŸáÿß€å ÿ®ÿßÿ≤€å -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/libs/stats.min.js"></script>
    
    <script>
        // ==================== ŸÅÿß€åŸÑ ÿßŸàŸÑ: ŸÖÿ™ÿ∫€åÿ±Ÿáÿß€å ÿßÿµŸÑ€å Ÿà Ÿæ€å⁄©ÿ±ÿ®ŸÜÿØ€å ÿ®ÿßÿ≤€å ====================
        
        // ŸÖÿ™ÿ∫€åÿ±Ÿáÿß€å ÿßÿµŸÑ€å ÿ®ÿßÿ≤€å
        let scene, camera, renderer, controls, stats;
        let gameState = {
            resources: {
                gold: 10000,
                elixir: 5000,
                darkElixir: 1000,
                gems: 500
            },
            playerLevel: 5,
            playerName: "ÿØŸá⁄©ÿØŸá ÿ¥ŸÖÿß",
            baseHealth: 2500,
            maxBaseHealth: 2500,
            waveNumber: 1,
            enemyCount: 0,
            nextAttackTime: 20,
            selectedStructure: null,
            structures: [],
            enemies: [],
            troops: [],
            projectiles: [],
            spells: [],
            achievements: [],
            clan: null,
            settings: {
                musicVolume: 50,
                soundVolume: 70,
                graphicsQuality: "medium",
                language: "fa"
            },
            gameStats: {
                totalPlayTime: 0,
                structuresBuilt: 0,
                enemiesDefeated: 0,
                attacksWon: 0,
                attacksLost: 0,
                resourcesCollected: {
                    gold: 0,
                    elixir: 0,
                    darkElixir: 0
                }
            }
        };

        // ÿØÿßÿØŸá‚ÄåŸáÿß€å ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß
        const structureData = {
            townhall: { 
                name: "ÿ≥ÿßŸÑŸÜ ÿ¥Ÿáÿ±", 
                health: 2000, 
                cost: { gold: 0, elixir: 0, darkElixir: 0 }, 
                level: 1, 
                maxLevel: 10,
                production: { gold: 100, elixir: 50, darkElixir: 10 },
                upgradeCostMultiplier: 1.5,
                description: "ŸÖÿ±⁄©ÿ≤ ÿßÿµŸÑ€å ÿØŸá⁄©ÿØŸá ÿ¥ŸÖÿß. ÿßÿ±ÿ™ŸÇÿßÿ° ÿ¢ŸÜ ŸÇŸÅŸÑ ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å ÿ¨ÿØ€åÿØ ÿ±ÿß ÿ®ÿßÿ≤ ŸÖ€å‚Äå⁄©ŸÜÿØ."
            },
            barracks: { 
                name: "ÿ≥ÿ±ÿ®ÿßÿ≤ÿÆÿßŸÜŸá", 
                health: 500, 
                cost: { gold: 1000, elixir: 500, darkElixir: 0 }, 
                level: 1, 
                maxLevel: 10,
                production: { gold: 0, elixir: 0, darkElixir: 0 },
                upgradeCostMultiplier: 1.4,
                description: "ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ÿÆŸàÿØ ÿ±ÿßÂú®ËøôÈáå ÿ¢ŸÖŸàÿ≤ÿ¥ ÿØŸá€åÿØ. ÿßÿ±ÿ™ŸÇÿßÿ° ÿ¢ŸÜ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ŸÇŸà€å‚Äåÿ™ÿ±€å ÿ±ÿß ÿ®ÿßÿ≤ ŸÖ€å‚Äå⁄©ŸÜÿØ."
            },
            goldmine: { 
                name: "ŸÖÿπÿØŸÜ ÿ∑ŸÑÿß", 
                health: 300, 
                cost: { gold: 800, elixir: 0, darkElixir: 0 }, 
                level: 1, 
                maxLevel: 10,
                production: { gold: 50, elixir: 0, darkElixir: 0 },
                upgradeCostMultiplier: 1.3,
                description: "ÿ∑ŸÑÿß ÿ™ŸàŸÑ€åÿØ ŸÖ€å‚Äå⁄©ŸÜÿØ. ÿßÿ±ÿ™ŸÇÿßÿ° ÿ¢ŸÜ ÿ≥ÿ±ÿπÿ™ ÿ™ŸàŸÑ€åÿØ ÿ±ÿß ÿßŸÅÿ≤ÿß€åÿ¥ ŸÖ€å‚ÄåÿØŸáÿØ."
            },
            elixircollector: { 
                name: "ÿ∏ÿ±ŸÅ ÿß⁄©ÿ≥€åÿ±", 
                health: 300, 
                cost: { gold: 0, elixir: 800, darkElixir: 0 }, 
                level: 1, 
                maxLevel: 10,
                production: { gold: 0, elixir: 40, darkElixir: 0 },
                upgradeCostMultiplier: 1.3,
                description: "ÿß⁄©ÿ≥€åÿ± ÿ™ŸàŸÑ€åÿØ ŸÖ€å‚Äå⁄©ŸÜÿØ. ÿßÿ±ÿ™ŸÇÿßÿ° ÿ¢ŸÜ ÿ≥ÿ±ÿπÿ™ ÿ™ŸàŸÑ€åÿØ ÿ±ÿß ÿßŸÅÿ≤ÿß€åÿ¥ ŸÖ€å‚ÄåÿØŸáÿØ."
            },
            darkelixirdrill: { 
                name: "ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©", 
                health: 400, 
                cost: { gold: 1500, elixir: 0, darkElixir: 0 }, 
                level: 1, 
                maxLevel: 8,
                production: { gold: 0, elixir: 0, darkElixir: 5 },
                upgradeCostMultiplier: 1.5,
                description: "ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄© ÿ™ŸàŸÑ€åÿØ ŸÖ€å‚Äå⁄©ŸÜÿØ. ÿßÿ±ÿ™ŸÇÿßÿ° ÿ¢ŸÜ ÿ≥ÿ±ÿπÿ™ ÿ™ŸàŸÑ€åÿØ ÿ±ÿß ÿßŸÅÿ≤ÿß€åÿ¥ ŸÖ€å‚ÄåÿØŸáÿØ."
            },
            cannon: { 
                name: "ÿ™ŸàŸæ", 
                health: 400, 
                cost: { gold: 1200, elixir: 0, darkElixir: 0 }, 
                level: 1, 
                maxLevel: 8,
                production: { gold: 0, elixir: 0, darkElixir: 0 },
                upgradeCostMultiplier: 1.4,
                description: "ÿ≥ÿßÿ≤Ÿá ÿØŸÅÿßÿπ€å ÿ®ÿß ÿ®ÿ±ÿØ ⁄©Ÿàÿ™ÿßŸá Ÿà ÿ¢ÿ≥€åÿ® ÿ®ÿßŸÑÿß. ÿ®ÿ±ÿß€å ÿØŸÅÿßÿπ ÿßÿ≤ ÿØŸá⁄©ÿØŸá ŸÖŸÅ€åÿØ ÿßÿ≥ÿ™."
            },
            archertower: { 
                name: "ÿ®ÿ±ÿ¨ ⁄©ŸÖÿßŸÜÿØÿßÿ±", 
                health: 450, 
                cost: { gold: 1500, elixir: 500, darkElixir: 0 }, 
                level: 1, 
                maxLevel: 8,
                production: { gold: 0, elixir: 0, darkElixir: 0 },
                upgradeCostMultiplier: 1.4,
                description: "ÿ≥ÿßÿ≤Ÿá ÿØŸÅÿßÿπ€å ÿ®ÿß ÿ®ÿ±ÿØ ŸÖÿ™Ÿàÿ≥ÿ∑. ŸÖ€å‚Äåÿ™ŸàÿßŸÜÿØ ÿ®Ÿá ÿ≤ŸÖ€åŸÜ€å Ÿà ŸáŸàÿß€å€å ÿ≠ŸÖŸÑŸá ⁄©ŸÜÿØ."
            },
            mortar: { 
                name: "ÿÆŸÖŸæÿßÿ±Ÿá‚ÄåÿßŸÜÿØÿßÿ≤", 
                health: 600, 
                cost: { gold: 2000, elixir: 1000, darkElixir: 0 }, 
                level: 1, 
                maxLevel: 6,
                production: { gold: 0, elixir: 0, darkElixir: 0 },
                upgradeCostMultiplier: 1.6,
                description: "ÿ≥ÿßÿ≤Ÿá ÿØŸÅÿßÿπ€å ÿ®ÿß ÿ®ÿ±ÿØ ÿ∑ŸàŸÑÿßŸÜ€å Ÿà ÿ¢ÿ≥€åÿ® ŸÖŸÜÿ∑ŸÇŸá‚Äåÿß€å. ŸÜŸÖ€å‚Äåÿ™ŸàÿßŸÜÿØ ÿ®Ÿá ÿßŸáÿØÿßŸÅ ŸÜÿ≤ÿØ€å⁄© ÿ≠ŸÖŸÑŸá ⁄©ŸÜÿØ."
            },
            wizardtower: { 
                name: "ÿ®ÿ±ÿ¨ ÿ¨ÿßÿØŸà⁄Øÿ±", 
                health: 550, 
                cost: { gold: 1800, elixir: 1500, darkElixir: 0 }, 
                level: 1, 
                maxLevel: 6,
                production: { gold: 0, elixir: 0, darkElixir: 0 },
                upgradeCostMultiplier: 1.6,
                description: "ÿ≥ÿßÿ≤Ÿá ÿØŸÅÿßÿπ€å ÿ®ÿß ÿ¢ÿ≥€åÿ® ÿ¨ÿßÿØŸà€å€å. ŸÖ€å‚Äåÿ™ŸàÿßŸÜÿØ ÿ®Ÿá ⁄ÜŸÜÿØ ÿØÿ¥ŸÖŸÜ ÿ®Ÿá ÿ∑Ÿàÿ± ŸáŸÖÿ≤ŸÖÿßŸÜ ÿ≠ŸÖŸÑŸá ⁄©ŸÜÿØ."
            },
            wall: { 
                name: "ÿØ€åŸàÿßÿ±", 
                health: 200, 
                cost: { gold: 200, elixir: 0, darkElixir: 0 }, 
                level: 1, 
                maxLevel: 12,
                production: { gold: 0, elixir: 0, darkElixir: 0 },
                upgradeCostMultiplier: 1.2,
                description: "ÿ≥ÿßÿ≤Ÿá ÿØŸÅÿßÿπ€å ⁄©Ÿá ŸÖÿ≥€åÿ± ÿØÿ¥ŸÖŸÜÿßŸÜ ÿ±ÿß ŸÖÿ≥ÿØŸàÿØ ŸÖ€å‚Äå⁄©ŸÜÿØ. ŸÖ€å‚Äåÿ™ŸàÿßŸÜÿØ ÿ®ÿ±ÿß€å ÿß€åÿ¨ÿßÿØ ŸÖŸàÿßŸÜÿπ ÿßÿ≥ÿ™ŸÅÿßÿØŸá ÿ¥ŸàÿØ."
            }
        };

        // ÿØÿßÿØŸá‚ÄåŸáÿß€å ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ
        const troopData = {
            barbarian: {
                name: "ÿ®ÿ±ÿ®ÿ±",
                cost: { gold: 0, elixir: 100, darkElixir: 0 },
                trainingTime: 10,
                health: 100,
                damage: 20,
                speed: 1.0,
                range: 1,
                description: "ÿ≥ÿ±ÿ®ÿßÿ≤ ŸÜÿ≤ÿØ€å⁄©‚Äåÿ®ÿ±ÿØ ÿ®ÿß ÿ≥ŸÑÿßŸÖÿ™ Ÿà ÿ¢ÿ≥€åÿ® ŸÖÿ™Ÿàÿ≥ÿ∑."
            },
            archer: {
                name: "⁄©ŸÖÿßŸÜÿØÿßÿ±",
                cost: { gold: 0, elixir: 200, darkElixir: 0 },
                trainingTime: 20,
                health: 50,
                damage: 25,
                speed: 1.2,
                range: 4,
                description: "ÿ≥ÿ±ÿ®ÿßÿ≤ ÿØŸàÿ±ÿ®ÿ±ÿØ ÿ®ÿß ÿ¢ÿ≥€åÿ® ÿ®ÿßŸÑÿß ÿßŸÖÿß ÿ≥ŸÑÿßŸÖÿ™ ⁄©ŸÖ."
            },
            giant: {
                name: "ÿ∫ŸàŸÑ",
                cost: { gold: 0, elixir: 500, darkElixir: 0 },
                trainingTime: 40,
                health: 500,
                damage: 40,
                speed: 0.6,
                range: 1,
                description: "ÿ≥ÿ±ÿ®ÿßÿ≤ ŸÜÿ≤ÿØ€å⁄©‚Äåÿ®ÿ±ÿØ ÿ®ÿß ÿ≥ŸÑÿßŸÖÿ™ ÿ®ÿ≥€åÿßÿ± ÿ®ÿßŸÑÿß. ÿ®Ÿá ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß ÿ¢ÿ≥€åÿ® ÿ®€åÿ¥ÿ™ÿ±€å ŸÖ€å‚Äåÿ≤ŸÜÿØ."
            },
            goblin: {
                name: "⁄Øÿßÿ®ŸÑ€åŸÜ",
                cost: { gold: 0, elixir: 50, darkElixir: 0 },
                trainingTime: 5,
                health: 30,
                damage: 15,
                speed: 1.5,
                range: 1,
                description: "ÿ≥ÿ±ÿ®ÿßÿ≤ ÿ≥ÿ±€åÿπ ÿ®ÿß ÿ¢ÿ≥€åÿ® ÿ®ÿßŸÑÿß ÿ®Ÿá ŸÖŸÜÿßÿ®ÿπ. ÿ®ÿ±ÿß€å ÿ¨ŸÖÿπ‚Äåÿ¢Ÿàÿ±€å ŸÖŸÜÿßÿ®ÿπ ÿß€åÿØŸá‚Äåÿ¢ŸÑ ÿßÿ≥ÿ™."
            },
            wizard: {
                name: "ÿ¨ÿßÿØŸà⁄Øÿ±",
                cost: { gold: 0, elixir: 800, darkElixir: 0 },
                trainingTime: 60,
                health: 120,
                damage: 60,
                speed: 0.8,
                range: 3,
                description: "ÿ≥ÿ±ÿ®ÿßÿ≤ ÿØŸàÿ±ÿ®ÿ±ÿØ ÿ®ÿß ÿ¢ÿ≥€åÿ® ÿ¨ÿßÿØŸà€å€å. ŸÖ€å‚Äåÿ™ŸàÿßŸÜÿØ ÿ®Ÿá ⁄ÜŸÜÿØ ÿØÿ¥ŸÖŸÜ ÿ®Ÿá ÿ∑Ÿàÿ± ŸáŸÖÿ≤ŸÖÿßŸÜ ÿ≠ŸÖŸÑŸá ⁄©ŸÜÿØ."
            },
            dragon: {
                name: "ÿß⁄òÿØŸáÿß",
                cost: { gold: 0, elixir: 0, darkElixir: 200 },
                trainingTime: 120,
                health: 800,
                damage: 100,
                speed: 1.0,
                range: 2,
                description: "Ÿàÿßÿ≠ÿØ ŸáŸàÿß€å€å ŸÇÿØÿ±ÿ™ŸÖŸÜÿØ ÿ®ÿß ÿ¢ÿ≥€åÿ® ÿ¢ÿ™ÿ¥€åŸÜ. ŸÖ€å‚Äåÿ™ŸàÿßŸÜÿØ ÿßÿ≤ ÿ®ÿßŸÑÿß€å ÿØ€åŸàÿßÿ±Ÿáÿß Ÿæÿ±Ÿàÿßÿ≤ ⁄©ŸÜÿØ."
            },
            pekka: {
                name: "Ÿæ⁄©ÿß",
                cost: { gold: 0, elixir: 0, darkElixir: 300 },
                trainingTime: 180,
                health: 1200,
                damage: 150,
                speed: 0.5,
                range: 1,
                description: "Ÿàÿßÿ≠ÿØ ÿ≥ŸÜ⁄Ø€åŸÜ‚Äåÿ≤ÿ±Ÿá ÿ®ÿß ÿ¢ÿ≥€åÿ® ÿ®ÿ≥€åÿßÿ± ÿ®ÿßŸÑÿß. ⁄©ŸÜÿØ ÿßŸÖÿß ÿ®ÿ≥€åÿßÿ± ŸÇÿØÿ±ÿ™ŸÖŸÜÿØ ÿßÿ≥ÿ™."
            }
        };

        // ÿØÿßÿØŸá‚ÄåŸáÿß€å ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß
        const spellData = {
            lightning: {
                name: "ÿ∑ŸÑÿ≥ŸÖ ÿ±ÿπÿØ Ÿà ÿ®ÿ±ŸÇ",
                cost: { gold: 0, elixir: 500, darkElixir: 0 },
                brewingTime: 30,
                damage: 300,
                radius: 3,
                description: "ÿ±ÿπÿØ Ÿà ÿ®ÿ±ŸÇ€å ⁄©Ÿá ÿ®Ÿá ⁄ÜŸÜÿØ ÿ≥ÿßÿ≤Ÿá ÿØÿ± €å⁄© ŸÖŸÜÿ∑ŸÇŸá ÿ¢ÿ≥€åÿ® ŸÖ€å‚Äåÿ≤ŸÜÿØ."
            },
            healing: {
                name: "ÿ∑ŸÑÿ≥ŸÖ ÿØÿ±ŸÖÿßŸÜ",
                cost: { gold: 0, elixir: 600, darkElixir: 0 },
                brewingTime: 45,
                healing: 400,
                radius: 4,
                description: "ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ÿÆŸàÿØ ÿ±ÿß ÿØÿ± €å⁄© ŸÖŸÜÿ∑ŸÇŸá ÿØÿ±ŸÖÿßŸÜ ŸÖ€å‚Äå⁄©ŸÜÿØ."
            },
            rage: {
                name: "ÿ∑ŸÑÿ≥ŸÖ ÿÆÿ¥ŸÖ",
                cost: { gold: 0, elixir: 400, darkElixir: 0 },
                brewingTime: 25,
                effect: 1.5,
                duration: 20,
                radius: 4,
                description: "ÿ≥ÿ±ÿπÿ™ Ÿà ÿ¢ÿ≥€åÿ® ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ÿ±ÿß ÿØÿ± €å⁄© ŸÖŸÜÿ∑ŸÇŸá ÿßŸÅÿ≤ÿß€åÿ¥ ŸÖ€å‚ÄåÿØŸáÿØ."
            },
            freeze: {
                name: "ÿ∑ŸÑÿ≥ŸÖ ÿßŸÜÿ¨ŸÖÿßÿØ",
                cost: { gold: 0, elixir: 0, darkElixir: 100 },
                brewingTime: 60,
                duration: 10,
                radius: 3,
                description: "ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å ÿØŸÅÿßÿπ€å ÿØÿ¥ŸÖŸÜ ÿ±ÿß ÿ®ÿ±ÿß€å ŸÖÿØÿ™ ⁄©Ÿàÿ™ÿßŸá€å ŸÖÿ™ŸàŸÇŸÅ ŸÖ€å‚Äå⁄©ŸÜÿØ."
            },
            jump: {
                name: "ÿ∑ŸÑÿ≥ŸÖ Ÿæÿ±ÿ¥",
                cost: { gold: 0, elixir: 0, darkElixir: 80 },
                brewingTime: 40,
                duration: 15,
                description: "ÿ®Ÿá ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ÿßÿ¨ÿßÿ≤Ÿá ŸÖ€å‚ÄåÿØŸáÿØ ÿßÿ≤ ÿ±Ÿà€å ÿØ€åŸàÿßÿ±Ÿáÿß ÿ®Ÿæÿ±ŸÜÿØ."
            }
        };

        // ÿØÿßÿØŸá‚ÄåŸáÿß€å ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß
        const achievementData = [
            {
                id: "first_building",
                name: "ÿ≥ÿßÿ≤ŸÜÿØŸá ÿ™ÿßÿ≤Ÿá‚Äå⁄©ÿßÿ±",
                description: "ÿßŸàŸÑ€åŸÜ ÿ≥ÿßÿ≤Ÿá ÿÆŸàÿØ ÿ±ÿß ÿ®ÿ≥ÿßÿ≤€åÿØ",
                reward: { gold: 500, elixir: 500, gems: 10 },
                progress: 0,
                target: 1,
                completed: false
            },
            {
                id: "master_builder",
                name: "ÿßÿ≥ÿ™ÿßÿØ ÿ≥ÿßÿ≤ŸÜÿØŸá",
                description: "10 ÿ≥ÿßÿ≤Ÿá ŸÖÿÆÿ™ŸÑŸÅ ÿ®ÿ≥ÿßÿ≤€åÿØ",
                reward: { gold: 2000, elixir: 2000, gems: 50 },
                progress: 0,
                target: 10,
                completed: false
            },
            {
                id: "first_attack",
                name: "ÿ¨ŸÜ⁄Øÿ¨Ÿà€å ÿ™ÿßÿ≤Ÿá‚Äå⁄©ÿßÿ±",
                description: "ÿßŸàŸÑ€åŸÜ ÿ≠ŸÖŸÑŸá ÿÆŸàÿØ ÿ±ÿß ÿßŸÜÿ¨ÿßŸÖ ÿØŸá€åÿØ",
                reward: { gold: 1000, elixir: 1000, gems: 20 },
                progress: 0,
                target: 1,
                completed: false
            },
            {
                id: "veteran_attacker",
                name: "ÿ≠ŸÖŸÑŸá‚Äå⁄Øÿ± ⁄©ŸáŸÜŸá‚Äå⁄©ÿßÿ±",
                description: "10 ÿ≠ŸÖŸÑŸá ŸÖŸàŸÅŸÇ ÿßŸÜÿ¨ÿßŸÖ ÿØŸá€åÿØ",
                reward: { gold: 5000, elixir: 5000, gems: 100 },
                progress: 0,
                target: 10,
                completed: false
            },
            {
                id: "resource_collector",
                name: "ÿ¨ŸÖÿπ‚Äåÿ¢Ÿàÿ±ŸÜÿØŸá ŸÖŸÜÿßÿ®ÿπ",
                description: "10000 ÿ∑ŸÑÿß ÿ¨ŸÖÿπ‚Äåÿ¢Ÿàÿ±€å ⁄©ŸÜ€åÿØ",
                reward: { gold: 1000, elixir: 0, gems: 25 },
                progress: 0,
                target: 10000,
                completed: false
            },
            {
                id: "elixir_master",
                name: "ÿßÿ≥ÿ™ÿßÿØ ÿß⁄©ÿ≥€åÿ±",
                description: "5000 ÿß⁄©ÿ≥€åÿ± ÿ¨ŸÖÿπ‚Äåÿ¢Ÿàÿ±€å ⁄©ŸÜ€åÿØ",
                reward: { gold: 0, elixir: 1000, gems: 25 },
                progress: 0,
                target: 5000,
                completed: false
            },
            {
                id: "dark_elixir_expert",
                name: "ŸÖÿ™ÿÆÿµÿµ ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©",
                description: "1000 ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄© ÿ¨ŸÖÿπ‚Äåÿ¢Ÿàÿ±€å ⁄©ŸÜ€åÿØ",
                reward: { gold: 0, elixir: 0, darkElixir: 200, gems: 50 },
                progress: 0,
                target: 1000,
                completed: false
            },
            {
                id: "defense_expert",
                name: "ŸÖÿ™ÿÆÿµÿµ ÿØŸÅÿßÿπ",
                description: "100 ÿØÿ¥ŸÖŸÜ ÿ±ÿß ÿ¥⁄©ÿ≥ÿ™ ÿØŸá€åÿØ",
                reward: { gold: 2000, elixir: 2000, gems: 75 },
                progress: 0,
                target: 100,
                completed: false
            },
            {
                id: "town_hall_upgrader",
                name: "ÿßÿ±ÿ™ŸÇÿßÿ° ÿØŸáŸÜÿØŸá ÿ≥ÿßŸÑŸÜ ÿ¥Ÿáÿ±",
                description: "ÿ≥ÿßŸÑŸÜ ÿ¥Ÿáÿ± ÿ±ÿß ÿ®Ÿá ÿ≥ÿ∑ÿ≠ 5 ÿßÿ±ÿ™ŸÇÿßÿ° ÿØŸá€åÿØ",
                reward: { gold: 3000, elixir: 3000, gems: 100 },
                progress: 0,
                target: 5,
                completed: false
            },
            {
                id: "clan_creator",
                name: "ÿ®ŸÜ€åÿßŸÜ⁄Øÿ∞ÿßÿ± ŸÇÿ®€åŸÑŸá",
                description: "€å⁄© ŸÇÿ®€åŸÑŸá ÿß€åÿ¨ÿßÿØ ⁄©ŸÜ€åÿØ",
                reward: { gold: 5000, elixir: 5000, gems: 150 },
                progress: 0,
                target: 1,
                completed: false
            }
        ];

        // ÿØÿßÿØŸá‚ÄåŸáÿß€å ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá
        const shopData = {
            resources: [
                {
                    id: "gold_1",
                    name: "1000 ÿ∑ŸÑÿß",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 10 },
                    amount: { gold: 1000, elixir: 0, darkElixir: 0 },
                    description: "1000 ÿ∑ŸÑÿß ÿ®Ÿá ŸÖŸàÿ¨ŸàÿØ€å ÿ¥ŸÖÿß ÿßÿ∂ÿßŸÅŸá ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "gold_2",
                    name: "5000 ÿ∑ŸÑÿß",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 45 },
                    amount: { gold: 5000, elixir: 0, darkElixir: 0 },
                    description: "5000 ÿ∑ŸÑÿß ÿ®Ÿá ŸÖŸàÿ¨ŸàÿØ€å ÿ¥ŸÖÿß ÿßÿ∂ÿßŸÅŸá ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "gold_3",
                    name: "10000 ÿ∑ŸÑÿß",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 80 },
                    amount: { gold: 10000, elixir: 0, darkElixir: 0 },
                    description: "10000 ÿ∑ŸÑÿß ÿ®Ÿá ŸÖŸàÿ¨ŸàÿØ€å ÿ¥ŸÖÿß ÿßÿ∂ÿßŸÅŸá ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "elixir_1",
                    name: "1000 ÿß⁄©ÿ≥€åÿ±",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 10 },
                    amount: { gold: 0, elixir: 1000, darkElixir: 0 },
                    description: "1000 ÿß⁄©ÿ≥€åÿ± ÿ®Ÿá ŸÖŸàÿ¨ŸàÿØ€å ÿ¥ŸÖÿß ÿßÿ∂ÿßŸÅŸá ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "elixir_2",
                    name: "5000 ÿß⁄©ÿ≥€åÿ±",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 45 },
                    amount: { gold: 0, elixir: 5000, darkElixir: 0 },
                    description: "5000 ÿß⁄©ÿ≥€åÿ± ÿ®Ÿá ŸÖŸàÿ¨ŸàÿØ€å ÿ¥ŸÖÿß ÿßÿ∂ÿßŸÅŸá ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "elixir_3",
                    name: "10000 ÿß⁄©ÿ≥€åÿ±",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 80 },
                    amount: { gold: 0, elixir: 10000, darkElixir: 0 },
                    description: "10000 ÿß⁄©ÿ≥€åÿ± ÿ®Ÿá ŸÖŸàÿ¨ŸàÿØ€å ÿ¥ŸÖÿß ÿßÿ∂ÿßŸÅŸá ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "dark_elixir_1",
                    name: "100 ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 20 },
                    amount: { gold: 0, elixir: 0, darkElixir: 100 },
                    description: "100 ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄© ÿ®Ÿá ŸÖŸàÿ¨ŸàÿØ€å ÿ¥ŸÖÿß ÿßÿ∂ÿßŸÅŸá ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "dark_elixir_2",
                    name: "500 ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 90 },
                    amount: { gold: 0, elixir: 0, darkElixir: 500 },
                    description: "500 ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄© ÿ®Ÿá ŸÖŸàÿ¨ŸàÿØ€å ÿ¥ŸÖÿß ÿßÿ∂ÿßŸÅŸá ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "dark_elixir_3",
                    name: "1000 ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 160 },
                    amount: { gold: 0, elixir: 0, darkElixir: 1000 },
                    description: "1000 ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄© ÿ®Ÿá ŸÖŸàÿ¨ŸàÿØ€å ÿ¥ŸÖÿß ÿßÿ∂ÿßŸÅŸá ŸÖ€å‚Äå⁄©ŸÜÿØ"
                }
            ],
            buildings: [
                {
                    id: "builder_hut",
                    name: "⁄©ŸÑÿ®Ÿá ÿ≥ÿßÿ≤ŸÜÿØŸá",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 500 },
                    description: "€å⁄© ÿ≥ÿßÿ≤ŸÜÿØŸá ÿßÿ∂ÿßŸÅ€å ÿ®ÿ±ÿß€å ÿ≥ÿßÿÆÿ™ Ÿà ÿßÿ±ÿ™ŸÇÿßÿ° ŸáŸÖÿ≤ŸÖÿßŸÜ ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß"
                },
                {
                    id: "shield_1",
                    name: "ŸÖÿ≠ÿßŸÅÿ∏ ÿ¥ÿÆÿµ€å (1 ÿ±Ÿàÿ≤)",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 100 },
                    description: "ÿØŸá⁄©ÿØŸá ÿ¥ŸÖÿß ÿ±ÿß ÿ®ÿ±ÿß€å 1 ÿ±Ÿàÿ≤ ÿØÿ± ÿ®ÿ±ÿßÿ®ÿ± ÿ≠ŸÖŸÑÿßÿ™ ŸÖÿ≠ÿßŸÅÿ∏ÿ™ ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "shield_2",
                    name: "ŸÖÿ≠ÿßŸÅÿ∏ ÿ¥ÿÆÿµ€å (3 ÿ±Ÿàÿ≤)",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 250 },
                    description: "ÿØŸá⁄©ÿØŸá ÿ¥ŸÖÿß ÿ±ÿß ÿ®ÿ±ÿß€å 3 ÿ±Ÿàÿ≤ ÿØÿ± ÿ®ÿ±ÿßÿ®ÿ± ÿ≠ŸÖŸÑÿßÿ™ ŸÖÿ≠ÿßŸÅÿ∏ÿ™ ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "shield_3",
                    name: "ŸÖÿ≠ÿßŸÅÿ∏ ÿ¥ÿÆÿµ€å (7 ÿ±Ÿàÿ≤)",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 500 },
                    description: "ÿØŸá⁄©ÿØŸá ÿ¥ŸÖÿß ÿ±ÿß ÿ®ÿ±ÿß€å 7 ÿ±Ÿàÿ≤ ÿØÿ± ÿ®ÿ±ÿßÿ®ÿ± ÿ≠ŸÖŸÑÿßÿ™ ŸÖÿ≠ÿßŸÅÿ∏ÿ™ ŸÖ€å‚Äå⁄©ŸÜÿØ"
                }
            ],
            troops: [
                {
                    id: "training_boost_1",
                    name: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿ≥ÿ±ÿπÿ™ ÿ¢ŸÖŸàÿ≤ÿ¥ (1 ÿ≥ÿßÿπÿ™)",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 50 },
                    description: "ÿ≥ÿ±ÿπÿ™ ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ÿ±ÿß ÿ®ÿ±ÿß€å 1 ÿ≥ÿßÿπÿ™ ÿØŸà ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "training_boost_2",
                    name: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿ≥ÿ±ÿπÿ™ ÿ¢ŸÖŸàÿ≤ÿ¥ (3 ÿ≥ÿßÿπÿ™)",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 120 },
                    description: "ÿ≥ÿ±ÿπÿ™ ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ÿ±ÿß ÿ®ÿ±ÿß€å 3 ÿ≥ÿßÿπÿ™ ÿØŸà ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "training_boost_3",
                    name: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿ≥ÿ±ÿπÿ™ ÿ¢ŸÖŸàÿ≤ÿ¥ (8 ÿ≥ÿßÿπÿ™)",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 250 },
                    description: "ÿ≥ÿ±ÿπÿ™ ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ÿ±ÿß ÿ®ÿ±ÿß€å 8 ÿ≥ÿßÿπÿ™ ÿØŸà ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äå⁄©ŸÜÿØ"
                }
            ],
            spells: [
                {
                    id: "brewing_boost_1",
                    name: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿ≥ÿ±ÿπÿ™ ÿ≥ÿßÿÆÿ™ ÿ∑ŸÑÿ≥ŸÖ (1 ÿ≥ÿßÿπÿ™)",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 50 },
                    description: "ÿ≥ÿ±ÿπÿ™ ÿ≥ÿßÿÆÿ™ ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß ÿ±ÿß ÿ®ÿ±ÿß€å 1 ÿ≥ÿßÿπÿ™ ÿØŸà ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "brewing_boost_2",
                    name: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿ≥ÿ±ÿπÿ™ ÿ≥ÿßÿÆÿ™ ÿ∑ŸÑÿ≥ŸÖ (3 ÿ≥ÿßÿπÿ™)",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 120 },
                    description: "ÿ≥ÿ±ÿπÿ™ ÿ≥ÿßÿÆÿ™ ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß ÿ±ÿß ÿ®ÿ±ÿß€å 3 ÿ≥ÿßÿπÿ™ ÿØŸà ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äå⁄©ŸÜÿØ"
                },
                {
                    id: "brewing_boost_3",
                    name: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿ≥ÿ±ÿπÿ™ ÿ≥ÿßÿÆÿ™ ÿ∑ŸÑÿ≥ŸÖ (8 ÿ≥ÿßÿπÿ™)",
                    cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 250 },
                    description: "ÿ≥ÿ±ÿπÿ™ ÿ≥ÿßÿÆÿ™ ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß ÿ±ÿß ÿ®ÿ±ÿß€å 8 ÿ≥ÿßÿπÿ™ ÿØŸà ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äå⁄©ŸÜÿØ"
                }
            ]
        };

        // ÿØÿßÿØŸá‚ÄåŸáÿß€å ÿ®Ÿáÿ®ŸàÿØŸáÿß
        const boostData = [
            {
                id: "resource_boost",
                name: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿ™ŸàŸÑ€åÿØ ŸÖŸÜÿßÿ®ÿπ",
                cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 100 },
                duration: 24,
                description: "ÿ™ŸàŸÑ€åÿØ ŸáŸÖŸá ŸÖŸÜÿßÿ®ÿπ ÿ±ÿß ÿ®ÿ±ÿß€å 24 ÿ≥ÿßÿπÿ™ ÿØŸà ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äå⁄©ŸÜÿØ",
                effect: "double_resource_production"
            },
            {
                id: "defense_boost",
                name: "ÿßŸÅÿ≤ÿß€åÿ¥ ŸÇÿØÿ±ÿ™ ÿØŸÅÿßÿπ",
                cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 150 },
                duration: 24,
                description: "ŸÇÿØÿ±ÿ™ ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å ÿØŸÅÿßÿπ€å ÿ±ÿß ÿ®ÿ±ÿß€å 24 ÿ≥ÿßÿπÿ™ ÿØŸà ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äå⁄©ŸÜÿØ",
                effect: "double_defense_power"
            },
            {
                id: "training_boost",
                name: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿ≥ÿ±ÿπÿ™ ÿ¢ŸÖŸàÿ≤ÿ¥",
                cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 80 },
                duration: 12,
                description: "ÿ≥ÿ±ÿπÿ™ ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ÿ±ÿß ÿ®ÿ±ÿß€å 12 ÿ≥ÿßÿπÿ™ ÿØŸà ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äå⁄©ŸÜÿØ",
                effect: "double_training_speed"
            },
            {
                id: "building_boost",
                name: "ÿßŸÅÿ≤ÿß€åÿ¥ ÿ≥ÿ±ÿπÿ™ ÿ≥ÿßÿÆÿ™",
                cost: { gold: 0, elixir: 0, darkElixir: 0, gems: 120 },
                duration: 24,
                description: "ÿ≥ÿ±ÿπÿ™ ÿ≥ÿßÿÆÿ™ Ÿà ÿßÿ±ÿ™ŸÇÿßÿ° ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß ÿ±ÿß ÿ®ÿ±ÿß€å 24 ÿ≥ÿßÿπÿ™ ÿØŸà ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äå⁄©ŸÜÿØ",
                effect: "double_building_speed"
            }
        ];

        // ÿØÿßÿØŸá‚ÄåŸáÿß€å ÿ±Ÿà€åÿØÿßÿØŸáÿß
        const eventData = [
            {
                id: "gold_rush",
                name: "Ÿáÿ¨ŸàŸÖ ÿ∑ŸÑÿß",
                description: "ÿ™ŸàŸÑ€åÿØ ÿ∑ŸÑÿß ÿ®ÿ±ÿß€å 2 ÿ≥ÿßÿπÿ™ ÿ≥Ÿá ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äåÿ¥ŸàÿØ",
                duration: 2,
                active: false,
                startTime: null
            },
            {
                id: "elixir_overflow",
                name: "ÿ≥ÿ±ÿ±€åÿ≤ ÿß⁄©ÿ≥€åÿ±",
                description: "ÿ™ŸàŸÑ€åÿØ ÿß⁄©ÿ≥€åÿ± ÿ®ÿ±ÿß€å 2 ÿ≥ÿßÿπÿ™ ÿ≥Ÿá ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äåÿ¥ŸàÿØ",
                duration: 2,
                active: false,
                startTime: null
            },
            {
                id: "dark_elixir_surge",
                name: "ÿßŸÅÿ≤ÿß€åÿ¥ ŸÜÿß⁄ØŸáÿßŸÜ€å ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©",
                description: "ÿ™ŸàŸÑ€åÿØ ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄© ÿ®ÿ±ÿß€å 1 ÿ≥ÿßÿπÿ™ ÿ≥Ÿá ÿ®ÿ±ÿßÿ®ÿ± ŸÖ€å‚Äåÿ¥ŸàÿØ",
                duration: 1,
                active: false,
                startTime: null
            },
            {
                id: "training_party",
                name: "ŸÖŸáŸÖÿßŸÜ€å ÿ¢ŸÖŸàÿ≤ÿ¥",
                description: "ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ÿ®ÿ±ÿß€å 4 ÿ≥ÿßÿπÿ™ ÿ±ÿß€å⁄ØÿßŸÜ ŸÖ€å‚Äåÿ¥ŸàÿØ",
                duration: 4,
                active: false,
                startTime: null
            },
            {
                id: "building_bonanza",
                name: "ÿ¨ÿ¥ŸÜŸàÿßÿ±Ÿá ÿ≥ÿßÿÆÿ™",
                description: "ÿ≥ÿßÿÆÿ™ Ÿà ÿßÿ±ÿ™ŸÇÿßÿ° ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß ÿ®ÿ±ÿß€å 3 ÿ≥ÿßÿπÿ™ 50% ÿßÿ±ÿ≤ÿßŸÜ‚Äåÿ™ÿ± ŸÖ€å‚Äåÿ¥ŸàÿØ",
                duration: 3,
                active: false,
                startTime: null
            }
        ];

        // ÿØÿßÿØŸá‚ÄåŸáÿß€å ⁄ÜÿßŸÑÿ¥‚ÄåŸáÿß
        const challengeData = [
            {
                id: "daily_attack",
                name: "ÿ≠ŸÖŸÑŸá ÿ±Ÿàÿ≤ÿßŸÜŸá",
                description: "3 ÿ≠ŸÖŸÑŸá ŸÖŸàŸÅŸÇ ÿØÿ± €å⁄© ÿ±Ÿàÿ≤ ÿßŸÜÿ¨ÿßŸÖ ÿØŸá€åÿØ",
                reward: { gold: 1000, elixir: 1000, gems: 10 },
                progress: 0,
                target: 3,
                completed: false,
                resetTime: 24
            },
            {
                id: "weekly_defense",
                name: "ÿØŸÅÿßÿπ ŸáŸÅÿ™⁄Ø€å",
                description: "50 ÿØÿ¥ŸÖŸÜ ÿ±ÿß ÿØÿ± €å⁄© ŸáŸÅÿ™Ÿá ÿ¥⁄©ÿ≥ÿ™ ÿØŸá€åÿØ",
                reward: { gold: 5000, elixir: 5000, gems: 50 },
                progress: 0,
                target: 50,
                completed: false,
                resetTime: 168
            },
            {
                id: "monthly_builder",
                name: "ÿ≥ÿßÿ≤ŸÜÿØŸá ŸÖÿßŸá",
                description: "20 ÿ≥ÿßÿ≤Ÿá ÿ±ÿß ÿØÿ± €å⁄© ŸÖÿßŸá ÿßÿ±ÿ™ŸÇÿßÿ° ÿØŸá€åÿØ",
                reward: { gold: 10000, elixir: 10000, gems: 100 },
                progress: 0,
                target: 20,
                completed: false,
                resetTime: 720
            },
            {
                id: "resource_master",
                name: "ÿßÿ≥ÿ™ÿßÿØ ŸÖŸÜÿßÿ®ÿπ",
                description: "50000 ÿ∑ŸÑÿß Ÿà 25000 ÿß⁄©ÿ≥€åÿ± ÿ¨ŸÖÿπ‚Äåÿ¢Ÿàÿ±€å ⁄©ŸÜ€åÿØ",
                reward: { gold: 5000, elixir: 5000, gems: 75 },
                progress: 0,
                target: 1,
                completed: false,
                resetTime: 0
            },
            {
                id: "clan_warrior",
                name: "ÿ¨ŸÜ⁄Øÿ¨Ÿà€å ŸÇÿ®€åŸÑŸá",
                description: "ÿØÿ± 5 ÿ¨ŸÜ⁄Ø ŸÇÿ®€åŸÑŸá ÿ¥ÿ±⁄©ÿ™ ⁄©ŸÜ€åÿØ",
                reward: { gold: 8000, elixir: 8000, darkElixir: 200, gems: 150 },
                progress: 0,
                target: 5,
                completed: false,
                resetTime: 0
            }
        ];

        // ÿØÿßÿØŸá‚ÄåŸáÿß€å ⁄©ŸÖ⁄©‚ÄåŸáÿß€å ÿ®ÿßÿ≤€å
        const helpData = [
            {
                title: "ŸÖŸÇÿØŸÖŸá",
                content: "ÿ®Ÿá ÿ®ÿßÿ≤€å Clash 3D Pro ÿÆŸàÿ¥ ÿ¢ŸÖÿØ€åÿØ! ÿß€åŸÜ €å⁄© ÿ®ÿßÿ≤€å ÿßÿ≥ÿ™ÿ±ÿßÿ™⁄ò€å ÿßÿ≥ÿ™ ⁄©Ÿá ÿØÿ± ÿ¢ŸÜ ÿ®ÿß€åÿØ ÿØŸá⁄©ÿØŸá ÿÆŸàÿØ ÿ±ÿß ÿ®ÿ≥ÿßÿ≤€åÿØÿå ÿßÿ±ÿ™ÿ¥ ŸÇÿØÿ±ÿ™ŸÖŸÜÿØ€å ÿß€åÿ¨ÿßÿØ ⁄©ŸÜ€åÿØ Ÿà ÿ®Ÿá ÿØŸá⁄©ÿØŸá‚ÄåŸáÿß€å ÿØ€å⁄Øÿ± ÿ≠ŸÖŸÑŸá ⁄©ŸÜ€åÿØ."
            },
            {
                title: "ŸÖŸÜÿßÿ®ÿπ",
                content: "⁄ÜŸáÿßÿ± ŸÜŸàÿπ ŸÖŸÜÿ®ÿπ ÿØÿ± ÿ®ÿßÿ≤€å Ÿàÿ¨ŸàÿØ ÿØÿßÿ±ÿØ: ÿ∑ŸÑÿßÿå ÿß⁄©ÿ≥€åÿ±ÿå ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄© Ÿà ÿ¨ŸàÿßŸáÿ±. ÿ∑ŸÑÿß ÿ®ÿ±ÿß€å ÿ≥ÿßÿÆÿ™ Ÿà ÿßÿ±ÿ™ŸÇÿßÿ° ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß ÿßÿ≥ÿ™ŸÅÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ. ÿß⁄©ÿ≥€åÿ± ÿ®ÿ±ÿß€å ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ Ÿà ÿßÿ±ÿ™ŸÇÿßÿ° ÿ≥ÿ±ÿ®ÿßÿ≤ÿÆÿßŸÜŸá ÿßÿ≥ÿ™ŸÅÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ. ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄© ÿ®ÿ±ÿß€å ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ Ÿà€å⁄òŸá Ÿà ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß ÿßÿ≥ÿ™ŸÅÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ. ÿ¨ŸàÿßŸáÿ± ÿ®ÿ±ÿß€å ÿ≥ÿ±ÿπÿ™ ÿ®ÿÆÿ¥€åÿØŸÜ ÿ®Ÿá ŸÅÿ±ÿ¢€åŸÜÿØŸáÿß Ÿà ÿÆÿ±€åÿØ ÿ¢€åÿ™ŸÖ‚ÄåŸáÿß€å Ÿà€å⁄òŸá ÿßÿ≥ÿ™ŸÅÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ."
            },
            {
                title: "ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß",
                content: "ÿßŸÜŸàÿßÿπ ŸÖÿÆÿ™ŸÑŸÅ€å ÿßÿ≤ ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß ÿØÿ± ÿ®ÿßÿ≤€å Ÿàÿ¨ŸàÿØ ÿØÿßÿ±ŸÜÿØ: ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å ŸÖŸÜÿßÿ®ÿπ (ŸÖÿπÿØŸÜ ÿ∑ŸÑÿßÿå ÿ∏ÿ±ŸÅ ÿß⁄©ÿ≥€åÿ±ÿå ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©)ÿå ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å ÿØŸÅÿßÿπ€å (ÿ™ŸàŸæÿå ÿ®ÿ±ÿ¨ ⁄©ŸÖÿßŸÜÿØÿßÿ±ÿå ÿÆŸÖŸæÿßÿ±Ÿá‚ÄåÿßŸÜÿØÿßÿ≤ÿå ÿ®ÿ±ÿ¨ ÿ¨ÿßÿØŸà⁄Øÿ±ÿå ÿØ€åŸàÿßÿ±)ÿå ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å ŸÜÿ∏ÿßŸÖ€å (ÿ≥ÿ±ÿ®ÿßÿ≤ÿÆÿßŸÜŸá) Ÿà ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å Ÿà€å⁄òŸá (ÿ≥ÿßŸÑŸÜ ÿ¥Ÿáÿ±). Ÿáÿ± ÿ≥ÿßÿ≤Ÿá ÿ±ÿß ŸÖ€å‚Äåÿ™ŸàÿßŸÜ ÿßÿ±ÿ™ŸÇÿßÿ° ÿØÿßÿØ ÿ™ÿß ÿπŸÖŸÑ⁄©ÿ±ÿØ ÿ®Ÿáÿ™ÿ±€å ÿØÿßÿ¥ÿ™Ÿá ÿ®ÿßÿ¥ÿØ."
            },
            {
                title: "ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ",
                content: "ÿßŸÜŸàÿßÿπ ŸÖÿÆÿ™ŸÑŸÅ€å ÿßÿ≤ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ÿØÿ± ÿ®ÿßÿ≤€å Ÿàÿ¨ŸàÿØ ÿØÿßÿ±ŸÜÿØ: ÿ®ÿ±ÿ®ÿ± (ÿ≥ÿ±ÿ®ÿßÿ≤ ŸÜÿ≤ÿØ€å⁄©‚Äåÿ®ÿ±ÿØ ÿ®ÿß ÿ≥ŸÑÿßŸÖÿ™ Ÿà ÿ¢ÿ≥€åÿ® ŸÖÿ™Ÿàÿ≥ÿ∑)ÿå ⁄©ŸÖÿßŸÜÿØÿßÿ± (ÿ≥ÿ±ÿ®ÿßÿ≤ ÿØŸàÿ±ÿ®ÿ±ÿØ ÿ®ÿß ÿ¢ÿ≥€åÿ® ÿ®ÿßŸÑÿß ÿßŸÖÿß ÿ≥ŸÑÿßŸÖÿ™ ⁄©ŸÖ)ÿå ÿ∫ŸàŸÑ (ÿ≥ÿ±ÿ®ÿßÿ≤ ŸÜÿ≤ÿØ€å⁄©‚Äåÿ®ÿ±ÿØ ÿ®ÿß ÿ≥ŸÑÿßŸÖÿ™ ÿ®ÿ≥€åÿßÿ± ÿ®ÿßŸÑÿß)ÿå ⁄Øÿßÿ®ŸÑ€åŸÜ (ÿ≥ÿ±ÿ®ÿßÿ≤ ÿ≥ÿ±€åÿπ ÿ®ÿß ÿ¢ÿ≥€åÿ® ÿ®ÿßŸÑÿß ÿ®Ÿá ŸÖŸÜÿßÿ®ÿπ)ÿå ÿ¨ÿßÿØŸà⁄Øÿ± (ÿ≥ÿ±ÿ®ÿßÿ≤ ÿØŸàÿ±ÿ®ÿ±ÿØ ÿ®ÿß ÿ¢ÿ≥€åÿ® ÿ¨ÿßÿØŸà€å€å)ÿå ÿß⁄òÿØŸáÿß (Ÿàÿßÿ≠ÿØ ŸáŸàÿß€å€å ŸÇÿØÿ±ÿ™ŸÖŸÜÿØ) Ÿà Ÿæ⁄©ÿß (Ÿàÿßÿ≠ÿØ ÿ≥ŸÜ⁄Ø€åŸÜ‚Äåÿ≤ÿ±Ÿá ÿ®ÿß ÿ¢ÿ≥€åÿ® ÿ®ÿ≥€åÿßÿ± ÿ®ÿßŸÑÿß)."
            },
            {
                title: "ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß",
                content: "ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß ÿ™ŸàÿßŸÜÿß€å€å‚ÄåŸáÿß€å Ÿà€å⁄òŸá‚Äåÿß€å Ÿáÿ≥ÿ™ŸÜÿØ ⁄©Ÿá ŸÖ€å‚Äåÿ™ŸàÿßŸÜŸÜÿØ ÿØÿ± ÿ≠ŸÖŸÑŸá ÿßÿ≥ÿ™ŸÅÿßÿØŸá ÿ¥ŸàŸÜÿØ. ÿßŸÜŸàÿßÿπ ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß ÿ¥ÿßŸÖŸÑ: ÿ∑ŸÑÿ≥ŸÖ ÿ±ÿπÿØ Ÿà ÿ®ÿ±ŸÇ (ÿ¢ÿ≥€åÿ® ÿ®Ÿá ⁄ÜŸÜÿØ ÿ≥ÿßÿ≤Ÿá)ÿå ÿ∑ŸÑÿ≥ŸÖ ÿØÿ±ŸÖÿßŸÜ (ÿØÿ±ŸÖÿßŸÜ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ)ÿå ÿ∑ŸÑÿ≥ŸÖ ÿÆÿ¥ŸÖ (ÿßŸÅÿ≤ÿß€åÿ¥ ÿ≥ÿ±ÿπÿ™ Ÿà ÿ¢ÿ≥€åÿ® ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ)ÿå ÿ∑ŸÑÿ≥ŸÖ ÿßŸÜÿ¨ŸÖÿßÿØ (ŸÖÿ™ŸàŸÇŸÅ ⁄©ÿ±ÿØŸÜ ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å ÿØŸÅÿßÿπ€å) Ÿà ÿ∑ŸÑÿ≥ŸÖ Ÿæÿ±ÿ¥ (ÿßÿ¨ÿßÿ≤Ÿá Ÿæÿ±ÿ¥ ÿßÿ≤ ÿ±Ÿà€å ÿØ€åŸàÿßÿ±Ÿáÿß) ŸÖ€å‚Äåÿ¥ŸàŸÜÿØ."
            },
            {
                title: "ÿ≠ŸÖŸÑŸá Ÿà ÿØŸÅÿßÿπ",
                content: "ŸÖ€å‚Äåÿ™ŸàÿßŸÜ€åÿØ ÿ®Ÿá ÿØŸá⁄©ÿØŸá‚ÄåŸáÿß€å ÿØ€å⁄Øÿ± ÿ≠ŸÖŸÑŸá ⁄©ŸÜ€åÿØ ÿ™ÿß ŸÖŸÜÿßÿ®ÿπ ÿ®Ÿá ÿØÿ≥ÿ™ ÿ¢Ÿàÿ±€åÿØ Ÿà ÿßŸÖÿ™€åÿßÿ≤ ⁄©ÿ≥ÿ® ⁄©ŸÜ€åÿØ. ŸáŸÖ⁄ÜŸÜ€åŸÜ ÿ®ÿß€åÿØ ÿØŸá⁄©ÿØŸá ÿÆŸàÿØ ÿ±ÿß ÿØÿ± ÿ®ÿ±ÿßÿ®ÿ± ÿ≠ŸÖŸÑÿßÿ™ ÿØ€å⁄Øÿ± ÿ®ÿßÿ≤€å⁄©ŸÜÿßŸÜ ŸÖÿ≠ÿßŸÅÿ∏ÿ™ ⁄©ŸÜ€åÿØ. ÿ®ÿ±ÿß€å ÿØŸÅÿßÿπ ŸÖŸàÿ´ÿ±ÿå ÿßÿ≤ ÿ™ÿ±⁄©€åÿ® ŸÖŸÜÿßÿ≥ÿ®€å ÿßÿ≤ ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å ÿØŸÅÿßÿπ€å Ÿà ÿØ€åŸàÿßÿ±Ÿáÿß ÿßÿ≥ÿ™ŸÅÿßÿØŸá ⁄©ŸÜ€åÿØ."
            },
            {
                title: "ŸÇÿ®€åŸÑŸá",
                content: "ŸÖ€å‚Äåÿ™ŸàÿßŸÜ€åÿØ ÿ®Ÿá €å⁄© ŸÇÿ®€åŸÑŸá ÿ®Ÿæ€åŸàŸÜÿØ€åÿØ €åÿß ŸÇÿ®€åŸÑŸá ÿÆŸàÿØ ÿ±ÿß ÿß€åÿ¨ÿßÿØ ⁄©ŸÜ€åÿØ. ÿßÿπÿ∂ÿß€å ŸÇÿ®€åŸÑŸá ŸÖ€å‚Äåÿ™ŸàÿßŸÜŸÜÿØ ÿ®Ÿá €å⁄©ÿØ€å⁄Øÿ± ÿ≥ÿ±ÿ®ÿßÿ≤ ÿßŸáÿØÿß ⁄©ŸÜŸÜÿØÿå ÿØÿ± ⁄Üÿ™ ŸÇÿ®€åŸÑŸá ⁄ØŸÅÿ™⁄ØŸà ⁄©ŸÜŸÜÿØ Ÿà ÿØÿ± ÿ¨ŸÜ⁄Ø‚ÄåŸáÿß€å ŸÇÿ®€åŸÑŸá ÿ¥ÿ±⁄©ÿ™ ⁄©ŸÜŸÜÿØ."
            },
            {
                title: "ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß Ÿà ⁄ÜÿßŸÑÿ¥‚ÄåŸáÿß",
                content: "ÿ®ÿß ÿßŸÜÿ¨ÿßŸÖ ŸÅÿπÿßŸÑ€åÿ™‚ÄåŸáÿß€å ŸÖÿÆÿ™ŸÑŸÅ ÿØÿ± ÿ®ÿßÿ≤€åÿå ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß Ÿà ⁄ÜÿßŸÑÿ¥‚ÄåŸáÿß ÿ±ÿß ⁄©ÿßŸÖŸÑ ⁄©ŸÜ€åÿØ ÿ™ÿß ŸæÿßÿØÿßÿ¥ ÿØÿ±€åÿßŸÅÿ™ ⁄©ŸÜ€åÿØ. ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß €å⁄©ÿ®ÿßÿ± ⁄©ÿßŸÖŸÑ ŸÖ€å‚Äåÿ¥ŸàŸÜÿØÿå ÿßŸÖÿß ⁄ÜÿßŸÑÿ¥‚ÄåŸáÿß ÿ®Ÿá ÿ∑Ÿàÿ± ÿØŸàÿ±Ÿá‚Äåÿß€å reset ŸÖ€å‚Äåÿ¥ŸàŸÜÿØ."
            }
        ];

        // ŸÖŸàÿßÿØ Three.js
        const materials = {
            grass: new THREE.MeshLambertMaterial({ color: 0x4CAF50 }),
            wood: new THREE.MeshLambertMaterial({ color: 0x8B4513 }),
            metal: new THREE.MeshLambertMaterial({ color: 0x607D8B, emissive: 0x102020 }),
            enemy: new THREE.MeshLambertMaterial({ color: 0xF44336, emissive: 0x330000 }),
            projectile: new THREE.MeshLambertMaterial({ color: 0xFF6B00, emissive: 0x662200 }),
            fire: new THREE.MeshBasicMaterial({ color: 0xFF4500, emissive: 0xFF2200 }),
            gold: new THREE.MeshLambertMaterial({ color: 0xFFD700, emissive: 0x333300 }),
            elixir: new THREE.MeshLambertMaterial({ color: 0x9C27B0, emissive: 0x330033 }),
            darkElixir: new THREE.MeshLambertMaterial({ color: 0x4A235A, emissive: 0x220022 }),
            highlight: new THREE.MeshBasicMaterial({ color: 0x00FF00, transparent: true, opacity: 0.6 }),
            soldier: new THREE.MeshLambertMaterial({ color: 0x2196F3, emissive: 0x001133 }),
            dragon: new THREE.MeshLambertMaterial({ color: 0xFF5722, emissive: 0x331100 }),
            enemyProjectile: new THREE.MeshLambertMaterial({ color: 0xFF0000, emissive: 0x330000 }),
            steel: new THREE.MeshLambertMaterial({ color: 0x708090, emissive: 0x101820, metalness: 0.8, roughness: 0.2 })
        };

        // ==================== ŸÅÿß€åŸÑ ÿØŸàŸÖ: ÿ±ÿßŸá‚ÄåÿßŸÜÿØÿßÿ≤€å Three.js Ÿà ÿß€åÿ¨ÿßÿØ ÿµÿ≠ŸÜŸá ====================
        
        // ÿ±ÿßŸá‚ÄåÿßŸÜÿØÿßÿ≤€å Three.js
        function initThreeJS() {
            // ÿß€åÿ¨ÿßÿØ ÿµÿ≠ŸÜŸá
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x87CEEB);
            scene.fog = new THREE.Fog(0x87CEEB, 100, 300);

            // ÿß€åÿ¨ÿßÿØ ÿØŸàÿ±ÿ®€åŸÜ
            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 100, 150);
            camera.lookAt(0, 0, 0);

            // ÿß€åÿ¨ÿßÿØ ÿ±ŸÜÿØÿ±ÿ±
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            document.getElementById('gameContainer').appendChild(renderer.domElement);

            // ⁄©ŸÜÿ™ÿ±ŸÑ‚ÄåŸáÿß€å ÿØŸàÿ±ÿ®€åŸÜ
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.minDistance = 50;
            controls.maxDistance = 300;
            controls.maxPolarAngle = Math.PI / 2;

            // ŸÜŸàÿ±Ÿæÿ±ÿØÿßÿ≤€å
            const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(50, 100, 50);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            scene.add(directionalLight);

            // ÿß€åÿ¨ÿßÿØ ÿ≤ŸÖ€åŸÜ
            createGround();
            
            // ÿß€åÿ¨ÿßÿØ Ÿæÿß€å⁄ØÿßŸá ÿßŸàŸÑ€åŸá
            createInitialStructures();

            // ÿ±ÿßŸá‚ÄåÿßŸÜÿØÿßÿ≤€å ÿ®ÿßÿ≤€å
            startGame();
        }

        // ÿß€åÿ¨ÿßÿØ ÿ≤ŸÖ€åŸÜ
        function createGround() {
            const groundGeometry = new THREE.PlaneGeometry(200, 200, 50, 50);
            const groundMaterial = new THREE.MeshLambertMaterial({ 
                color: 0x4CAF50,
                side: THREE.DoubleSide
            });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = -Math.PI / 2;
            ground.receiveShadow = true;
            scene.add(ground);

            // ÿß€åÿ¨ÿßÿØ grid ÿ±Ÿà€å ÿ≤ŸÖ€åŸÜ
            const gridHelper = new THREE.GridHelper(200, 20, 0x000000, 0x000000);
            gridHelper.material.opacity = 0.2;
            gridHelper.material.transparent = true;
            scene.add(gridHelper);
        }

        // ==================== ŸÅÿß€åŸÑ ÿ≥ŸàŸÖ: ÿ≥€åÿ≥ÿ™ŸÖ ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß Ÿà ÿ≥ÿßÿÆÿ™ Ÿà ÿ≥ÿßÿ≤ ====================
        
        // ÿß€åÿ¨ÿßÿØ ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å ÿßŸàŸÑ€åŸá
        function createInitialStructures() {
            // ÿ≥ÿßŸÑŸÜ ÿ¥Ÿáÿ± ÿØÿ± ŸÖÿ±⁄©ÿ≤
            createStructure('townhall', 0, 0);
            
            // ÿ≥ÿ±ÿ®ÿßÿ≤ÿÆÿßŸÜŸá
            createStructure('barracks', -20, 15);
            
            // ŸÖÿπÿØŸÜ ÿ∑ŸÑÿß
            createStructure('goldmine', 25, -20);
            
            // ÿ∏ÿ±ŸÅ ÿß⁄©ÿ≥€åÿ±
            createStructure('elixircollector', -25, -20);
            
            // ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©
            createStructure('darkelixirdrill', 0, -30);
            
            // ÿ™ŸàŸæ‚ÄåŸáÿß
            createStructure('cannon', 15, 25);
            createStructure('cannon', -15, 25);
            
            // ÿ®ÿ±ÿ¨ ⁄©ŸÖÿßŸÜÿØÿßÿ±
            createStructure('archertower', 30, 0);
            createStructure('archertower', -30, 0);
            
            // ÿÆŸÖŸæÿßÿ±Ÿá‚ÄåÿßŸÜÿØÿßÿ≤
            createStructure('mortar', 0, 30);
            
            // ÿ®ÿ±ÿ¨ ÿ¨ÿßÿØŸà⁄Øÿ±
            createStructure('wizardtower', 25, 25);
            createStructure('wizardtower', -25, 25);
            
            // ÿØ€åŸàÿßÿ±Ÿáÿß
            for (let i = -35; i <= 35; i += 10) {
                if (Math.abs(i) > 10) {
                    createStructure('wall', i, 35);
                    createStructure('wall', i, -35);
                    createStructure('wall', 35, i);
                    createStructure('wall', -35, i);
                }
            }
        }

        // ÿß€åÿ¨ÿßÿØ ÿ≥ÿßÿ≤Ÿá
        function createStructure(type, x, z) {
            const data = structureData[type];
            if (!data) return;

            let geometry, material, color;
            
            // ÿ™ÿπ€å€åŸÜ ÿ±ŸÜ⁄Ø ÿ®ÿ± ÿßÿ≥ÿßÿ≥ ŸÜŸàÿπ ÿ≥ÿßÿ≤Ÿá
            switch(type) {
                case 'townhall':
                    color = 0xFFD700;
                    geometry = new THREE.BoxGeometry(12, 8, 12);
                    break;
                case 'barracks':
                    color = 0x2196F3;
                    geometry = new THREE.BoxGeometry(8, 6, 8);
                    break;
                case 'goldmine':
                    color = 0xFFD700;
                    geometry = new THREE.CylinderGeometry(4, 5, 6, 8);
                    break;
                case 'elixircollector':
                    color = 0x9C27B0;
                    geometry = new THREE.CylinderGeometry(4, 5, 6, 8);
                    break;
                case 'darkelixirdrill':
                    color = 0x4A235A;
                    geometry = new THREE.CylinderGeometry(4, 5, 6, 8);
                    break;
                case 'cannon':
                    color = 0x795548;
                    geometry = new THREE.CylinderGeometry(3, 4, 5, 8);
                    break;
                case 'archertower':
                    color = 0x4CAF50;
                    geometry = new THREE.CylinderGeometry(3, 4, 8, 8);
                    break;
                case 'mortar':
                    color = 0x607D8B;
                    geometry = new THREE.CylinderGeometry(4, 5, 6, 8);
                    break;
                case 'wizardtower':
                    color = 0x9C27B0;
                    geometry = new THREE.CylinderGeometry(3, 4, 10, 8);
                    break;
                case 'wall':
                    color = 0x9E9E9E;
                    geometry = new THREE.BoxGeometry(8, 4, 2);
                    break;
                default:
                    color = 0xFFFFFF;
                    geometry = new THREE.BoxGeometry(5, 5, 5);
            }

            material = new THREE.MeshLambertMaterial({ color: color });
            const mesh = new THREE.Mesh(geometry, material);
            mesh.position.set(x, geometry.parameters.height / 2, z);
            mesh.castShadow = true;
            mesh.receiveShadow = true;
            scene.add(mesh);

            // ÿ∞ÿÆ€åÿ±Ÿá ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ≥ÿßÿ≤Ÿá
            const structure = {
                type: type,
                name: data.name,
                mesh: mesh,
                x: x,
                z: z,
                health: data.health,
                maxHealth: data.health,
                level: data.level,
                maxLevel: data.maxLevel,
                cost: data.cost,
                production: data.production,
                upgradeCostMultiplier: data.upgradeCostMultiplier,
                description: data.description,
                lastCollection: Date.now()
            };

            gameState.structures.push(structure);
            gameState.gameStats.structuresBuilt++;
            
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß
            updateAchievementProgress("first_building", 1);
            updateAchievementProgress("master_builder", 1);
            
            return structure;
        }

        // ==================== ŸÅÿß€åŸÑ ⁄ÜŸáÿßÿ±ŸÖ: ÿ≥€åÿ≥ÿ™ŸÖ ŸÖŸÜÿßÿ®ÿπ Ÿà ÿßŸÇÿ™ÿµÿßÿØ ====================
        
        // ÿ¨ŸÖÿπ‚Äåÿ¢Ÿàÿ±€å ŸÖŸÜÿßÿ®ÿπ ÿßÿ≤ ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß
        function collectResources() {
            const now = Date.now();
            
            gameState.structures.forEach(structure => {
                if (structure.production) {
                    // ÿ®ÿ±ÿ±ÿ≥€å ÿ¢€åÿß ÿ≥ÿßÿ≤Ÿá ŸÖŸÜÿßÿ®ÿπ ÿ™ŸàŸÑ€åÿØ ŸÖ€å‚Äå⁄©ŸÜÿØ
                    const timeSinceLastCollection = now - structure.lastCollection;
                    const collectionInterval = 5000; // Ÿáÿ± 5 ÿ´ÿßŸÜ€åŸá
                    
                    if (timeSinceLastCollection > collectionInterval) {
                        // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ŸÖŸÇÿØÿßÿ± ŸÖŸÜÿßÿ®ÿπ ÿ™ŸàŸÑ€åÿØ ÿ¥ÿØŸá
                        const productionMultiplier = timeSinceLastCollection / collectionInterval;
                        
                        if (structure.production.gold > 0) {
                            const goldProduced = Math.floor(structure.production.gold * productionMultiplier * structure.level);
                            gameState.resources.gold += goldProduced;
                            gameState.gameStats.resourcesCollected.gold += goldProduced;
                        }
                        
                        if (structure.production.elixir > 0) {
                            const elixirProduced = Math.floor(structure.production.elixir * productionMultiplier * structure.level);
                            gameState.resources.elixir += elixirProduced;
                            gameState.gameStats.resourcesCollected.elixir += elixirProduced;
                        }
                        
                        if (structure.production.darkElixir > 0) {
                            const darkElixirProduced = Math.floor(structure.production.darkElixir * productionMultiplier * structure.level);
                            gameState.resources.darkElixir += darkElixirProduced;
                            gameState.gameStats.resourcesCollected.darkElixir += darkElixirProduced;
                        }
                        
                        structure.lastCollection = now;
                        
                        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß
                        updateAchievementProgress("resource_collector", goldProduced);
                        updateAchievementProgress("elixir_master", elixirProduced);
                        updateAchievementProgress("dark_elixir_expert", darkElixirProduced);
                    }
                }
            });
            
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å UI
            updateUI();
        }

        // ==================== ŸÅÿß€åŸÑ ŸæŸÜÿ¨ŸÖ: ÿ≥€åÿ≥ÿ™ŸÖ ÿ¨ŸÜ⁄Ø Ÿà ÿØÿ¥ŸÖŸÜÿßŸÜ ====================
        
        // ÿ¥ÿ±Ÿàÿπ ÿ®ÿßÿ≤€å
        function startGame() {
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å UI
            updateUI();
            updateBaseHealth();
            
            // ÿ¥ÿ±Ÿàÿπ ÿ™ÿß€åŸÖÿ±Ÿáÿß€å ÿ®ÿßÿ≤€å
            setInterval(updateAttackTimer, 1000);
            setInterval(collectResources, 1000);
            setInterval(updateGameStats, 1000);
            
            // ÿ¥ÿ±Ÿàÿπ ÿßŸÜ€åŸÖ€åÿ¥ŸÜ
            animate();
            
            // ŸÜŸÖÿß€åÿ¥ ÿßÿ∑ŸÑÿßÿπ€åŸá
            showNotification("ÿØŸá⁄©ÿØŸá ÿ¥ŸÖÿß ÿß€åÿ¨ÿßÿØ ÿ¥ÿØ! ÿ¥ÿ±Ÿàÿπ ÿ®Ÿá ÿ≥ÿßÿÆÿ™ ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß ⁄©ŸÜ€åÿØ.");
        }

        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿ™ÿß€åŸÖÿ± ÿ≠ŸÖŸÑŸá
        function updateAttackTimer() {
            if (gameState.nextAttackTime > 0) {
                gameState.nextAttackTime--;
                document.getElementById('nextAttackTime').textContent = gameState.nextAttackTime;
            } else {
                // ÿ¥ÿ±Ÿàÿπ ÿ≠ŸÖŸÑŸá ÿ¨ÿØ€åÿØ
                startEnemyAttack();
                gameState.nextAttackTime = 20;
                gameState.waveNumber++;
                document.getElementById('waveNumber').textContent = gameState.waveNumber;
            }
        }

        // ÿ¥ÿ±Ÿàÿπ ÿ≠ŸÖŸÑŸá ÿØÿ¥ŸÖŸÜ
        function startEnemyAttack() {
            const enemyCount = 5 + gameState.waveNumber;
            gameState.enemyCount = enemyCount;
            
            // ÿß€åÿ¨ÿßÿØ ÿØÿ¥ŸÖŸÜÿßŸÜ
            for (let i = 0; i < enemyCount; i++) {
                createEnemy();
            }
            
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å UI
            document.getElementById('enemyCount').textContent = gameState.enemyCount;
            
            // ŸÜŸÖÿß€åÿ¥ ÿßÿ∑ŸÑÿßÿπ€åŸá
            showNotification(`ÿ≠ŸÖŸÑŸá ŸÖŸàÿ¨ ${gameState.waveNumber} ÿ¥ÿ±Ÿàÿπ ÿ¥ÿØ! ${enemyCount} ÿØÿ¥ŸÖŸÜ ÿ®Ÿá ÿØŸá⁄©ÿØŸá ÿ¥ŸÖÿß ÿ≠ŸÖŸÑŸá ŸÖ€å‚Äå⁄©ŸÜŸÜÿØ.`);
        }

        // ÿß€åÿ¨ÿßÿØ ÿØÿ¥ŸÖŸÜ
        function createEnemy() {
            const geometry = new THREE.CylinderGeometry(2, 2, 5, 8);
            const material = new THREE.MeshLambertMaterial({ color: 0xFF0000 });
            const mesh = new THREE.Mesh(geometry, material);
            
            // ŸÖŸàŸÇÿπ€åÿ™ ÿ™ÿµÿßÿØŸÅ€å ÿØÿ± ÿßÿ∑ÿ±ÿßŸÅ ÿØŸá⁄©ÿØŸá
            const angle = Math.random() * Math.PI * 2;
            const distance = 80 + Math.random() * 40;
            const x = Math.cos(angle) * distance;
            const z = Math.sin(angle) * distance;
            
            mesh.position.set(x, 2.5, z);
            mesh.castShadow = true;
            scene.add(mesh);
            
            const enemy = {
                mesh: mesh,
                x: x,
                z: z,
                health: 50 + (gameState.waveNumber * 10),
                maxHealth: 50 + (gameState.waveNumber * 10),
                damage: 10 + (gameState.waveNumber * 2),
                speed: 0.5 + (Math.random() * 0.3),
                target: null,
                attackCooldown: 0,
                type: 'ground'
            };
            
            gameState.enemies.push(enemy);
            return enemy;
        }

        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿØÿ¥ŸÖŸÜÿßŸÜ
        function updateEnemies() {
            for (let i = gameState.enemies.length - 1; i >= 0; i--) {
                const enemy = gameState.enemies[i];
                
                // Ÿæ€åÿØÿß ⁄©ÿ±ÿØŸÜ ŸÜÿ≤ÿØ€å⁄©‚Äåÿ™ÿ±€åŸÜ ÿ≥ÿßÿ≤Ÿá ÿ®Ÿá ÿπŸÜŸàÿßŸÜ ŸáÿØŸÅ
                if (!enemy.target) {
                    let closestDistance = Infinity;
                    let closestStructure = null;
                    
                    for (const structure of gameState.structures) {
                        const dx = structure.x - enemy.x;
                        const dz = structure.z - enemy.z;
                        const distance = Math.sqrt(dx * dx + dz * dz);
                        
                        if (distance < closestDistance) {
                            closestDistance = distance;
                            closestStructure = structure;
                        }
                    }
                    
                    enemy.target = closestStructure;
                }
                
                // ÿ≠ÿ±⁄©ÿ™ ÿ®Ÿá ÿ≥ŸÖÿ™ ŸáÿØŸÅ
                if (enemy.target) {
                    const dx = enemy.target.x - enemy.x;
                    const dz = enemy.target.z - enemy.z;
                    const distance = Math.sqrt(dx * dx + dz * dz);
                    
                    if (distance > 5) {
                        enemy.x += (dx / distance) * enemy.speed * 0.1;
                        enemy.z += (dz / distance) * enemy.speed * 0.1;
                        enemy.mesh.position.set(enemy.x, 2.5, enemy.z);
                    } else {
                        // ÿ≠ŸÖŸÑŸá ÿ®Ÿá ÿ≥ÿßÿ≤Ÿá
                        if (enemy.attackCooldown <= 0) {
                            enemy.target.health -= enemy.damage;
                            enemy.attackCooldown = 60; // 1 ÿ´ÿßŸÜ€åŸá
                            
                            // ÿß⁄Øÿ± ÿ≥ÿßÿ≤Ÿá ŸÜÿßÿ®ŸàÿØ ÿ¥ÿØ
                            if (enemy.target.health <= 0) {
                                removeStructure(enemy.target);
                                enemy.target = null;
                            }
                        } else {
                            enemy.attackCooldown--;
                        }
                    }
                } else {
                    // ÿ≠ŸÖŸÑŸá ÿ®Ÿá Ÿæÿß€å⁄ØÿßŸá ÿßÿµŸÑ€å
                    const dx = -enemy.x;
                    const dz = -enemy.z;
                    const distance = Math.sqrt(dx * dx + dz * dz);
                    
                    if (distance > 5) {
                        enemy.x += (dx / distance) * enemy.speed * 0.1;
                        enemy.z += (dz / distance) * enemy.speed * 0.1;
                        enemy.mesh.position.set(enemy.x, 2.5, enemy.z);
                    } else {
                        // ÿ≠ŸÖŸÑŸá ÿ®Ÿá Ÿæÿß€å⁄ØÿßŸá
                        if (enemy.attackCooldown <= 0) {
                            gameState.baseHealth -= enemy.damage;
                            enemy.attackCooldown = 60;
                            
                            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿ≥ŸÑÿßŸÖÿ™ Ÿæÿß€å⁄ØÿßŸá
                            updateBaseHealth();
                            
                            // ÿß⁄Øÿ± Ÿæÿß€å⁄ØÿßŸá ŸÜÿßÿ®ŸàÿØ ÿ¥ÿØ
                            if (gameState.baseHealth <= 0) {
                                gameState.baseHealth = 0;
                                showNotification("Ÿæÿß€å⁄ØÿßŸá ÿ¥ŸÖÿß ŸÜÿßÿ®ŸàÿØ ÿ¥ÿØ! ÿ®ÿßÿ≤€å ÿ±ÿß ÿßÿ≤ ÿØÿ≥ÿ™ ÿØÿßÿØ€åÿØ.");
                            }
                        } else {
                            enemy.attackCooldown--;
                        }
                    }
                }
                
                // ÿ®ÿ±ÿ±ÿ≥€å ÿ≥ŸÑÿßŸÖÿ™ ÿØÿ¥ŸÖŸÜ
                if (enemy.health <= 0) {
                    scene.remove(enemy.mesh);
                    gameState.enemies.splice(i, 1);
                    gameState.enemyCount--;
                    document.getElementById('enemyCount').textContent = gameState.enemyCount;
                    
                    // ŸæÿßÿØÿßÿ¥ ÿ®ÿ±ÿß€å ÿ¥⁄©ÿ≥ÿ™ ÿØÿ¥ŸÖŸÜ
                    gameState.resources.gold += 50;
                    gameState.resources.elixir += 25;
                    gameState.gameStats.enemiesDefeated++;
                    
                    // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å UI Ÿà ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß
                    updateUI();
                    updateAchievementProgress("defense_expert", 1);
                }
            }
        }

        // ==================== ŸÅÿß€åŸÑ ÿ¥ÿ¥ŸÖ: ÿ≥€åÿ≥ÿ™ŸÖ UI Ÿà ÿ±ÿßÿ®ÿ∑ ⁄©ÿßÿ±ÿ®ÿ±€å ====================
        
        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å UI
        function updateUI() {
            document.getElementById('goldCount').textContent = gameState.resources.gold.toLocaleString();
            document.getElementById('elixirCount').textContent = gameState.resources.elixir.toLocaleString();
            document.getElementById('darkElixirCount').textContent = gameState.resources.darkElixir.toLocaleString();
            document.getElementById('gemsCount').textContent = gameState.resources.gems.toLocaleString();
            document.getElementById('playerLevelValue').textContent = gameState.playerLevel;
            document.getElementById('playerName').textContent = gameState.playerName;
        }

        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿ≥ŸÑÿßŸÖÿ™ Ÿæÿß€å⁄ØÿßŸá
        function updateBaseHealth() {
            document.getElementById('healthValue').textContent = gameState.baseHealth;
            document.getElementById('maxHealthValue').textContent = gameState.maxBaseHealth;
            
            const healthPercent = (gameState.baseHealth / gameState.maxBaseHealth) * 100;
            document.getElementById('healthBar').style.width = `${healthPercent}%`;
        }

        // ŸÜŸÖÿß€åÿ¥ ÿßÿ∑ŸÑÿßÿπ€åŸá
        function showNotification(text) {
            const notification = document.getElementById('notification');
            document.getElementById('notificationText').textContent = text;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // ÿßŸÜÿ™ÿÆÿßÿ® ÿ≥ÿßÿ≤Ÿá
        function selectStructure(structure) {
            gameState.selectedStructure = structure;
            
            // ŸÜŸÖÿß€åÿ¥ ŸæŸÜŸÑ ÿ≥ÿßÿ≤Ÿá ÿßŸÜÿ™ÿÆÿßÿ® ÿ¥ÿØŸá
            document.getElementById('structureName').textContent = structure.name;
            document.getElementById('structureLevel').textContent = structure.level;
            document.getElementById('structureHealth').textContent = structure.health;
            document.getElementById('structureMaxHealth').textContent = structure.maxHealth;
            
            document.getElementById('selectedStructure').style.display = 'flex';
        }

        // ŸæŸÜŸáÿßŸÜ ⁄©ÿ±ÿØŸÜ ŸæŸÜŸÑ ÿ≥ÿßÿ≤Ÿá
        function hideStructurePanel() {
            document.getElementById('selectedStructure').style.display = 'none';
            gameState.selectedStructure = null;
        }

        // ÿßÿ±ÿ™ŸÇÿßÿ° ÿ≥ÿßÿ≤Ÿá
        function upgradeStructure(structure) {
            const nextLevel = structure.level + 1;
            
            if (nextLevel > structure.maxLevel) {
                showNotification("ÿß€åŸÜ ÿ≥ÿßÿ≤Ÿá ÿ®Ÿá ÿ≠ÿØÿß⁄©ÿ´ÿ± ÿ≥ÿ∑ÿ≠ ÿÆŸàÿØ ÿ±ÿ≥€åÿØŸá ÿßÿ≥ÿ™!");
                return;
            }
            
            // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá Ÿáÿ≤€åŸÜŸá ÿßÿ±ÿ™ŸÇÿßÿ°
            const upgradeCost = {
                gold: Math.floor(structure.cost.gold * Math.pow(structure.upgradeCostMultiplier, nextLevel - 1)),
                elixir: Math.floor(structure.cost.elixir * Math.pow(structure.upgradeCostMultiplier, nextLevel - 1)),
                darkElixir: Math.floor(structure.cost.darkElixir * Math.pow(structure.upgradeCostMultiplier, nextLevel - 1))
            };
            
            // ÿ®ÿ±ÿ±ÿ≥€å ŸÖŸÜÿßÿ®ÿπ ⁄©ÿßŸÅ€å
            if (gameState.resources.gold < upgradeCost.gold || 
                gameState.resources.elixir < upgradeCost.elixir || 
                gameState.resources.darkElixir < upgradeCost.darkElixir) {
                showNotification("ŸÖŸÜÿßÿ®ÿπ ⁄©ÿßŸÅ€å ÿ®ÿ±ÿß€å ÿßÿ±ÿ™ŸÇÿßÿ° ŸÜÿØÿßÿ±€åÿØ!");
                return;
            }
            
            // ⁄©ÿ≥ÿ± ŸÖŸÜÿßÿ®ÿπ
            gameState.resources.gold -= upgradeCost.gold;
            gameState.resources.elixir -= upgradeCost.elixir;
            gameState.resources.darkElixir -= upgradeCost.darkElixir;
            
            // ÿßÿ±ÿ™ŸÇÿßÿ° ÿ≥ÿßÿ≤Ÿá
            structure.level = nextLevel;
            structure.health += 100;
            structure.maxHealth += 100;
            
            // ÿßŸÅÿ≤ÿß€åÿ¥ ÿ™ŸàŸÑ€åÿØ ŸÖŸÜÿßÿ®ÿπ ÿ®ÿ±ÿß€å ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å ÿ™ŸàŸÑ€åÿØ€å
            if (structure.production) {
                structure.production.gold = Math.floor(structure.production.gold * 1.2);
                structure.production.elixir = Math.floor(structure.production.elixir * 1.2);
                structure.production.darkElixir = Math.floor(structure.production.darkElixir * 1.2);
            }
            
            // ÿ™ÿ∫€å€åÿ± ÿ±ŸÜ⁄Ø ÿ≥ÿßÿ≤Ÿá ÿ®ÿ± ÿßÿ≥ÿßÿ≥ ÿ≥ÿ∑ÿ≠
            const hue = (nextLevel / structure.maxLevel) * 120; // ÿßÿ≤ ÿ≥ÿ®ÿ≤ ÿ®Ÿá ÿ≤ÿ±ÿØ ÿ®Ÿá ŸÇÿ±ŸÖÿ≤
            structure.mesh.material.color.setHSL(hue / 360, 0.8, 0.5);
            
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å UI
            updateUI();
            selectStructure(structure); // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ŸæŸÜŸÑ ÿ≥ÿßÿ≤Ÿá
            
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß
            if (structure.type === 'townhall') {
                updateAchievementProgress("town_hall_upgrader", 1);
            }
            updateAchievementProgress("monthly_builder", 1);
            
            showNotification(`${structure.name} ÿ®Ÿá ÿ≥ÿ∑ÿ≠ ${nextLevel} ÿßÿ±ÿ™ŸÇÿßÿ° €åÿßŸÅÿ™!`);
        }

        // ==================== ŸÅÿß€åŸÑ ŸáŸÅÿ™ŸÖ: ÿ≥€åÿ≥ÿ™ŸÖ ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß Ÿà ⁄ÜÿßŸÑÿ¥‚ÄåŸáÿß ====================
        
        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å Ÿæ€åÿ¥ÿ±ŸÅÿ™ ÿØÿ≥ÿ™ÿßŸàÿ±ÿØ
        function updateAchievementProgress(achievementId, progress) {
            const achievement = gameState.achievements.find(a => a.id === achievementId);
            if (!achievement || achievement.completed) return;
            
            achievement.progress += progress;
            
            if (achievement.progress >= achievement.target) {
                achievement.completed = true;
                
                // ÿßÿπÿ∑ÿß€å ŸæÿßÿØÿßÿ¥
                gameState.resources.gold += achievement.reward.gold;
                gameState.resources.elixir += achievement.reward.elixir;
                gameState.resources.darkElixir += achievement.reward.darkElixir;
                gameState.resources.gems += achievement.reward.gems;
                
                // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å UI
                updateUI();
                
                // ŸÜŸÖÿß€åÿ¥ ÿßÿ∑ŸÑÿßÿπ€åŸá
                showNotification(`ÿØÿ≥ÿ™ÿßŸàÿ±ÿØ "${achievement.name}" ⁄©ÿßŸÖŸÑ ÿ¥ÿØ! ŸæÿßÿØÿßÿ¥ ÿØÿ±€åÿßŸÅÿ™ ⁄©ÿ±ÿØ€åÿØ.`);
            }
        }

        // ==================== ŸÅÿß€åŸÑ Ÿáÿ¥ÿ™ŸÖ: ÿ≥€åÿ≥ÿ™ŸÖ ÿ∞ÿÆ€åÿ±Ÿá Ÿà ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ====================
        
        // ÿ∞ÿÆ€åÿ±Ÿá ÿ®ÿßÿ≤€å
        function saveGame(slot) {
            const saveData = {
                gameState: gameState,
                timestamp: Date.now()
            };
            
            localStorage.setItem(`clash3d_save_${slot}`, JSON.stringify(saveData));
            showNotification(`ÿ®ÿßÿ≤€å ÿØÿ± ÿßÿ≥ŸÑÿßÿ™ ${slot} ÿ∞ÿÆ€åÿ±Ÿá ÿ¥ÿØ.`);
        }

        // ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿ®ÿßÿ≤€å
        function loadGame(slot) {
            const saveData = localStorage.getItem(`clash3d_save_${slot}`);
            
            if (saveData) {
                const parsedData = JSON.parse(saveData);
                gameState = parsedData.gameState;
                
                // ÿ®ÿßÿ≤ÿ≥ÿßÿ≤€å ÿµÿ≠ŸÜŸá Three.js
                rebuildScene();
                
                // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å UI
                updateUI();
                updateBaseHealth();
                
                showNotification(`ÿ®ÿßÿ≤€å ÿßÿ≤ ÿßÿ≥ŸÑÿßÿ™ ${slot} ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿ¥ÿØ.`);
            } else {
                showNotification("Ÿá€å⁄Ü ÿ®ÿßÿ≤€å ÿ∞ÿÆ€åÿ±Ÿá ÿ¥ÿØŸá‚Äåÿß€å ÿØÿ± ÿß€åŸÜ ÿßÿ≥ŸÑÿßÿ™ Ÿàÿ¨ŸàÿØ ŸÜÿØÿßÿ±ÿØ.");
            }
        }

        // ÿ®ÿßÿ≤ÿ≥ÿßÿ≤€å ÿµÿ≠ŸÜŸá Ÿæÿ≥ ÿßÿ≤ ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å
        function rebuildScene() {
            // ÿ≠ÿ∞ŸÅ ŸáŸÖŸá ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß€å ŸÖŸàÿ¨ŸàÿØ ÿßÿ≤ ÿµÿ≠ŸÜŸá
            gameState.structures.forEach(structure => {
                if (structure.mesh && structure.mesh.parent) {
                    scene.remove(structure.mesh);
                }
            });
            
            // ÿß€åÿ¨ÿßÿØ ŸÖÿ¨ÿØÿØ ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß
            gameState.structures.forEach(structure => {
                createStructure(structure.type, structure.x, structure.z);
            });
        }

        // ==================== ŸÅÿß€åŸÑ ŸÜŸáŸÖ: ÿ≥€åÿ≥ÿ™ŸÖ ŸÖÿØ€åÿ±€åÿ™ ÿ±Ÿà€åÿØÿßÿØŸáÿß ====================
        
        // ÿ±ÿßŸá‚ÄåÿßŸÜÿØÿßÿ≤€å ŸÖÿØ€åÿ±€åÿ™ ÿ±Ÿà€åÿØÿßÿØŸáÿß
        function setupEventListeners() {
            // ÿØ⁄©ŸÖŸá ÿ¥ÿ±Ÿàÿπ ÿ®ÿßÿ≤€å
            document.getElementById('startGameBtn').addEventListener('click', function() {
                document.getElementById('mainMenu').style.display = 'none';
                initThreeJS();
            });
            
            // ÿØ⁄©ŸÖŸá ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿ®ÿßÿ≤€å
            document.getElementById('loadGameBtn').addEventListener('click', function() {
                document.getElementById('saveLoadUI').style.display = 'block';
                showSaveLoadUI();
            });
            
            // ÿØ⁄©ŸÖŸá ÿ¢ŸÖŸàÿ≤ÿ¥
            document.getElementById('tutorialBtn').addEventListener('click', function() {
                document.getElementById('tutorial').style.display = 'block';
            });
            
            // ÿØ⁄©ŸÖŸá ÿ®ÿ≥ÿ™ŸÜ ÿ¢ŸÖŸàÿ≤ÿ¥
            document.getElementById('closeTutorialBtn').addEventListener('click', function() {
                document.getElementById('tutorial').style.display = 'none';
            });
            
            // ÿØ⁄©ŸÖŸá‚ÄåŸáÿß€å ÿ≥ÿßÿÆÿ™
            const buildButtons = document.querySelectorAll('.build-button');
            buildButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const buildingType = this.getAttribute('data-building');
                    showBuildUI(buildingType);
                });
            });
            
            // ÿØ⁄©ŸÖŸá ÿßÿ±ÿ™ŸÇÿßÿ° ÿ≥ÿßÿ≤Ÿá
            document.getElementById('upgradeStructureBtn').addEventListener('click', function() {
                if (gameState.selectedStructure) {
                    upgradeStructure(gameState.selectedStructure);
                }
            });
            
            // ÿØ⁄©ŸÖŸá ÿ≠ŸÖŸÑŸá
            document.getElementById('attackBtn').addEventListener('click', function() {
                showBattleUI();
            });
            
            // ÿØ⁄©ŸÖŸá ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤
            document.getElementById('trainTroopsBtn').addEventListener('click', function() {
                showTroopTrainingUI();
            });
            
            // ÿØ⁄©ŸÖŸá ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß
            document.getElementById('spellsBtn').addEventListener('click', function() {
                showSpellsUI();
            });
            
            // ÿØ⁄©ŸÖŸá ⁄©ŸÜÿßÿ± ŸæŸÜŸÑ
            document.getElementById('toggleSidePanel').addEventListener('click', function() {
                document.getElementById('sidePanel').classList.toggle('open');
                this.querySelector('i').classList.toggle('fa-chevron-left');
                this.querySelector('i').classList.toggle('fa-chevron-right');
            });
            
            // ÿØ⁄©ŸÖŸá ⁄Üÿ™
            document.getElementById('toggleChat').addEventListener('click', function() {
                document.getElementById('chatPanel').classList.toggle('open');
            });
            
            // ÿØ⁄©ŸÖŸá ÿßÿ±ÿ≥ÿßŸÑ ⁄Üÿ™
            document.getElementById('sendChatBtn').addEventListener('click', function() {
                const chatInput = document.getElementById('chatInput');
                const message = chatInput.value.trim();
                
                if (message) {
                    addChatMessage(gameState.playerName, message);
                    chatInput.value = '';
                }
            });
            
            // ÿßÿ±ÿ≥ÿßŸÑ ⁄Üÿ™ ÿ®ÿß Enter
            document.getElementById('chatInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('sendChatBtn').click();
                }
            });
            
            // ÿØ⁄©ŸÖŸá‚ÄåŸáÿß€å ŸæŸÜŸÑ ⁄©ŸÜÿßÿ±€å
            document.getElementById('clanBtn').addEventListener('click', function() {
                showClanUI();
            });
            
            document.getElementById('achievementsBtn').addEventListener('click', function() {
                showAchievementsUI();
            });
            
            document.getElementById('shopBtn').addEventListener('click', function() {
                showShopUI();
            });
            
            document.getElementById('leaderboardBtn').addEventListener('click', function() {
                showLeaderboardUI();
            });
            
            document.getElementById('settingsMenuBtn').addEventListener('click', function() {
                showSettingsUI();
            });
            
            document.getElementById('saveGameBtn').addEventListener('click', function() {
                showSaveLoadUI();
            });
            
            document.getElementById('exitGameBtn').addEventListener('click', function() {
                document.getElementById('mainMenu').style.display = 'flex';
                // ÿ™ŸàŸÇŸÅ ÿ®ÿßÿ≤€å
                if (renderer) {
                    document.getElementById('gameContainer').innerHTML = '';
                }
            });
            
            // ⁄©ŸÑ€å⁄© ÿ±Ÿà€å ÿ≥ÿßÿ≤Ÿá‚ÄåŸáÿß
            if (renderer) {
                renderer.domElement.addEventListener('click', (event) => {
                    const mouse = new THREE.Vector2();
                    mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
                    mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
                    
                    const raycaster = new THREE.Raycaster();
                    raycaster.setFromCamera(mouse, camera);
                    
                    const intersects = raycaster.intersectObjects(scene.children);
                    
                    if (intersects.length > 0) {
                        const clickedObject = intersects[0].object;
                        
                        // Ÿæ€åÿØÿß ⁄©ÿ±ÿØŸÜ ÿ≥ÿßÿ≤Ÿá ŸÖÿ±ÿ®Ÿàÿ∑Ÿá
                        for (const structure of gameState.structures) {
                            if (structure.mesh === clickedObject) {
                                selectStructure(structure);
                                return;
                            }
                        }
                        
                        // ÿß⁄Øÿ± ÿ±Ÿà€å ÿ≤ŸÖ€åŸÜ ⁄©ŸÑ€å⁄© ÿ¥ÿØÿå ŸæŸÜŸÑ ÿ≥ÿßÿ≤Ÿá ÿ±ÿß ŸæŸÜŸáÿßŸÜ ⁄©ŸÜ
                        hideStructurePanel();
                    }
                });
            }
            
            // ÿ™ÿ∫€å€åÿ± ÿßŸÜÿØÿßÿ≤Ÿá ŸæŸÜÿ¨ÿ±Ÿá
            window.addEventListener('resize', () => {
                if (camera && renderer) {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                }
            });
        }

        // ==================== ŸÅÿß€åŸÑ ÿØŸáŸÖ: ÿ≥€åÿ≥ÿ™ŸÖ ÿßŸÜ€åŸÖ€åÿ¥ŸÜ Ÿà ÿ≠ŸÑŸÇŸá ÿ®ÿßÿ≤€å ====================
        
        // ÿßŸÜ€åŸÖ€åÿ¥ŸÜ ÿ®ÿßÿ≤€å
        function animate() {
            requestAnimationFrame(animate);
            
            if (controls) {
                controls.update();
            }
            
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿßÿ¨ÿ≤ÿß€å ÿ®ÿßÿ≤€å
            updateEnemies();
            updateProjectiles();
            updateTroops();
            updateSpells();
            
            // ÿ±ŸÜÿØÿ± ÿµÿ≠ŸÜŸá
            if (renderer && scene && camera) {
                renderer.render(scene, camera);
            }
            
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å FPS
            updateFPS();
        }

        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å Ÿæÿ±ÿ™ÿßÿ®Ÿá‚ÄåŸáÿß
        function updateProjectiles() {
            // ÿß€åŸÜ ÿ™ÿßÿ®ÿπ Ÿæÿ±ÿ™ÿßÿ®Ÿá‚ÄåŸáÿß ÿ±ÿß ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ŸÖ€å‚Äå⁄©ŸÜÿØ
            // Ÿæ€åÿßÿØŸá‚Äåÿ≥ÿßÿ≤€å ⁄©ÿßŸÖŸÑ ŸÜ€åÿßÿ≤ ÿ®Ÿá ÿ≤ŸÖÿßŸÜ ÿ®€åÿ¥ÿ™ÿ±€å ÿØÿßÿ±ÿØ
        }

        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ
        function updateTroops() {
            // ÿß€åŸÜ ÿ™ÿßÿ®ÿπ ÿ≥ÿ±ÿ®ÿßÿ≤ÿßŸÜ ÿ±ÿß ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ŸÖ€å‚Äå⁄©ŸÜÿØ
            // Ÿæ€åÿßÿØŸá‚Äåÿ≥ÿßÿ≤€å ⁄©ÿßŸÖŸÑ ŸÜ€åÿßÿ≤ ÿ®Ÿá ÿ≤ŸÖÿßŸÜ ÿ®€åÿ¥ÿ™ÿ±€å ÿØÿßÿ±ÿØ
        }

        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß
        function updateSpells() {
            // ÿß€åŸÜ ÿ™ÿßÿ®ÿπ ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß ÿ±ÿß ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ŸÖ€å‚Äå⁄©ŸÜÿØ
            // Ÿæ€åÿßÿØŸá‚Äåÿ≥ÿßÿ≤€å ⁄©ÿßŸÖŸÑ ŸÜ€åÿßÿ≤ ÿ®Ÿá ÿ≤ŸÖÿßŸÜ ÿ®€åÿ¥ÿ™ÿ±€å ÿØÿßÿ±ÿØ
        }

        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å FPS
        function updateFPS() {
            // ÿß€åŸÜ ÿ™ÿßÿ®ÿπ FPS ÿ±ÿß ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ŸÖ€å‚Äå⁄©ŸÜÿØ
            // Ÿæ€åÿßÿØŸá‚Äåÿ≥ÿßÿ≤€å ⁄©ÿßŸÖŸÑ ŸÜ€åÿßÿ≤ ÿ®Ÿá ÿ≤ŸÖÿßŸÜ ÿ®€åÿ¥ÿ™ÿ±€å ÿØÿßÿ±ÿØ
        }

        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿ¢ŸÖÿßÿ± ÿ®ÿßÿ≤€å
        function updateGameStats() {
            gameState.gameStats.totalPlayTime++;
        }

        // ==================== ŸÅÿß€åŸÑ €åÿßÿ≤ÿØŸáŸÖ: UIŸáÿß€å ŸÖÿÆÿ™ŸÑŸÅ ÿ®ÿßÿ≤€å ====================
        
        // ŸÜŸÖÿß€åÿ¥ UI ÿ≥ÿßÿÆÿ™
        function showBuildUI(buildingType) {
            document.getElementById('buildUI').style.display = 'block';
            
            const buildOptionsContainer = document.getElementById('buildOptionsContainer');
            buildOptionsContainer.innerHTML = '';
            
            // ÿß€åÿ¨ÿßÿØ ⁄Øÿ≤€åŸÜŸá‚ÄåŸáÿß€å ÿ≥ÿßÿÆÿ™
            for (const type in structureData) {
                if (type === 'townhall') continue; // ÿ≥ÿßŸÑŸÜ ÿ¥Ÿáÿ± ŸÅŸÇÿ∑ €å⁄©€å ŸÖ€å‚Äåÿ™ŸàÿßŸÜÿØ ÿ®ÿßÿ¥ÿØ
                
                const data = structureData[type];
                const option = document.createElement('div');
                option.className = 'build-option';
                option.innerHTML = `
                    <i class="fas fa-${getBuildingIcon(type)}"></i>
                    <h3>${data.name}</h3>
                    <p>Ÿáÿ≤€åŸÜŸá: ${data.cost.gold} ÿ∑ŸÑÿß ${data.cost.elixir > 0 ? `, ${data.cost.elixir} ÿß⁄©ÿ≥€åÿ±` : ''} ${data.cost.darkElixir > 0 ? `, ${data.cost.darkElixir} ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©` : ''}</p>
                    <p>${data.description}</p>
                `;
                
                option.addEventListener('click', function() {
                    buildStructure(type);
                    document.getElementById('buildUI').style.display = 'none';
                });
                
                buildOptionsContainer.appendChild(option);
            }
        }

        // ŸÜŸÖÿß€åÿ¥ UI ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤
        function showTroopTrainingUI() {
            document.getElementById('troopTrainingUI').style.display = 'block';
            
            const troopOptionsContainer = document.getElementById('troopOptionsContainer');
            troopOptionsContainer.innerHTML = '';
            
            // ÿß€åÿ¨ÿßÿØ ⁄Øÿ≤€åŸÜŸá‚ÄåŸáÿß€å ÿ≥ÿ±ÿ®ÿßÿ≤
            for (const type in troopData) {
                const data = troopData[type];
                const option = document.createElement('div');
                option.className = 'troop-option';
                option.innerHTML = `
                    <i class="fas fa-${getTroopIcon(type)}"></i>
                    <h3>${data.name}</h3>
                    <p>Ÿáÿ≤€åŸÜŸá: ${data.cost.elixir} ÿß⁄©ÿ≥€åÿ± ${data.cost.darkElixir > 0 ? `, ${data.cost.darkElixir} ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©` : ''}</p>
                    <p>ÿ≤ŸÖÿßŸÜ ÿ¢ŸÖŸàÿ≤ÿ¥: ${data.trainingTime} ÿ´ÿßŸÜ€åŸá</p>
                    <p>${data.description}</p>
                `;
                
                option.addEventListener('click', function() {
                    trainTroop(type);
                    document.getElementById('troopTrainingUI').style.display = 'none';
                });
                
                troopOptionsContainer.appendChild(option);
            }
        }

        // ŸÜŸÖÿß€åÿ¥ UI ÿ∑ŸÑÿ≥ŸÖ‚ÄåŸáÿß
        function showSpellsUI() {
            document.getElementById('spellsUI').style.display = 'block';
            
            const spellOptionsContainer = document.getElementById('spellOptionsContainer');
            spellOptionsContainer.innerHTML = '';
            
            // ÿß€åÿ¨ÿßÿØ ⁄Øÿ≤€åŸÜŸá‚ÄåŸáÿß€å ÿ∑ŸÑÿ≥ŸÖ
            for (const type in spellData) {
                const data = spellData[type];
                const option = document.createElement('div');
                option.className = 'spell-option';
                option.innerHTML = `
                    <i class="fas fa-${getSpellIcon(type)}"></i>
                    <h3>${data.name}</h3>
                    <p>Ÿáÿ≤€åŸÜŸá: ${data.cost.elixir} ÿß⁄©ÿ≥€åÿ± ${data.cost.darkElixir > 0 ? `, ${data.cost.darkElixir} ÿß⁄©ÿ≥€åÿ± ÿ™ÿßÿ±€å⁄©` : ''}</p>
                    <p>ÿ≤ŸÖÿßŸÜ ÿ≥ÿßÿÆÿ™: ${data.brewingTime} ÿ´ÿßŸÜ€åŸá</p>
                    <p>${data.description}</p>
                `;
                
                option.addEventListener('click', function() {
                    brewSpell(type);
                    document.getElementById('spellsUI').style.display = 'none';
                });
                
                spellOptionsContainer.appendChild(option);
            }
        }

        // ŸÜŸÖÿß€åÿ¥ UI ŸÇÿ®€åŸÑŸá
        function showClanUI() {
            document.getElementById('clanUI').style.display = 'block';
            
            const clanContent = document.getElementById('clanContent');
            
            if (gameState.clan) {
                clanContent.innerHTML = `
                    <h3>${gameState.clan.name}</h3>
                    <p>ÿßÿπÿ∂ÿß: ${gameState.clan.members.length}/50</p>
                    <p>ÿ≥ÿ∑ÿ≠ ŸÇÿ®€åŸÑŸá: ${gameState.clan.level}</p>
                    <p>ÿßŸÖÿ™€åÿßÿ≤ ŸÇÿ®€åŸÑŸá: ${gameState.clan.score}</p>
                `;
            } else {
                clanContent.innerHTML = `
                    <h3>ÿ¥ŸÖÿß ÿØÿ± Ÿá€å⁄Ü ŸÇÿ®€åŸÑŸá‚Äåÿß€å ŸÜ€åÿ≥ÿ™€åÿØ</h3>
                    <p>ŸÖ€å‚Äåÿ™ŸàÿßŸÜ€åÿØ €å⁄© ŸÇÿ®€åŸÑŸá ÿß€åÿ¨ÿßÿØ ⁄©ŸÜ€åÿØ €åÿß ÿ®Ÿá €å⁄© ŸÇÿ®€åŸÑŸá ŸÖŸàÿ¨ŸàÿØ ÿ®Ÿæ€åŸàŸÜÿØ€åÿØ.</p>
                    <button class="upgrade-button" style="margin: 10px;">ÿß€åÿ¨ÿßÿØ ŸÇÿ®€åŸÑŸá</button>
                    <button class="upgrade-button" style="margin: 10px;">ÿ¨ÿ≥ÿ™ÿ¨Ÿà€å ŸÇÿ®€åŸÑŸá</button>
                `;
            }
        }

        // ŸÜŸÖÿß€åÿ¥ UI ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß
        function showAchievementsUI() {
            document.getElementById('achievementsUI').style.display = 'block';
            
            const achievementsContainer = document.getElementById('achievementsContainer');
            achievementsContainer.innerHTML = '';
            
            // ÿß€åÿ¨ÿßÿØ ŸÑ€åÿ≥ÿ™ ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß
            gameState.achievements.forEach(achievement => {
                const achievementItem = document.createElement('div');
                achievementItem.className = 'achievement-item';
                
                const progressPercent = (achievement.progress / achievement.target) * 100;
                
                achievementItem.innerHTML = `
                    <div class="achievement-icon">
                        <i class="fas fa-${achievement.completed ? 'trophy' : 'star'}"></i>
                    </div>
                    <h4>${achievement.name}</h4>
                    <p>${achievement.description}</p>
                    <div class="achievement-progress">
                        <div class="achievement-progress-bar" style="width: ${progressPercent}%"></div>
                    </div>
                    <p>${achievement.progress}/${achievement.target}</p>
                    <p>ŸæÿßÿØÿßÿ¥: ${achievement.reward.gold} ÿ∑ŸÑÿß, ${achievement.reward.elixir} ÿß⁄©ÿ≥€åÿ±, ${achievement.reward.gems} ÿ¨ŸàÿßŸáÿ±</p>
                `;
                
                achievementsContainer.appendChild(achievementItem);
            });
        }

        // ŸÜŸÖÿß€åÿ¥ UI ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá
        function showShopUI() {
            document.getElementById('shopUI').style.display = 'block';
            
            const shopItemsContainer = document.getElementById('shopItemsContainer');
            shopItemsContainer.innerHTML = '';
            
            // ÿß€åÿ¨ÿßÿØ ÿ¢€åÿ™ŸÖ‚ÄåŸáÿß€å ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá
            shopData.resources.forEach(item => {
                const shopItem = document.createElement('div');
                shopItem.className = 'shop-item';
                shopItem.innerHTML = `
                    <div class="shop-item-icon">
                        <i class="fas fa-${getResourceIcon(item.amount)}"></i>
                    </div>
                    <h4>${item.name}</h4>
                    <p>${item.description}</p>
                    <p>ŸÇ€åŸÖÿ™: ${item.cost.gems} ÿ¨ŸàÿßŸáÿ±</p>
                `;
                
                shopItem.addEventListener('click', function() {
                    purchaseShopItem(item);
                });
                
                shopItemsContainer.appendChild(shopItem);
            });
        }

        // ŸÜŸÖÿß€åÿ¥ UI ÿ∞ÿÆ€åÿ±Ÿá Ÿà ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å
        function showSaveLoadUI() {
            document.getElementById('saveLoadUI').style.display = 'block';
            
            const saveSlotsContainer = document.getElementById('saveSlotsContainer');
            saveSlotsContainer.innerHTML = '';
            
            // ÿß€åÿ¨ÿßÿØ ÿßÿ≥ŸÑÿßÿ™‚ÄåŸáÿß€å ÿ∞ÿÆ€åÿ±Ÿá
            for (let i = 1; i <= 6; i++) {
                const saveData = localStorage.getItem(`clash3d_save_${i}`);
                const saveSlot = document.createElement('div');
                saveSlot.className = `save-slot ${saveData ? '' : 'empty'}`;
                
                if (saveData) {
                    const parsedData = JSON.parse(saveData);
                    const saveDate = new Date(parsedData.timestamp);
                    
                    saveSlot.innerHTML = `
                        <h4>ÿßÿ≥ŸÑÿßÿ™ ${i}</h4>
                        <div class="save-slot-info">
                            <p>ÿ®ÿßÿ≤€å⁄©ŸÜ: ${parsedData.gameState.playerName}</p>
                            <p>ÿ≥ÿ∑ÿ≠: ${parsedData.gameState.playerLevel}</p>
                            <p>ÿ∞ÿÆ€åÿ±Ÿá ÿ¥ÿØŸá ÿØÿ±: ${saveDate.toLocaleString('fa-IR')}</p>
                        </div>
                        <button class="action-button" onclick="loadGame(${i})">ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å</button>
                        <button class="action-button upgrade" onclick="saveGame(${i})">ÿ∞ÿÆ€åÿ±Ÿá ŸÖÿ¨ÿØÿØ</button>
                    `;
                } else {
                    saveSlot.innerHTML = `
                        <h4>ÿßÿ≥ŸÑÿßÿ™ ${i}</h4>
                        <p>ÿÆÿßŸÑ€å</p>
                        <button class="action-button upgrade" onclick="saveGame(${i})">ÿ∞ÿÆ€åÿ±Ÿá ÿ®ÿßÿ≤€å</button>
                    `;
                }
                
                saveSlotsContainer.appendChild(saveSlot);
            }
        }

        // ŸÜŸÖÿß€åÿ¥ UI ÿ™ŸÜÿ∏€åŸÖÿßÿ™
        function showSettingsUI() {
            document.getElementById('settingsUI').style.display = 'block';
            
            // ÿ™ŸÜÿ∏€åŸÖ ŸÖŸÇÿßÿØ€åÿ± ŸÅÿπŸÑ€å
            document.getElementById('musicVolume').value = gameState.settings.musicVolume;
            document.getElementById('soundVolume').value = gameState.settings.soundVolume;
            document.getElementById('graphicsQuality').value = gameState.settings.graphicsQuality;
            document.getElementById('language').value = gameState.settings.language;
        }

        // ŸÜŸÖÿß€åÿ¥ UI ÿ±ÿØŸá‚Äåÿ®ŸÜÿØ€å
        function showLeaderboardUI() {
            document.getElementById('leaderboardUI').style.display = 'block';
            
            const leaderboardContent = document.getElementById('leaderboardContent');
            leaderboardContent.innerHTML = `
                <h3>ÿ±ÿØŸá‚Äåÿ®ŸÜÿØ€å ÿ¨ŸáÿßŸÜ€å</h3>
                <p>ÿß€åŸÜ Ÿà€å⁄ò⁄Ø€å ÿØÿ± ŸÜÿ≥ÿÆŸá ÿ®ÿπÿØ€å ÿßÿ∂ÿßŸÅŸá ÿÆŸàÿßŸáÿØ ÿ¥ÿØ.</p>
            `;
        }

        // ==================== ŸÅÿß€åŸÑ ÿØŸàÿßÿ≤ÿØŸáŸÖ: ÿ™Ÿàÿßÿ®ÿπ ⁄©ŸÖ⁄©€å ====================
        
        // ÿØÿ±€åÿßŸÅÿ™ ÿ¢€å⁄©ŸàŸÜ ÿ≥ÿßÿ≤Ÿá
        function getBuildingIcon(type) {
            const icons = {
                townhall: 'landmark',
                barracks: 'helmet-battle',
                goldmine: 'mountain',
                elixircollector: 'vial',
                darkelixirdrill: 'skull',
                cannon: 'crosshairs',
                archertower: 'bow-arrow',
                mortar: 'bomb',
                wizardtower: 'hat-wizard',
                wall: 'wall'
            };
            
            return icons[type] || 'cube';
        }

        // ÿØÿ±€åÿßŸÅÿ™ ÿ¢€å⁄©ŸàŸÜ ÿ≥ÿ±ÿ®ÿßÿ≤
        function getTroopIcon(type) {
            const icons = {
                barbarian: 'user',
                archer: 'bullseye',
                giant: 'user-injured',
                goblin: 'user-ninja',
                wizard: 'user-astronaut',
                dragon: 'dragon',
                pekka: 'robot'
            };
            
            return icons[type] || 'user';
        }

        // ÿØÿ±€åÿßŸÅÿ™ ÿ¢€å⁄©ŸàŸÜ ÿ∑ŸÑÿ≥ŸÖ
        function getSpellIcon(type) {
            const icons = {
                lightning: 'bolt',
                healing: 'heart',
                rage: 'fire',
                freeze: 'snowflake',
                jump: 'running'
            };
            
            return icons[type] || 'magic';
        }

        // ÿØÿ±€åÿßŸÅÿ™ ÿ¢€å⁄©ŸàŸÜ ŸÖŸÜÿ®ÿπ
        function getResourceIcon(amount) {
            if (amount.gold > 0) return 'coins';
            if (amount.elixir > 0) return 'flask';
            if (amount.darkElixir > 0) return 'skull';
            return 'gem';
        }

        // ÿ¢ŸÖŸàÿ≤ÿ¥ ÿ≥ÿ±ÿ®ÿßÿ≤
        function trainTroop(type) {
            const data = troopData[type];
            
            // ÿ®ÿ±ÿ±ÿ≥€å ŸÖŸÜÿßÿ®ÿπ ⁄©ÿßŸÅ€å
            if (gameState.resources.elixir < data.cost.elixir || 
                gameState.resources.darkElixir < data.cost.darkElixir) {
                showNotification("ŸÖŸÜÿßÿ®ÿπ ⁄©ÿßŸÅ€å ÿ®ÿ±ÿß€å ÿ¢ŸÖŸàÿ≤ÿ¥ ÿß€åŸÜ ÿ≥ÿ±ÿ®ÿßÿ≤ ŸÜÿØÿßÿ±€åÿØ!");
                return;
            }
            
            // ⁄©ÿ≥ÿ± ŸÖŸÜÿßÿ®ÿπ
            gameState.resources.elixir -= data.cost.elixir;
            gameState.resources.darkElixir -= data.cost.darkElixir;
            
            // ÿß€åÿ¨ÿßÿØ ÿ≥ÿ±ÿ®ÿßÿ≤
            const troop = {
                type: type,
                name: data.name,
                health: data.health,
                damage: data.damage,
                speed: data.speed,
                range: data.range,
                trainingTime: data.trainingTime,
                trainingProgress: 0
            };
            
            gameState.troops.push(troop);
            
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å UI
            updateUI();
            
            showNotification(`${data.name} ÿØÿ± ÿ≠ÿßŸÑ ÿ¢ŸÖŸàÿ≤ÿ¥ ÿßÿ≥ÿ™!`);
        }

        // ÿ≥ÿßÿÆÿ™ ÿ∑ŸÑÿ≥ŸÖ
        function brewSpell(type) {
            const data = spellData[type];
            
            // ÿ®ÿ±ÿ±ÿ≥€å ŸÖŸÜÿßÿ®ÿπ ⁄©ÿßŸÅ€å
            if (gameState.resources.elixir < data.cost.elixir || 
                gameState.resources.darkElixir < data.cost.darkElixir) {
                showNotification("ŸÖŸÜÿßÿ®ÿπ ⁄©ÿßŸÅ€å ÿ®ÿ±ÿß€å ÿ≥ÿßÿÆÿ™ ÿß€åŸÜ ÿ∑ŸÑÿ≥ŸÖ ŸÜÿØÿßÿ±€åÿØ!");
                return;
            }
            
            // ⁄©ÿ≥ÿ± ŸÖŸÜÿßÿ®ÿπ
            gameState.resources.elixir -= data.cost.elixir;
            gameState.resources.darkElixir -= data.cost.darkElixir;
            
            // ÿß€åÿ¨ÿßÿØ ÿ∑ŸÑÿ≥ŸÖ
            const spell = {
                type: type,
                name: data.name,
                brewingTime: data.brewingTime,
                brewingProgress: 0
            };
            
            gameState.spells.push(spell);
            
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å UI
            updateUI();
            
            showNotification(`${data.name} ÿØÿ± ÿ≠ÿßŸÑ ÿ≥ÿßÿÆÿ™ ÿßÿ≥ÿ™!`);
        }

        // ÿÆÿ±€åÿØ ÿßÿ≤ ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá
        function purchaseShopItem(item) {
            // ÿ®ÿ±ÿ±ÿ≥€å ÿ¨ŸàÿßŸáÿ± ⁄©ÿßŸÅ€å
            if (gameState.resources.gems < item.cost.gems) {
                showNotification("ÿ¨ŸàÿßŸáÿ± ⁄©ÿßŸÅ€å ÿ®ÿ±ÿß€å ÿÆÿ±€åÿØ ÿß€åŸÜ ÿ¢€åÿ™ŸÖ ŸÜÿØÿßÿ±€åÿØ!");
                return;
            }
            
            // ⁄©ÿ≥ÿ± ÿ¨ŸàÿßŸáÿ±
            gameState.resources.gems -= item.cost.gems;
            
            // ÿßŸÅÿ≤ŸàÿØŸÜ ŸÖŸÜÿßÿ®ÿπ
            gameState.resources.gold += item.amount.gold;
            gameState.resources.elixir += item.amount.elixir;
            gameState.resources.darkElixir += item.amount.darkElixir;
            
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å UI
            updateUI();
            
            showNotification(`${item.name} ÿÆÿ±€åÿØÿßÿ±€å ÿ¥ÿØ!`);
        }

        // ÿßÿ∂ÿßŸÅŸá ⁄©ÿ±ÿØŸÜ Ÿæ€åÿßŸÖ ÿ®Ÿá ⁄Üÿ™
        function addChatMessage(sender, message) {
            const chatMessages = document.getElementById('chatMessages');
            const messageElement = document.createElement('div');
            messageElement.className = 'chat-message';
            messageElement.innerHTML = `<strong>${sender}:</strong> ${message}`;
            
            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // ÿ≠ÿ∞ŸÅ ÿ≥ÿßÿ≤Ÿá
        function removeStructure(structure) {
            scene.remove(structure.mesh);
            const index = gameState.structures.indexOf(structure);
            if (index > -1) {
                gameState.structures.splice(index, 1);
            }
            
            // ÿß⁄Øÿ± ÿ≥ÿßÿ≤Ÿá ÿßŸÜÿ™ÿÆÿßÿ® ÿ¥ÿØŸá ÿ®ŸàÿØÿå ŸæŸÜŸÑ ÿßŸÜÿ™ÿÆÿßÿ® ÿ±ÿß ŸæŸÜŸáÿßŸÜ ⁄©ŸÜ
            if (gameState.selectedStructure === structure) {
                hideStructurePanel();
            }
            
            showNotification(`${structure.name} ŸÜÿßÿ®ŸàÿØ ÿ¥ÿØ!`);
        }

        // ÿ≥ÿßÿÆÿ™ ÿ≥ÿßÿ≤Ÿá ÿ¨ÿØ€åÿØ
        function buildStructure(type) {
            const data = structureData[type];
            if (!data) return;
            
            // ÿ®ÿ±ÿ±ÿ≥€å ŸÖŸÜÿßÿ®ÿπ ⁄©ÿßŸÅ€å
            if (gameState.resources.gold < data.cost.gold || 
                gameState.resources.elixir < data.cost.elixir || 
                gameState.resources.darkElixir < data.cost.darkElixir) {
                showNotification("ŸÖŸÜÿßÿ®ÿπ ⁄©ÿßŸÅ€å ÿ®ÿ±ÿß€å ÿ≥ÿßÿÆÿ™ ÿß€åŸÜ ÿ≥ÿßÿ≤Ÿá ŸÜÿØÿßÿ±€åÿØ!");
                return;
            }
            
            // Ÿæ€åÿØÿß ⁄©ÿ±ÿØŸÜ ŸÖŸàŸÇÿπ€åÿ™ ÿÆÿßŸÑ€å ÿ®ÿ±ÿß€å ÿ≥ÿßÿÆÿ™
            let x, z;
            let attempts = 0;
            
            do {
                x = Math.floor(Math.random() * 60) - 30;
                z = Math.floor(Math.random() * 60) - 30;
                attempts++;
            } while (isPositionOccupied(x, z) && attempts < 100);
            
            if (attempts >= 100) {
                showNotification("ŸÅÿ∂ÿß€å ⁄©ÿßŸÅ€å ÿ®ÿ±ÿß€å ÿ≥ÿßÿÆÿ™ ÿ≥ÿßÿ≤Ÿá ÿ¨ÿØ€åÿØ Ÿàÿ¨ŸàÿØ ŸÜÿØÿßÿ±ÿØ!");
                return;
            }
            
            // ⁄©ÿ≥ÿ± ŸÖŸÜÿßÿ®ÿπ
            gameState.resources.gold -= data.cost.gold;
            gameState.resources.elixir -= data.cost.elixir;
            gameState.resources.darkElixir -= data.cost.darkElixir;
            
            // ÿß€åÿ¨ÿßÿØ ÿ≥ÿßÿ≤Ÿá
            createStructure(type, x, z);
            
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å UI
            updateUI();
            
            showNotification(`${data.name} ÿ≥ÿßÿÆÿ™Ÿá ÿ¥ÿØ!`);
        }

        // ÿ®ÿ±ÿ±ÿ≥€å ŸÖŸàŸÇÿπ€åÿ™ occupied
        function isPositionOccupied(x, z) {
            for (const structure of gameState.structures) {
                const dx = structure.x - x;
                const dz = structure.z - z;
                const distance = Math.sqrt(dx * dx + dz * dz);
                
                if (distance < 10) {
                    return true;
                }
            }
            return false;
        }

        // ==================== ÿ±ÿßŸá‚ÄåÿßŸÜÿØÿßÿ≤€å ÿßŸàŸÑ€åŸá ÿ®ÿßÿ≤€å ====================
        
        // ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿ®ÿßÿ≤€å
        document.addEventListener('DOMContentLoaded', function() {
            let progress = 0;
            const loadingBar = document.getElementById('loadingBar');
            const loadingText = document.getElementById('loadingText');
            const loadingScreen = document.getElementById('loadingScreen');
            const mainMenu = document.getElementById('mainMenu');
            
            // ŸÖŸÇÿØÿßÿ±ÿØŸá€å ÿßŸàŸÑ€åŸá ÿØÿ≥ÿ™ÿßŸàÿ±ÿØŸáÿß
            gameState.achievements = JSON.parse(JSON.stringify(achievementData));
            
            const loadingInterval = setInterval(() => {
                progress += Math.random() * 10;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(loadingInterval);
                    
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                        mainMenu.style.display = 'flex';
                    }, 500);
                }
                
                loadingBar.style.width = `${progress}%`;
                
                if (progress < 30) {
                    loadingText.textContent = "ÿØÿ± ÿ≠ÿßŸÑ ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ŸÖÿØŸÑ‚ÄåŸáÿß€å ÿ≥Ÿá ÿ®ÿπÿØ€å...";
                } else if (progress < 60) {
                    loadingText.textContent = "ÿØÿ± ÿ≠ÿßŸÑ ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿ®ÿßŸÅÿ™‚ÄåŸáÿß Ÿà ŸÖŸàÿßÿØ...";
                } else if (progress < 90) {
                    loadingText.textContent = "ÿØÿ± ÿ≠ÿßŸÑ ÿ±ÿßŸá‚ÄåÿßŸÜÿØÿßÿ≤€å ŸÖŸàÿ™Ÿàÿ± ÿ®ÿßÿ≤€å...";
                } else {
                    loadingText.textContent = "ÿ¢ŸÖÿßÿØŸá ÿ®ÿ±ÿß€å ÿ¥ÿ±Ÿàÿπ!";
                }
            }, 200);
            
            // ÿ±ÿßŸá‚ÄåÿßŸÜÿØÿßÿ≤€å ŸÖÿØ€åÿ±€åÿ™ ÿ±Ÿà€åÿØÿßÿØŸáÿß
            setupEventListeners();
        });
    </script>
</body>
  </html>
