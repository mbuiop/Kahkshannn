<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¬Ù†Ú¯ Ú©Ù‡Ú©Ø´Ø§Ù†ÛŒ - Galactic Combat</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸš€</text></svg>">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }
        
        body {
            background: radial-gradient(circle at center, #0a0a2a 0%, #000000 100%);
            overflow: hidden;
            touch-action: none;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            width: 100vw;
            height: 100vh;
            position: fixed;
            color: white;
        }

        /* ØµÙØ­Ù‡ Ø¨Ø§Ø²ÛŒ */
        #gameScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 100;
            overflow: hidden;
        }

        #gameCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        /* HUD Ø¨Ø§Ø²ÛŒ */
        .game-hud {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 200;
            font-family: 'Arial', sans-serif;
        }

        .hud-top {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 30px;
        }

        .health-container {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 10px 20px;
            backdrop-filter: blur(10px);
        }

        .health-bar {
            width: 300px;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 5px;
        }

        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff3300, #ffaa00, #00ff88);
            width: 100%;
            transition: width 0.3s;
            border-radius: 10px;
        }

        .health-text {
            color: white;
            font-size: 1.1rem;
            text-shadow: 0 0 5px #00ff88;
        }

        .score-display {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(0, 204, 255, 0.5);
            border-radius: 10px;
            padding: 15px 25px;
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .score-value {
            font-size: 2rem;
            color: #00ccff;
            text-shadow: 0 0 10px #00ccff;
            font-weight: bold;
        }

        .score-label {
            font-size: 1rem;
            color: #aaccff;
        }

        .coins-display {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(255, 215, 0, 0.5);
            border-radius: 10px;
            padding: 15px 25px;
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .coins-value {
            font-size: 2rem;
            color: gold;
            text-shadow: 0 0 10px gold;
            font-weight: bold;
        }

        .coins-label {
            font-size: 1rem;
            color: #ffd700;
        }

        .hud-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .crosshair {
            width: 40px;
            height: 40px;
            border: 2px solid rgba(0, 255, 255, 0.8);
            border-radius: 50%;
            position: relative;
        }

        .crosshair::before, .crosshair::after {
            content: '';
            position: absolute;
            background: rgba(0, 255, 255, 0.8);
        }

        .crosshair::before {
            width: 2px;
            height: 20px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .crosshair::after {
            width: 20px;
            height: 2px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .hud-bottom {
            position: absolute;
            bottom: 30px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 30px;
            align-items: flex-end;
        }

        .weapon-info {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 15px 25px;
            backdrop-filter: blur(10px);
        }

        .weapon-name {
            font-size: 1.3rem;
            color: #ffaa00;
            margin-bottom: 5px;
        }

        .ammo-count {
            font-size: 1.1rem;
            color: #00ff88;
        }

        .mission-info {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(255, 0, 128, 0.5);
            border-radius: 10px;
            padding: 15px 25px;
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .mission-text {
            font-size: 1.1rem;
            color: #ff0080;
            margin-bottom: 5px;
        }

        .objective-text {
            font-size: 1rem;
            color: #aaccff;
        }

        /* Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ© ØªÙ…Ø§Ù… ØµÙØ­Ù‡ */
        .fullscreen-joystick {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 150;
            cursor: none;
        }

        .joystick-indicator {
            position: absolute;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, rgba(0, 204, 255, 0.3) 0%, transparent 70%);
            border: 2px solid rgba(0, 204, 255, 0.5);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            display: none;
        }

        .joystick-center {
            position: absolute;
            width: 20px;
            height: 20px;
            background: rgba(0, 204, 255, 0.8);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            display: none;
        }

        /* ØµÙØ­Ù‡ Ø´Ø±ÙˆØ¹ */
        #startScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, #001122 0%, #000000 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .start-title {
            font-size: 4rem;
            font-weight: 900;
            background: linear-gradient(45deg, #ff0080, #8000ff, #0080ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 50px rgba(255, 0, 128, 0.7);
            margin-bottom: 20px;
            text-align: center;
        }

        .start-subtitle {
            font-size: 1.5rem;
            color: #aaccff;
            margin-bottom: 50px;
            text-align: center;
        }

        .start-button {
            background: linear-gradient(45deg, #ff0080, #ff6600);
            border: none;
            padding: 20px 40px;
            font-size: 1.5rem;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(255, 0, 128, 0.5);
            transition: all 0.3s;
        }

        .start-button:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(255, 0, 128, 0.7);
        }

        /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ */
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* Ø±Ø³Ù¾Ø§Ù†Ø³ÛŒÙˆ */
        @media (max-width: 768px) {
            .start-title {
                font-size: 2.5rem;
            }
            
            .health-bar {
                width: 200px;
            }
            
            .hud-top, .hud-bottom {
                padding: 0 15px;
            }
        }
    </style>
</head>
<body>
    <!-- ØµÙØ­Ù‡ Ø´Ø±ÙˆØ¹ -->
    <div id="startScreen">
        <h1 class="start-title">GALACTIC COMBAT</h1>
        <p class="start-subtitle">Ú©Ù†ØªØ±Ù„ Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ©ÛŒ - Ù†Ø¨Ø±Ø¯ Ø³ÛŒÙ†Ù…Ø§ÛŒÛŒ Ø¯Ø± ÙØ¶Ø§</p>
        <button class="start-button" onclick="startGame()">Ø´Ø±ÙˆØ¹ Ù†Ø¨Ø±Ø¯</button>
    </div>

    <!-- ØµÙØ­Ù‡ Ø¨Ø§Ø²ÛŒ -->
    <div id="gameScreen" style="display: none;">
        <canvas id="gameCanvas"></canvas>
        
        <!-- HUD Ø¨Ø§Ø²ÛŒ -->
        <div class="game-hud">
            <div class="hud-top">
                <div class="health-container">
                    <div class="health-bar">
                        <div class="health-fill" id="healthFill"></div>
                    </div>
                    <div class="health-text" id="healthText">Ø³Ø§Ø®ØªØ§Ø±: 100%</div>
                </div>
                
                <div class="score-display">
                    <div class="score-value" id="scoreValue">0</div>
                    <div class="score-label">Ø§Ù…ØªÛŒØ§Ø² Ù†Ø¨Ø±Ø¯</div>
                </div>

                <div class="coins-display">
                    <div class="coins-value" id="coinsValue">0</div>
                    <div class="coins-label">Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø´Ø¯Ù‡</div>
                </div>
            </div>
            
            <div class="hud-center">
                <div class="crosshair"></div>
                <div class="target-info" id="targetInfo"></div>
            </div>
            
            <div class="hud-bottom">
                <div class="weapon-info">
                    <div class="weapon-name">Ø³Ù„Ø§Ø­ Ù¾Ù„Ø§Ø³Ù…Ø§ÛŒÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±</div>
                    <div class="ammo-count" id="ammoCount">Ø­Ø§Ù„Øª: ÙØ¹Ø§Ù„</div>
                </div>
                
                <div class="mission-info">
                    <div class="mission-text">Ù…Ø§Ù…ÙˆØ±ÛŒØª: Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø³Ú©Ù‡ Ùˆ Ù†Ø§Ø¨ÙˆØ¯ÛŒ Ø¯Ø´Ù…Ù†Ø§Ù†</div>
                    <div class="objective-text" id="objectiveText">Ø¯Ø´Ù…Ù†Ø§Ù† Ù†Ø§Ø¨ÙˆØ¯ Ø´Ø¯Ù‡: 0</div>
                </div>
            </div>
        </div>
        
        <!-- Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ© ØªÙ…Ø§Ù… ØµÙØ­Ù‡ -->
        <div class="fullscreen-joystick" id="joystickArea">
            <div class="joystick-indicator" id="joystickIndicator"></div>
            <div class="joystick-center" id="joystickCenter"></div>
        </div>
    </div>

    <script>
        // ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒ
        const gameState = {
            score: 0,
            coins: 0,
            health: 100,
            enemiesDestroyed: 0,
            gameRunning: false,
            playerX: 0,
            playerY: 0,
            playerSpeed: 5,
            autoShoot: true,
            shootInterval: null
        };

        // Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ DOM
        const startScreen = document.getElementById('startScreen');
        const gameScreen = document.getElementById('gameScreen');
        const gameCanvas = document.getElementById('gameCanvas');
        const healthFill = document.getElementById('healthFill');
        const healthText = document.getElementById('healthText');
        const scoreValue = document.getElementById('scoreValue');
        const coinsValue = document.getElementById('coinsValue');
        const ammoCount = document.getElementById('ammoCount');
        const objectiveText = document.getElementById('objectiveText');
        const joystickArea = document.getElementById('joystickArea');
        const joystickIndicator = document.getElementById('joystickIndicator');
        const joystickCenter = document.getElementById('joystickCenter');

        // ØªÙ†Ø¸ÛŒÙ… Canvas
        const ctx = gameCanvas.getContext('2d');
        gameCanvas.width = window.innerWidth;
        gameCanvas.height = window.innerHeight;

        // Ø§Ø´ÛŒØ§Ø¡ Ø¨Ø§Ø²ÛŒ
        let player = {
            x: gameCanvas.width / 2,
            y: gameCanvas.height / 2,
            width: 60,
            height: 40,
            speed: 8,
            color: '#00aaff'
        };

        let enemies = [];
        let bullets = [];
        let coins = [];
        let particles = [];
        let stars = [];

        // Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§
        let controls = {
            moveX: 0,
            moveY: 0,
            joystickActive: false,
            joystickStartX: 0,
            joystickStartY: 0
        };

        // Ø§ÛŒØ¬Ø§Ø¯ Ø³ØªØ§Ø±Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡
        function createStars() {
            stars = [];
            for (let i = 0; i < 200; i++) {
                stars.push({
                    x: Math.random() * gameCanvas.width,
                    y: Math.random() * gameCanvas.height,
                    size: Math.random() * 2 + 1,
                    speed: Math.random() * 0.5 + 0.1,
                    brightness: Math.random() * 0.5 + 0.5
                });
            }
        }

        // Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø´Ù…Ù†
        function createEnemy() {
            const side = Math.floor(Math.random() * 4);
            let x, y;
            
            switch(side) {
                case 0: // Ø¨Ø§Ù„Ø§
                    x = Math.random() * gameCanvas.width;
                    y = -50;
                    break;
                case 1: // Ø±Ø§Ø³Øª
                    x = gameCanvas.width + 50;
                    y = Math.random() * gameCanvas.height;
                    break;
                case 2: // Ù¾Ø§ÛŒÛŒÙ†
                    x = Math.random() * gameCanvas.width;
                    y = gameCanvas.height + 50;
                    break;
                case 3: // Ú†Ù¾
                    x = -50;
                    y = Math.random() * gameCanvas.height;
                    break;
            }
            
            enemies.push({
                x: x,
                y: y,
                width: 50,
                height: 50,
                speed: Math.random() * 2 + 1,
                health: 3,
                type: 'volcano',
                lastShot: Date.now(),
                shootDelay: 1000 + Math.random() * 1000
            });
        }

        // Ø§ÛŒØ¬Ø§Ø¯ Ø³Ú©Ù‡
        function createCoin() {
            coins.push({
                x: Math.random() * (gameCanvas.width - 100) + 50,
                y: Math.random() * (gameCanvas.height - 100) + 50,
                size: 40,
                value: Math.floor(Math.random() * 5) + 1,
                type: Math.floor(Math.random() * 3),
                rotation: 0,
                collected: false
            });
        }

        // Ø§ÛŒØ¬Ø§Ø¯ Ú¯Ù„ÙˆÙ„Ù‡
        function createBullet(x, y, targetX, targetY, isPlayer = true) {
            const dx = targetX - x;
            const dy = targetY - y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            bullets.push({
                x: x,
                y: y,
                vx: (dx / distance) * (isPlayer ? 10 : 5),
                vy: (dy / distance) * (isPlayer ? 10 : 5),
                width: isPlayer ? 8 : 6,
                height: isPlayer ? 8 : 6,
                color: isPlayer ? '#00ffff' : '#ff3300',
                isPlayer: isPlayer,
                damage: isPlayer ? 1 : 0.5
            });
        }

        // Ø§ÛŒØ¬Ø§Ø¯ Ø°Ø±Ø§Øª
        function createParticles(x, y, count, color) {
            for (let i = 0; i < count; i++) {
                particles.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 10,
                    vy: (Math.random() - 0.5) * 10,
                    life: 1,
                    maxLife: 1,
                    size: Math.random() * 3 + 1,
                    color: color
                });
            }
        }

        // Ø´Ù„ÛŒÚ© Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø§Ø²ÛŒÚ©Ù†
        function autoShoot() {
            if (!gameState.autoShoot) return;
            
            // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ±ÛŒÙ† Ø¯Ø´Ù…Ù†
            let closestEnemy = null;
            let closestDistance = Infinity;
            
            enemies.forEach(enemy => {
                const dx = enemy.x - player.x;
                const dy = enemy.y - player.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < closestDistance && distance < 400) {
                    closestDistance = distance;
                    closestEnemy = enemy;
                }
            });
            
            if (closestEnemy) {
                createBullet(player.x, player.y, closestEnemy.x, closestEnemy.y, true);
                
                // Ø§ÙÚ©Øª Ø´Ù„ÛŒÚ©
                createParticles(player.x, player.y, 3, '#00aaff');
            }
        }

        // Ø´Ù„ÛŒÚ© Ø¯Ø´Ù…Ù†Ø§Ù†
        function enemyShoot() {
            const now = Date.now();
            
            enemies.forEach(enemy => {
                if (now - enemy.lastShot > enemy.shootDelay) {
                    createBullet(enemy.x, enemy.y, player.x, player.y, false);
                    enemy.lastShot = now;
                    
                    // Ø§ÙÚ©Øª Ø´Ù„ÛŒÚ© Ø¯Ø´Ù…Ù†
                    createParticles(enemy.x, enemy.y, 3, '#ff3300');
                }
            });
        }

        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ HUD
        function updateHUD() {
            healthFill.style.width = `${gameState.health}%`;
            healthText.textContent = `Ø³Ø§Ø®ØªØ§Ø±: ${Math.round(gameState.health)}%`;
            scoreValue.textContent = gameState.score.toLocaleString();
            coinsValue.textContent = gameState.coins.toLocaleString();
            objectiveText.textContent = `Ø¯Ø´Ù…Ù†Ø§Ù† Ù†Ø§Ø¨ÙˆØ¯ Ø´Ø¯Ù‡: ${gameState.enemiesDestroyed}`;
            
            // ØªØºÛŒÛŒØ± Ø±Ù†Ú¯ Ø³Ù„Ø§Ù…Øª
            if (gameState.health > 70) {
                healthFill.style.background = 'linear-gradient(90deg, #00ff88, #00ccff)';
            } else if (gameState.health > 30) {
                healthFill.style.background = 'linear-gradient(90deg, #ffaa00, #ff6600)';
            } else {
                healthFill.style.background = 'linear-gradient(90deg, #ff3300, #cc0000)';
            }
        }

        // ØªØ´Ø®ÛŒØµ Ø¨Ø±Ø®ÙˆØ±Ø¯
        function checkCollisions() {
            // Ø¨Ø±Ø®ÙˆØ±Ø¯ Ú¯Ù„ÙˆÙ„Ù‡ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ø§ Ø¯Ø´Ù…Ù†
            for (let i = bullets.length - 1; i >= 0; i--) {
                const bullet = bullets[i];
                
                if (!bullet.isPlayer) continue;
                
                for (let j = enemies.length - 1; j >= 0; j--) {
                    const enemy = enemies[j];
                    
                    if (Math.abs(bullet.x - enemy.x) < (bullet.width + enemy.width) / 2 &&
                        Math.abs(bullet.y - enemy.y) < (bullet.height + enemy.height) / 2) {
                        
                        // Ø¢Ø³ÛŒØ¨ Ø¨Ù‡ Ø¯Ø´Ù…Ù†
                        enemy.health -= bullet.damage;
                        
                        // Ø§ÛŒØ¬Ø§Ø¯ Ø§Ù†ÙØ¬Ø§Ø±
                        createParticles(enemy.x, enemy.y, 10, '#ff6600');
                        
                        // Ø­Ø°Ù Ú¯Ù„ÙˆÙ„Ù‡
                        bullets.splice(i, 1);
                        
                        if (enemy.health <= 0) {
                            // Ù†Ø§Ø¨ÙˆØ¯ÛŒ Ø¯Ø´Ù…Ù†
                            createParticles(enemy.x, enemy.y, 20, '#ff3300');
                            enemies.splice(j, 1);
                            gameState.score += 100;
                            gameState.enemiesDestroyed++;
                            
                            // Ø´Ø§Ù†Ø³ Ø§ÛŒØ¬Ø§Ø¯ Ø³Ú©Ù‡
                            if (Math.random() < 0.3) {
                                createCoin();
                            }
                        }
                        
                        break;
                    }
                }
            }
            
            // Ø¨Ø±Ø®ÙˆØ±Ø¯ Ú¯Ù„ÙˆÙ„Ù‡ Ø¯Ø´Ù…Ù† Ø¨Ø§ Ø¨Ø§Ø²ÛŒÚ©Ù†
            for (let i = bullets.length - 1; i >= 0; i--) {
                const bullet = bullets[i];
                
                if (bullet.isPlayer) continue;
                
                if (Math.abs(bullet.x - player.x) < (bullet.width + player.width) / 2 &&
                    Math.abs(bullet.y - player.y) < (bullet.height + player.height) / 2) {
                    
                    // Ø¢Ø³ÛŒØ¨ Ø¨Ù‡ Ø¨Ø§Ø²ÛŒÚ©Ù†
                    gameState.health -= 10;
                    createParticles(player.x, player.y, 15, '#ff0000');
                    bullets.splice(i, 1);
                    
                    // Ù„Ø±Ø²Ø´
                    gameScreen.style.animation = 'shake 0.3s';
                    setTimeout(() => {
                        gameScreen.style.animation = '';
                    }, 300);
                    
                    if (gameState.health <= 0) {
                        gameOver();
                    }
                    
                    updateHUD();
                }
            }
            
            // Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ø§ Ø³Ú©Ù‡
            for (let i = coins.length - 1; i >= 0; i--) {
                const coin = coins[i];
                
                if (coin.collected) continue;
                
                if (Math.abs(player.x - coin.x) < (player.width + coin.size) / 2 &&
                    Math.abs(player.y - coin.y) < (player.height + coin.size) / 2) {
                    
                    // Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø³Ú©Ù‡
                    coin.collected = true;
                    gameState.coins += coin.value;
                    gameState.score += coin.value * 10;
                    
                    // Ø§ÙÚ©Øª Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ
                    createParticles(coin.x, coin.y, 15, '#ffd700');
                    
                    coins.splice(i, 1);
                    updateHUD();
                }
            }
            
            // Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¯Ø´Ù…Ù† Ø¨Ø§ Ø¨Ø§Ø²ÛŒÚ©Ù†
            for (let i = enemies.length - 1; i >= 0; i--) {
                const enemy = enemies[i];
                
                if (Math.abs(player.x - enemy.x) < (player.width + enemy.width) / 2 &&
                    Math.abs(player.y - enemy.y) < (player.height + enemy.height) / 2) {
                    
                    // Ø¢Ø³ÛŒØ¨ Ø´Ø¯ÛŒØ¯
                    gameState.health -= 20;
                    createParticles(player.x, player.y, 20, '#ff0000');
                    enemies.splice(i, 1);
                    
                    if (gameState.health <= 0) {
                        gameOver();
                    }
                    
                    updateHUD();
                }
            }
        }

        // Ø±Ù†Ø¯Ø± Ø¨Ø§Ø²ÛŒ
        function render() {
            // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Canvas
            ctx.fillStyle = 'rgba(10, 10, 40, 0.1)';
            ctx.fillRect(0, 0, gameCanvas.width, gameCanvas.height);
            
            // Ø±Ø³Ù… Ø³ØªØ§Ø±Ù‡â€ŒÙ‡Ø§
            ctx.fillStyle = '#ffffff';
            stars.forEach(star => {
                ctx.globalAlpha = star.brightness;
                ctx.fillRect(star.x, star.y, star.size, star.size);
            });
            ctx.globalAlpha = 1;
            
            // Ø±Ø³Ù… Ø³Ú©Ù‡â€ŒÙ‡Ø§
            coins.forEach(coin => {
                if (coin.collected) return;
                
                ctx.save();
                ctx.translate(coin.x, coin.y);
                ctx.rotate(coin.rotation);
                
                // Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ú©Ù„ Ø³Ú©Ù‡ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†ÙˆØ¹
                let emoji, color;
                switch(coin.type) {
                    case 0:
                        emoji = 'ğŸª';
                        color = '#ff6b6b';
                        break;
                    case 1:
                        emoji = 'ğŸŒ€';
                        color = '#4ecdc4';
                        break;
                    case 2:
                        emoji = 'ğŸŒ';
                        color = '#45b7d1';
                        break;
                }
                
                // Ø¯Ø§ÛŒØ±Ù‡ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡
                ctx.fillStyle = color + '40';
                ctx.beginPath();
                ctx.arc(0, 0, coin.size / 2, 0, Math.PI * 2);
                ctx.fill();
                
                // Ø­Ø§Ø´ÛŒÙ‡
                ctx.strokeStyle = color;
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // Ø§ÛŒÙ…ÙˆØ¬ÛŒ
                ctx.font = `${coin.size * 0.6}px Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(emoji, 0, 0);
                
                // Ø¹Ø¯Ø¯ Ø§Ø±Ø²Ø´
                ctx.font = 'bold 14px Arial';
                ctx.fillStyle = '#ffffff';
                ctx.fillText(coin.value.toString(), 0, coin.size / 2 + 10);
                
                ctx.restore();
                
                // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ú†Ø±Ø®Ø´
                coin.rotation += 0.02;
            });
            
            // Ø±Ø³Ù… Ø¯Ø´Ù…Ù†Ø§Ù†
            enemies.forEach(enemy => {
                ctx.save();
                ctx.translate(enemy.x, enemy.y);
                
                // Ø§ÛŒÙ…ÙˆØ¬ÛŒ Ø¢ØªØ´ÙØ´Ø§Ù†
                ctx.font = '40px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('ğŸŒ‹', 0, 0);
                
                // Ù†ÙˆØ§Ø± Ø³Ù„Ø§Ù…Øª
                const healthWidth = 40;
                const healthPercent = enemy.health / 3;
                
                ctx.fillStyle = '#333333';
                ctx.fillRect(-healthWidth / 2, -35, healthWidth, 5);
                
                ctx.fillStyle = healthPercent > 0.5 ? '#00ff88' : healthPercent > 0.2 ? '#ffaa00' : '#ff3300';
                ctx.fillRect(-healthWidth / 2, -35, healthWidth * healthPercent, 5);
                
                ctx.restore();
            });
            
            // Ø±Ø³Ù… Ú¯Ù„ÙˆÙ„Ù‡â€ŒÙ‡Ø§
            bullets.forEach(bullet => {
                ctx.fillStyle = bullet.color;
                ctx.beginPath();
                ctx.arc(bullet.x, bullet.y, bullet.width / 2, 0, Math.PI * 2);
                ctx.fill();
                
                // Ø¯Ù†Ø¨Ø§Ù„Ù‡
                ctx.strokeStyle = bullet.color + '80';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(bullet.x - bullet.vx * 0.5, bullet.y - bullet.vy * 0.5);
                ctx.lineTo(bullet.x, bullet.y);
                ctx.stroke();
            });
            
            // Ø±Ø³Ù… Ø°Ø±Ø§Øª
            particles.forEach(particle => {
                const alpha = particle.life / particle.maxLife;
                ctx.fillStyle = particle.color + Math.floor(alpha * 255).toString(16).padStart(2, '0');
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size * alpha, 0, Math.PI * 2);
                ctx.fill();
            });
            
            // Ø±Ø³Ù… Ø¨Ø§Ø²ÛŒÚ©Ù†
            ctx.save();
            ctx.translate(player.x, player.y);
            
            // Ø¨Ø¯Ù†Ù‡ Ø³ÙÛŒÙ†Ù‡
            ctx.fillStyle = player.color;
            ctx.beginPath();
            ctx.moveTo(-player.width / 2, -player.height / 2);
            ctx.lineTo(player.width / 2, 0);
            ctx.lineTo(-player.width / 2, player.height / 2);
            ctx.closePath();
            ctx.fill();
            
            // Ø¬Ø²Ø¦ÛŒØ§Øª
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // Ù…ÙˆØªÙˆØ±Ù‡Ø§
            ctx.fillStyle = '#ff6600';
            ctx.beginPath();
            ctx.arc(-player.width / 3, 0, 5, 0, Math.PI * 2);
            ctx.arc(-player.width / 3, -10, 4, 0, Math.PI * 2);
            ctx.arc(-player.width / 3, 10, 4, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.restore();
        }

        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¨Ø§Ø²ÛŒ
        function update() {
            if (!gameState.gameRunning) return;
            
            // Ø­Ø±Ú©Øª Ø³ØªØ§Ø±Ù‡â€ŒÙ‡Ø§ (Ø§ÛŒØ¬Ø§Ø¯ Ø¹Ù…Ù‚)
            stars.forEach(star => {
                star.x -= star.speed;
                if (star.x < -10) {
                    star.x = gameCanvas.width + 10;
                    star.y = Math.random() * gameCanvas.height;
                }
            });
            
            // Ø­Ø±Ú©Øª Ø¨Ø§Ø²ÛŒÚ©Ù†
            player.x += controls.moveX * player.speed;
            player.y += controls.moveY * player.speed;
            
            // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ù‡ ØµÙØ­Ù‡
            player.x = Math.max(player.width / 2, Math.min(gameCanvas.width - player.width / 2, player.x));
            player.y = Math.max(player.height / 2, Math.min(gameCanvas.height - player.height / 2, player.y));
            
            // Ø­Ø±Ú©Øª Ú¯Ù„ÙˆÙ„Ù‡â€ŒÙ‡Ø§
            bullets.forEach(bullet => {
                bullet.x += bullet.vx;
                bullet.y += bullet.vy;
            });
            
            // Ø­Ø°Ù Ú¯Ù„ÙˆÙ„Ù‡â€ŒÙ‡Ø§ÛŒ Ø®Ø§Ø±Ø¬ Ø§Ø² ØµÙØ­Ù‡
            bullets = bullets.filter(bullet => 
                bullet.x > -50 && bullet.x < gameCanvas.width + 50 && 
                bullet.y > -50 && bullet.y < gameCanvas.height + 50
            );
            
            // Ø­Ø±Ú©Øª Ø¯Ø´Ù…Ù†Ø§Ù† Ø¨Ù‡ Ø³Ù…Øª Ø¨Ø§Ø²ÛŒÚ©Ù†
            enemies.forEach(enemy => {
                const dx = player.x - enemy.x;
                const dy = player.y - enemy.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance > 0) {
                    enemy.x += (dx / distance) * enemy.speed;
                    enemy.y += (dy / distance) * enemy.speed;
                }
            });
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø°Ø±Ø§Øª
            for (let i = particles.length - 1; i >= 0; i--) {
                const particle = particles[i];
                particle.x += particle.vx;
                particle.y += particle.vy;
                particle.life -= 0.02;
                
                if (particle.life <= 0) {
                    particles.splice(i, 1);
                }
            }
            
            // ØªØ´Ø®ÛŒØµ Ø¨Ø±Ø®ÙˆØ±Ø¯
            checkCollisions();
            
            // Ø±Ù†Ø¯Ø±
            render();
            
            requestAnimationFrame(update);
        }

        // Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ
        function startGame() {
            startScreen.style.display = 'none';
            gameScreen.style.display = 'block';
            
            // ØªÙ†Ø¸ÛŒÙ… Ù…Ø¬Ø¯Ø¯ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒ
            gameState.score = 0;
            gameState.coins = 0;
            gameState.health = 100;
            gameState.enemiesDestroyed = 0;
            gameState.gameRunning = true;
            
            // Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ Ø¢Ø±Ø§ÛŒÙ‡â€ŒÙ‡Ø§
            enemies = [];
            bullets = [];
            coins = [];
            particles = [];
            
            // ØªÙ†Ø¸ÛŒÙ… Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒÚ©Ù†
            player.x = gameCanvas.width / 2;
            player.y = gameCanvas.height / 2;
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ù…Ø­ÛŒØ·
            createStars();
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
            for (let i = 0; i < 5; i++) {
                createCoin();
            }
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ HUD
            updateHUD();
            
            // Ø´Ø±ÙˆØ¹ Ø´Ù„ÛŒÚ© Ø®ÙˆØ¯Ú©Ø§Ø±
            gameState.shootInterval = setInterval(autoShoot, 300);
            
            // Ø´Ø±ÙˆØ¹ Ø§Ø³Ù¾Ø§Ù† Ø¯Ø´Ù…Ù†Ø§Ù†
            setInterval(createEnemy, 2000);
            setInterval(enemyShoot, 100);
            
            // Ø´Ø±ÙˆØ¹ Ø­Ù„Ù‚Ù‡ Ø¨Ø§Ø²ÛŒ
            update();
        }

        // Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ
        function gameOver() {
            gameState.gameRunning = false;
            clearInterval(gameState.shootInterval);
            
            // Ù†Ù…Ø§ÛŒØ´ ØµÙØ­Ù‡ Ù¾Ø§ÛŒØ§Ù†
            setTimeout(() => {
                alert(`Ø¨Ø§Ø²ÛŒ Ù¾Ø§ÛŒØ§Ù† ÛŒØ§ÙØª!\nØ§Ù…ØªÛŒØ§Ø²: ${gameState.score}\nØ³Ú©Ù‡â€ŒÙ‡Ø§: ${gameState.coins}\nØ¯Ø´Ù…Ù†Ø§Ù† Ù†Ø§Ø¨ÙˆØ¯ Ø´Ø¯Ù‡: ${gameState.enemiesDestroyed}`);
                startScreen.style.display = 'flex';
                gameScreen.style.display = 'none';
            }, 1000);
        }

        // Ú©Ù†ØªØ±Ù„ Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ©
        joystickArea.addEventListener('touchstart', (e) => {
            e.preventDefault();
            controls.joystickActive = true;
            
            const touch = e.touches[0];
            controls.joystickStartX = touch.clientX;
            controls.joystickStartY = touch.clientY;
            
            // Ù†Ù…Ø§ÛŒØ´ Ù†Ø´Ø§Ù†Ú¯Ø± Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ©
            joystickIndicator.style.display = 'block';
            joystickCenter.style.display = 'block';
            joystickIndicator.style.left = controls.joystickStartX + 'px';
            joystickIndicator.style.top = controls.joystickStartY + 'px';
            joystickCenter.style.left = controls.joystickStartX + 'px';
            joystickCenter.style.top = controls.joystickStartY + 'px';
        });

        joystickArea.addEventListener('touchmove', (e) => {
            if (!controls.joystickActive) return;
            e.preventDefault();
            
            const touch = e.touches[0];
            const deltaX = touch.clientX - controls.joystickStartX;
            const deltaY = touch.clientY - controls.joystickStartY;
            
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            const maxDistance = 100;
            const limitedDistance = Math.min(distance, maxDistance);
            
            if (distance > 10) {
                const angle = Math.atan2(deltaY, deltaX);
                const moveX = limitedDistance * Math.cos(angle) / maxDistance;
                const moveY = limitedDistance * Math.sin(angle) / maxDistance;
                
                controls.moveX = moveX;
                controls.moveY = moveY;
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ø±Ú©Ø² Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ©
                joystickCenter.style.left = (controls.joystickStartX + deltaX * 0.3) + 'px';
                joystickCenter.style.top = (controls.joystickStartY + deltaY * 0.3) + 'px';
            }
        });

        joystickArea.addEventListener('touchend', (e) => {
            controls.joystickActive = false;
            controls.moveX = 0;
            controls.moveY = 0;
            
            // Ù¾Ù†Ù‡Ø§Ù† Ú©Ø±Ø¯Ù† Ù†Ø´Ø§Ù†Ú¯Ø± Ø¬ÙˆÛŒâ€ŒØ§Ø³ØªÛŒÚ©
            joystickIndicator.style.display = 'none';
            joystickCenter.style.display = 'none';
        });

        // Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ú©ÛŒØ¨ÙˆØ±Ø¯ Ø¨Ø±Ø§ÛŒ ØªØ³Øª
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowLeft':
                case 'a':
                    controls.moveX = -1;
                    break;
                case 'ArrowRight':
                case 'd':
                    controls.moveX = 1;
                    break;
                case 'ArrowUp':
                case 'w':
                    controls.moveY = -1;
                    break;
                case 'ArrowDown':
                case 's':
                    controls.moveY = 1;
                    break;
            }
        });

        document.addEventListener('keyup', (e) => {
            switch(e.key) {
                case 'ArrowLeft':
                case 'a':
                    controls.moveX = 0;
                    break;
                case 'ArrowRight':
                case 'd':
                    controls.moveX = 0;
                    break;
                case 'ArrowUp':
                case 'w':
                    controls.moveY = 0;
                    break;
                case 'ArrowDown':
                case 's':
                    controls.moveY = 0;
                    break;
            }
        });

        // ØªÙ†Ø¸ÛŒÙ… Ø§Ù†Ø¯Ø§Ø²Ù‡ Canvas
        window.addEventListener('resize', () => {
            gameCanvas.width = window.innerWidth;
            gameCanvas.height = window.innerHeight;
            
            if (gameState.gameRunning) {
                player.x = Math.max(player.width / 2, Math.min(gameCanvas.width - player.width / 2, player.x));
                player.y = Math.max(player.height / 2, Math.min(gameCanvas.height - player.height / 2, player.y));
            }
        });
    </script>
</body>
  </html>
