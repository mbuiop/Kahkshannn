<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø§Ø²ÛŒ Ù‚Ø§Ø±Ú† Ø¬Ù…Ø¹â€ŒÚ©Ù† | Mushroom Collector</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Vazirmatn', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #8B4513;
            --secondary: #228B22;
            --accent: #FF6B6B;
            --background: #1A535C;
            --text: #F7FFF7;
            --mushroom-red: #FF5252;
            --mushroom-white: #F8F9FA;
            --mushroom-brown: #8D6E63;
            --forest-dark: #2E7D32;
            --forest-light: #4CAF50;
        }

        body {
            background: linear-gradient(135deg, var(--forest-dark), var(--forest-light));
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .game-container {
            width: 100%;
            max-width: 800px;
            background: rgba(42, 157, 143, 0.1);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(26, 83, 92, 0.7);
            border-radius: 15px;
            border: 2px solid var(--primary);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--mushroom-white);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--mushroom-white);
            opacity: 0.9;
        }

        .game-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background: rgba(139, 69, 19, 0.8);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--mushroom-white);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--mushroom-white);
            opacity: 0.8;
        }

        .game-area {
            position: relative;
            width: 100%;
            height: 500px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%232E7D32"/><path d="M0 50 Q 25 30, 50 50 T 100 50" stroke="%234CAF50" stroke-width="5" fill="none"/></svg>');
            border-radius: 15px;
            overflow: hidden;
            border: 3px solid var(--primary);
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
            margin-bottom: 20px;
        }

        .player {
            position: absolute;
            width: 60px;
            height: 80px;
            background: linear-gradient(to bottom, #4A90E2, #357ABD);
            border-radius: 50% 50% 40% 40%;
            z-index: 10;
            transition: transform 0.2s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .player::before {
            content: '';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 30px;
            background: #4A90E2;
            border-radius: 50%;
        }

        .player::after {
            content: '';
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 5px white;
        }

        .mushroom {
            position: absolute;
            width: 40px;
            height: 50px;
            z-index: 5;
            cursor: pointer;
            transition: transform 0.3s, opacity 0.3s;
        }

        .mushroom-top {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 25px;
            background: var(--mushroom-red);
            border-radius: 50% 50% 40% 40%;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
        }

        .mushroom-top::before {
            content: '';
            position: absolute;
            top: 5px;
            left: 10px;
            width: 8px;
            height: 8px;
            background: var(--mushroom-white);
            border-radius: 50%;
            box-shadow: 15px 0 0 var(--mushroom-white), 30px 0 0 var(--mushroom-white);
        }

        .mushroom-stem {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 30px;
            background: var(--mushroom-white);
            border-radius: 5px;
        }

        .mushroom.poison {
            filter: hue-rotate(120deg);
        }

        .mushroom.special .mushroom-top {
            background: gold;
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 5px gold; }
            to { box-shadow: 0 0 20px gold, 0 0 30px orange; }
        }

        .obstacle {
            position: absolute;
            background: var(--mushroom-brown);
            border-radius: 5px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
        }

        .rock {
            background: #795548;
            border-radius: 10px;
        }

        .tree {
            background: #5D4037;
            width: 30px;
            height: 100px;
            border-radius: 5px 5px 0 0;
        }

        .tree::before {
            content: '';
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 50px;
            background: #2E7D32;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .control-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(to bottom, var(--primary), #6D4C41);
            color: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }

        .control-btn:active {
            transform: translateY(1px);
        }

        .instructions {
            background: rgba(26, 83, 92, 0.7);
            padding: 15px;
            border-radius: 15px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .instructions h3 {
            margin-bottom: 10px;
            color: var(--mushroom-white);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .instructions ul {
            list-style-type: none;
            padding-right: 20px;
        }

        .instructions li {
            margin-bottom: 8px;
            position: relative;
        }

        .instructions li::before {
            content: 'ğŸ„';
            position: absolute;
            right: -20px;
        }

        .power-ups {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }

        .power-up {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            width: 80px;
        }

        .power-up-icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .power-up.active {
            background: rgba(255, 215, 0, 0.3);
            border: 1px solid gold;
        }

        .game-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 30px 50px;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.7);
            border: 2px solid gold;
            z-index: 100;
            text-align: center;
            display: none;
            backdrop-filter: blur(5px);
        }

        .game-message h2 {
            color: gold;
            margin-bottom: 15px;
            font-size: 2rem;
        }

        .game-message p {
            font-size: 1.2rem;
            margin-bottom: 20px;
        }

        /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ */
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .bounce {
            animation: bounce 0.5s ease infinite;
        }

        .shake {
            animation: shake 0.5s ease infinite;
        }

        .collect-animation {
            animation: collect 0.5s forwards;
        }

        @keyframes collect {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0) translateY(-20px); opacity: 0; }
        }

        /* Ø±Ø³Ù¾Ø§Ù†Ø³ÛŒÙˆ */
        @media (max-width: 768px) {
            .game-area {
                height: 400px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
            
            .control-btn {
                padding: 10px 20px;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .game-area {
                height: 300px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .controls {
                flex-wrap: wrap;
            }
            
            .power-ups {
                flex-wrap: wrap;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <header>
            <h1>Ø¨Ø§Ø²ÛŒ Ù‚Ø§Ø±Ú† Ø¬Ù…Ø¹â€ŒÚ©Ù†</h1>
            <p class="subtitle">ØªØ§ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ù‚Ø§Ø±Ú† Ø¬Ù…Ø¹ Ú©Ù†ØŒ Ø§Ø² Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§ÛŒ Ø³Ù…ÛŒ Ø¯ÙˆØ±ÛŒ Ú©Ù†!</p>
        </header>
        
        <div class="game-stats">
            <div class="stat">
                <div class="stat-value" id="score">0</div>
                <div class="stat-label">Ø§Ù…ØªÛŒØ§Ø²</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="mushrooms">0</div>
                <div class="stat-label">Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="time">60</div>
                <div class="stat-label">Ø²Ù…Ø§Ù†</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="lives">3</div>
                <div class="stat-label">Ø¬Ø§Ù†</div>
            </div>
        </div>
        
        <div class="game-area" id="gameArea">
            <!-- Ø¨Ø§Ø²ÛŒÚ©Ù† Ùˆ Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§ Ùˆ Ù…ÙˆØ§Ù†Ø¹ ØªÙˆØ³Ø· Ø¬Ø§ÙˆØ§Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
        </div>
        
        <div class="controls">
            <button class="control-btn" id="startBtn">
                <i class="fas fa-play"></i>
                Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ
            </button>
            <button class="control-btn" id="resetBtn">
                <i class="fas fa-redo"></i>
                Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø¯Ø¯
            </button>
            <button class="control-btn" id="helpBtn">
                <i class="fas fa-question-circle"></i>
                Ø±Ø§Ù‡Ù†Ù…Ø§
            </button>
        </div>
        
        <div class="power-ups">
            <div class="power-up" id="speedPower">
                <div class="power-up-icon">âš¡</div>
                <div>Ø³Ø±ÛŒØ¹â€ŒØªØ±</div>
            </div>
            <div class="power-up" id="magnetPower">
                <div class="power-up-icon">ğŸ§²</div>
                <div>Ø¢Ù‡Ù†Ø±Ø¨Ø§</div>
            </div>
            <div class="power-up" id="shieldPower">
                <div class="power-up-icon">ğŸ›¡ï¸</div>
                <div>Ù…Ø­Ø§ÙØ¸</div>
            </div>
            <div class="power-up" id="doublePower">
                <div class="power-up-icon">âœŒï¸</div>
                <div>Ø¯Ùˆ Ø¨Ø±Ø§Ø¨Ø±</div>
            </div>
        </div>
        
        <div class="instructions">
            <h3><i class="fas fa-info-circle"></i> Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¨Ø§Ø²ÛŒ</h3>
            <ul>
                <li>Ø¨Ø§ Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ Ø¬Ù‡Øªâ€ŒØ¯Ø§Ø± Ø­Ø±Ú©Øª Ú©Ù†ÛŒØ¯ ÛŒØ§ Ø±ÙˆÛŒ ØµÙØ­Ù‡ Ø¶Ø±Ø¨Ù‡ Ø¨Ø²Ù†ÛŒØ¯</li>
                <li>Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§ÛŒ Ù‚Ø±Ù…Ø² Ø±Ø§ Ø¬Ù…Ø¹ Ú©Ù†ÛŒØ¯ ØªØ§ Ø§Ù…ØªÛŒØ§Ø² Ø¨Ú¯ÛŒØ±ÛŒØ¯</li>
                <li>Ø§Ø² Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§ÛŒ Ø³Ù…ÛŒ (Ø³Ø¨Ø²) Ø¯ÙˆØ±ÛŒ Ú©Ù†ÛŒØ¯</li>
                <li>Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§ÛŒ Ø·Ù„Ø§ÛŒÛŒ ÙˆÛŒÚ˜Ù‡ Ø§Ù…ØªÛŒØ§Ø² Ø¨ÛŒØ´ØªØ±ÛŒ Ù…ÛŒâ€ŒØ¯Ù‡Ù†Ø¯</li>
                <li>Ù‚Ø¨Ù„ Ø§Ø² Ø§ØªÙ…Ø§Ù… Ø²Ù…Ø§Ù†ØŒ ØªØ§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù‚Ø§Ø±Ú† Ø¬Ù…Ø¹ Ú©Ù†ÛŒØ¯</li>
            </ul>
        </div>
    </div>
    
    <div class="game-message" id="gameMessage">
        <h2 id="messageTitle">ØªØ¨Ø±ÛŒÚ©!</h2>
        <p id="messageText">Ø´Ù…Ø§ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯ÛŒØ¯!</p>
        <button class="control-btn" id="messageBtn">
            <i class="fas fa-play"></i>
            Ø¨Ø§Ø²ÛŒ Ù…Ø¬Ø¯Ø¯
        </button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Ø¹Ù†Ø§ØµØ± DOM
            const gameArea = document.getElementById('gameArea');
            const scoreElement = document.getElementById('score');
            const mushroomsElement = document.getElementById('mushrooms');
            const timeElement = document.getElementById('time');
            const livesElement = document.getElementById('lives');
            const startBtn = document.getElementById('startBtn');
            const resetBtn = document.getElementById('resetBtn');
            const helpBtn = document.getElementById('helpBtn');
            const gameMessage = document.getElementById('gameMessage');
            const messageTitle = document.getElementById('messageTitle');
            const messageText = document.getElementById('messageText');
            const messageBtn = document.getElementById('messageBtn');
            
            // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒ
            let gameActive = false;
            let score = 0;
            let mushroomsCollected = 0;
            let timeLeft = 60;
            let lives = 3;
            let player;
            let mushrooms = [];
            let obstacles = [];
            let gameInterval;
            let countdownInterval;
            let keys = {};
            let playerSpeed = 5;
            let activePowerUps = {};
            
            // Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒ
            const gameWidth = gameArea.offsetWidth;
            const gameHeight = gameArea.offsetHeight;
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ø§Ø²ÛŒÚ©Ù†
            function createPlayer() {
                player = document.createElement('div');
                player.className = 'player';
                player.id = 'player';
                player.style.left = (gameWidth / 2 - 30) + 'px';
                player.style.top = (gameHeight / 2 - 40) + 'px';
                gameArea.appendChild(player);
            }
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ù‚Ø§Ø±Ú†
            function createMushroom(isPoison = false, isSpecial = false) {
                const mushroom = document.createElement('div');
                mushroom.className = 'mushroom';
                if (isPoison) mushroom.classList.add('poison');
                if (isSpecial) mushroom.classList.add('special');
                
                // Ù…ÙˆÙ‚Ø¹ÛŒØª ØªØµØ§Ø¯ÙÛŒ
                const x = Math.random() * (gameWidth - 40);
                const y = Math.random() * (gameHeight - 50);
                
                mushroom.style.left = x + 'px';
                mushroom.style.top = y + 'px';
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ù‚Ø³Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø±Ú†
                const top = document.createElement('div');
                top.className = 'mushroom-top';
                
                const stem = document.createElement('div');
                stem.className = 'mushroom-stem';
                
                mushroom.appendChild(top);
                mushroom.appendChild(stem);
                
                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø¨Ø§Ø²ÛŒ
                gameArea.appendChild(mushroom);
                mushrooms.push(mushroom);
                
                // Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù‚Ø§Ø±Ú†
                mushroom.addEventListener('click', function() {
                    if (!gameActive) return;
                    
                    collectMushroom(mushroom, isPoison, isSpecial);
                });
            }
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ù…ÙˆØ§Ù†Ø¹
            function createObstacle(type) {
                const obstacle = document.createElement('div');
                obstacle.className = `obstacle ${type}`;
                
                // Ù…ÙˆÙ‚Ø¹ÛŒØª ØªØµØ§Ø¯ÙÛŒ
                const x = Math.random() * (gameWidth - 50);
                const y = Math.random() * (gameHeight - 50);
                
                obstacle.style.left = x + 'px';
                obstacle.style.top = y + 'px';
                
                // ØªÙ†Ø¸ÛŒÙ… Ø§Ù†Ø¯Ø§Ø²Ù‡ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†ÙˆØ¹ Ù…Ø§Ù†Ø¹
                if (type === 'rock') {
                    obstacle.style.width = '40px';
                    obstacle.style.height = '30px';
                } else if (type === 'tree') {
                    obstacle.style.width = '30px';
                    obstacle.style.height = '100px';
                }
                
                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø¨Ø§Ø²ÛŒ
                gameArea.appendChild(obstacle);
                obstacles.push(obstacle);
            }
            
            // Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ù‚Ø§Ø±Ú†
            function collectMushroom(mushroom, isPoison, isSpecial) {
                // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ
                mushroom.classList.add('collect-animation');
                
                // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ù…ØªÛŒØ§Ø²
                if (isPoison) {
                    // Ù‚Ø§Ø±Ú† Ø³Ù…ÛŒ
                    lives--;
                    livesElement.textContent = lives;
                    player.classList.add('shake');
                    setTimeout(() => player.classList.remove('shake'), 500);
                    
                    if (lives <= 0) {
                        endGame(false);
                    }
                } else {
                    // Ù‚Ø§Ø±Ú† Ù…Ø¹Ù…ÙˆÙ„ÛŒ
                    mushroomsCollected++;
                    mushroomsElement.textContent = mushroomsCollected;
                    
                    if (isSpecial) {
                        score += 50;
                        // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù‚Ø¯Ø±Øª ØªØµØ§Ø¯ÙÛŒ
                        activateRandomPowerUp();
                    } else {
                        score += 10;
                    }
                    
                    scoreElement.textContent = score;
                }
                
                // Ø­Ø°Ù Ù‚Ø§Ø±Ú† Ø§Ø² Ø¢Ø±Ø§ÛŒÙ‡ Ùˆ DOM
                setTimeout(() => {
                    const index = mushrooms.indexOf(mushroom);
                    if (index > -1) {
                        mushrooms.splice(index, 1);
                    }
                    gameArea.removeChild(mushroom);
                }, 500);
            }
            
            // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù‚Ø¯Ø±Øª ØªØµØ§Ø¯ÙÛŒ
            function activateRandomPowerUp() {
                const powerUps = ['speed', 'magnet', 'shield', 'double'];
                const randomPower = powerUps[Math.floor(Math.random() * powerUps.length)];
                
                activePowerUps[randomPower] = true;
                
                // Ù†Ù…Ø§ÛŒØ´ ÙØ¹Ø§Ù„ Ø´Ø¯Ù† Ù‚Ø¯Ø±Øª
                const powerElement = document.getElementById(`${randomPower}Power`);
                powerElement.classList.add('active');
                
                // Ø§Ø«Ø± Ù‚Ø¯Ø±Øª
                switch(randomPower) {
                    case 'speed':
                        playerSpeed = 8;
                        break;
                    case 'magnet':
                        // Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§ Ø¨Ù‡ Ø³Ù…Øª Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¬Ø°Ø¨ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
                        break;
                    case 'shield':
                        // Ù…Ø­Ø§ÙØ¸ Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± Ù‚Ø§Ø±Ú† Ø³Ù…ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø¯Øª Ù…Ø­Ø¯ÙˆØ¯
                        break;
                    case 'double':
                        // Ø§Ù…ØªÛŒØ§Ø² Ø¯Ùˆ Ø¨Ø±Ø§Ø¨Ø± Ø¨Ø±Ø§ÛŒ Ù…Ø¯Øª Ù…Ø­Ø¯ÙˆØ¯
                        break;
                }
                
                // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù‚Ø¯Ø±Øª Ø¨Ø¹Ø¯ Ø§Ø² 10 Ø«Ø§Ù†ÛŒÙ‡
                setTimeout(() => {
                    activePowerUps[randomPower] = false;
                    powerElement.classList.remove('active');
                    
                    if (randomPower === 'speed') {
                        playerSpeed = 5;
                    }
                }, 10000);
            }
            
            // Ø­Ø±Ú©Øª Ø¨Ø§Ø²ÛŒÚ©Ù†
            function movePlayer() {
                if (!player || !gameActive) return;
                
                let newX = parseInt(player.style.left);
                let newY = parseInt(player.style.top);
                
                if (keys['ArrowRight'] || keys['d'] || keys['D']) {
                    newX += playerSpeed;
                }
                if (keys['ArrowLeft'] || keys['a'] || keys['A']) {
                    newX -= playerSpeed;
                }
                if (keys['ArrowDown'] || keys['s'] || keys['S']) {
                    newY += playerSpeed;
                }
                if (keys['ArrowUp'] || keys['w'] || keys['W']) {
                    newY -= playerSpeed;
                }
                
                // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø­Ø±Ú©Øª Ø¨Ù‡ Ø¯Ø§Ø®Ù„ Ø¨Ø§Ø²ÛŒ
                newX = Math.max(0, Math.min(gameWidth - 60, newX));
                newY = Math.max(0, Math.min(gameHeight - 80, newY));
                
                player.style.left = newX + 'px';
                player.style.top = newY + 'px';
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¨Ø§ Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§ (Ø¨Ø±Ø§ÛŒ Ù†Ø³Ø®Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„)
                checkMushroomCollisions();
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¨Ø§ Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§
            function checkMushroomCollisions() {
                const playerRect = player.getBoundingClientRect();
                
                mushrooms.forEach(mushroom => {
                    const mushroomRect = mushroom.getBoundingClientRect();
                    
                    if (isColliding(playerRect, mushroomRect)) {
                        const isPoison = mushroom.classList.contains('poison');
                        const isSpecial = mushroom.classList.contains('special');
                        collectMushroom(mushroom, isPoison, isSpecial);
                    }
                });
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ ØªØµØ§Ø¯Ù…
            function isColliding(rect1, rect2) {
                return !(
                    rect1.right < rect2.left ||
                    rect1.left > rect2.right ||
                    rect1.bottom < rect2.top ||
                    rect1.top > rect2.bottom
                );
            }
            
            // Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ
            function startGame() {
                if (gameActive) return;
                
                gameActive = true;
                score = 0;
                mushroomsCollected = 0;
                timeLeft = 60;
                lives = 3;
                
                scoreElement.textContent = score;
                mushroomsElement.textContent = mushroomsCollected;
                timeElement.textContent = timeLeft;
                livesElement.textContent = lives;
                
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø¨Ø§Ø²ÛŒ Ù‚Ø¨Ù„ÛŒ
                gameArea.innerHTML = '';
                mushrooms = [];
                obstacles = [];
                activePowerUps = {};
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ø²ÛŒ
                createPlayer();
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§
                for (let i = 0; i < 15; i++) {
                    createMushroom();
                }
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§ÛŒ Ø³Ù…ÛŒ
                for (let i = 0; i < 5; i++) {
                    createMushroom(true);
                }
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡
                for (let i = 0; i < 2; i++) {
                    createMushroom(false, true);
                }
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ù…ÙˆØ§Ù†Ø¹
                for (let i = 0; i < 8; i++) {
                    createObstacle('rock');
                }
                
                for (let i = 0; i < 3; i++) {
                    createObstacle('tree');
                }
                
                // Ø´Ø±ÙˆØ¹ ØªØ§ÛŒÙ…Ø±
                countdownInterval = setInterval(function() {
                    timeLeft--;
                    timeElement.textContent = timeLeft;
                    
                    if (timeLeft <= 0) {
                        endGame(true);
                    }
                    
                    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù‚Ø§Ø±Ú† Ø¬Ø¯ÛŒØ¯ Ù‡Ø± 5 Ø«Ø§Ù†ÛŒÙ‡
                    if (timeLeft % 5 === 0) {
                        createMushroom(Math.random() < 0.3); // 30% Ø§Ø­ØªÙ…Ø§Ù„ Ø³Ù…ÛŒ Ø¨ÙˆØ¯Ù†
                    }
                }, 1000);
                
                // Ø­Ù„Ù‚Ù‡ Ø¨Ø§Ø²ÛŒ
                gameInterval = setInterval(movePlayer, 30);
            }
            
            // Ù¾Ø§ÛŒØ§Ù† Ø¨Ø§Ø²ÛŒ
            function endGame(isTimeUp) {
                gameActive = false;
                clearInterval(gameInterval);
                clearInterval(countdownInterval);
                
                if (isTimeUp) {
                    messageTitle.textContent = 'Ø²Ù…Ø§Ù† ØªÙ…Ø§Ù… Ø´Ø¯!';
                    messageText.textContent = `Ø´Ù…Ø§ ${score} Ø§Ù…ØªÛŒØ§Ø² Ú©Ø³Ø¨ Ú©Ø±Ø¯ÛŒØ¯ Ùˆ ${mushroomsCollected} Ù‚Ø§Ø±Ú† Ø¬Ù…Ø¹ Ø¢ÙˆØ±ÛŒ Ú©Ø±Ø¯ÛŒØ¯.`;
                } else {
                    messageTitle.textContent = 'Ø¨Ø§Ø²ÛŒ ØªÙ…Ø§Ù… Ø´Ø¯!';
                    messageText.textContent = 'Ø¬Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§ ØªÙ…Ø§Ù… Ø´Ø¯!';
                }
                
                gameMessage.style.display = 'block';
            }
            
            // Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¨Ø§Ø²ÛŒ
            function showHelp() {
                messageTitle.textContent = 'Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¨Ø§Ø²ÛŒ';
                messageText.innerHTML = `
                    <ul style="text-align: right; list-style-type: none; padding-right: 20px;">
                        <li>â†’ Ø¨Ø§ Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ Ø¬Ù‡Øªâ€ŒØ¯Ø§Ø± Ø­Ø±Ú©Øª Ú©Ù†ÛŒØ¯</li>
                        <li>â†’ Ø±ÙˆÛŒ Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ÛŒØ§ Ø¨Ø§ Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ø±Ø®ÙˆØ±Ø¯ Ú©Ù†ÛŒØ¯</li>
                        <li>â†’ Ù‚Ø§Ø±Ú† Ù‚Ø±Ù…Ø²: 10 Ø§Ù…ØªÛŒØ§Ø²</li>
                        <li>â†’ Ù‚Ø§Ø±Ú† Ø³Ù…ÛŒ (Ø³Ø¨Ø²): Ø§Ø² Ø¯Ø³Øª Ø¯Ø§Ø¯Ù† ÛŒÚ© Ø¬Ø§Ù†</li>
                        <li>â†’ Ù‚Ø§Ø±Ú† Ø·Ù„Ø§ÛŒÛŒ: 50 Ø§Ù…ØªÛŒØ§Ø² + Ù‚Ø¯Ø±Øª ÙˆÛŒÚ˜Ù‡</li>
                        <li>â†’ Ù‚Ø¨Ù„ Ø§Ø² Ø§ØªÙ…Ø§Ù… Ø²Ù…Ø§Ù†ØŒ ØªØ§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù‚Ø§Ø±Ú† Ø¬Ù…Ø¹ Ú©Ù†ÛŒØ¯</li>
                    </ul>
                `;
                messageBtn.innerHTML = '<i class="fas fa-check"></i> ÙÙ‡Ù…ÛŒØ¯Ù…';
                gameMessage.style.display = 'block';
            }
            
            // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ ØµÙØ­Ù‡ Ú©Ù„ÛŒØ¯
            document.addEventListener('keydown', function(e) {
                keys[e.key] = true;
            });
            
            document.addEventListener('keyup', function(e) {
                keys[e.key] = false;
            });
            
            // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù„Ù…Ø³ÛŒ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„
            gameArea.addEventListener('touchstart', function(e) {
                e.preventDefault();
                const touch = e.touches[0];
                const touchX = touch.clientX - gameArea.getBoundingClientRect().left;
                const touchY = touch.clientY - gameArea.getBoundingClientRect().top;
                
                // Ø­Ø±Ú©Øª Ø¨Ø§Ø²ÛŒÚ©Ù† Ø¨Ù‡ Ù…Ø­Ù„ Ù„Ù…Ø³
                if (player && gameActive) {
                    player.style.left = (touchX - 30) + 'px';
                    player.style.top = (touchY - 40) + 'px';
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¨Ø§ Ù‚Ø§Ø±Ú†â€ŒÙ‡Ø§
                    checkMushroomCollisions();
                }
            });
            
            // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„
            startBtn.addEventListener('click', startGame);
            resetBtn.addEventListener('click', startGame);
            helpBtn.addEventListener('click', showHelp);
            messageBtn.addEventListener('click', function() {
                gameMessage.style.display = 'none';
                if (messageTitle.textContent === 'Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¨Ø§Ø²ÛŒ') {
                    return;
                }
                startGame();
            });
            
            // Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
            setTimeout(showHelp, 1000);
        });
    </script>
</body>
  </html>
