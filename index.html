<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¨Ø§Ø²ÛŒ Ú©Ù‡Ú©Ø´Ø§Ù†ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸŒŒ</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background: #000;
            overflow: hidden;
            touch-action: none;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            width: 100vw;
            height: 100vh;
            position: fixed;
        }
        
        /* Ú©Ù‡Ú©Ø´Ø§Ù† Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ */
        #galaxyBackground {
            position: fixed;
            top: 0;
            left: 0;
            width: 500000px; /* 500 Ú©ÛŒÙ„ÙˆÙ…ØªØ± */
            height: 100vh;
            background: 
                radial-gradient(circle at 20% 30%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255, 119, 198, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(120, 219, 255, 0.25) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a2a 0%, #1a1a4a 50%, #0a0a2a 100%);
            z-index: 1;
            animation: galaxyMove 120s linear infinite;
        }
        
        @keyframes galaxyMove {
            0% { transform: translateX(0); }
            100% { transform: translateX(-250000px); }
        }
        
        /* Ø³ØªØ§Ø±Ù‡â€ŒÙ‡Ø§ */
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle var(--duration) ease-in-out infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        /* Ø³ÛŒØ§Ø±Ø§Øª Ùˆ Ú©Ù‡Ú©Ø´Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ú©ÙˆÚ†Ú© */
        .celestial-body {
            position: absolute;
            border-radius: 50%;
            filter: blur(0.5px);
            animation: float var(--duration) ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
        }
        
        /* Ø³Ø­Ø§Ø¨ÛŒâ€ŒÙ‡Ø§ */
        .nebula {
            position: absolute;
            border-radius: 50%;
            filter: blur(20px);
            opacity: 0.1;
            animation: nebulaPulse var(--duration) ease-in-out infinite;
        }
        
        @keyframes nebulaPulse {
            0%, 100% { transform: scale(1); opacity: 0.1; }
            50% { transform: scale(1.2); opacity: 0.15; }
        }

        #mainScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 2;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }
        
        .header {
            text-align: center;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #ff8a00, #e52e71, #00aaff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(229, 46, 113, 0.5);
            animation: titleGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes titleGlow {
            from { filter: drop-shadow(0 0 5px rgba(255, 138, 0, 0.7)); }
            to { filter: drop-shadow(0 0 15px rgba(229, 46, 113, 0.7)); }
        }
        
        .main-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
            align-items: center;
            width: 90%;
            max-width: 400px;
        }
        
        .main-btn {
            background: linear-gradient(45deg, #00ccff, #0066ff);
            border: none;
            padding: 18px 25px;
            font-size: 1.1rem;
            border-radius: 15px;
            cursor: pointer;
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 204, 255, 0.5);
            transition: all 0.3s;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            min-height: 80px;
            justify-content: center;
        }
        
        .main-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 204, 255, 0.7);
        }
        
        .main-btn.start {
            background: linear-gradient(45deg, #00ff88, #00ccff);
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.5);
            font-size: 1.3rem;
            grid-column: 1 / -1;
        }

        .btn-icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .btn-text {
            font-size: 0.9rem;
        }

        .management-btn {
            background: linear-gradient(45deg, #ff4444, #cc0000);
            border: none;
            padding: 15px 25px;
            font-size: 1.1rem;
            border-radius: 15px;
            cursor: pointer;
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(255, 68, 68, 0.5);
            transition: all 0.3s;
            grid-column: 1 / -1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            animation: redPulse 2s infinite;
        }
        
        .management-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(255, 68, 68, 0.7);
        }
        
        @keyframes redPulse {
            0%, 100% { box-shadow: 0 4px 15px rgba(255, 68, 68, 0.5); }
            50% { box-shadow: 0 4px 25px rgba(255, 68, 68, 0.8), 0 0 30px rgba(255, 68, 68, 0.4); }
        }
        
        .stats-panel {
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 20px;
            margin: 15px 0;
            text-align: center;
            width: 90%;
            max-width: 300px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        
        .stat-item {
            background: rgba(0, 0, 0, 0.6);
            padding: 12px 15px;
            border-radius: 15px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #00ccff;
            margin-top: 5px;
        }
        
        .hidden {
            display: none !important;
        }
        
        #gameScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 3;
        }
        
        .player {
            position: absolute;
            font-size: 80px;
            z-index: 4;
            filter: drop-shadow(0 0 10px #00aaff) drop-shadow(0 0 20px #00aaff);
            transition: transform 0.1s;
        }
        
        .player.pulse {
            animation: pulse 0.5s infinite alternate;
        }
        
        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }
        
        .enemy {
            position: absolute;
            font-size: 50px;
            z-index: 3;
            filter: drop-shadow(0 0 8px #ff3300) drop-shadow(0 0 12px #ff3300);
            transition: transform 0.3s;
        }
        
        .coin {
            position: absolute;
            font-size: 45px;
            z-index: 2;
            filter: drop-shadow(0 0 10px #00ff88) drop-shadow(0 0 20px #00ff88);
            animation: float 3s infinite ease-in-out;
        }
        
        .coin-number {
            position: absolute;
            font-size: 16px;
            font-weight: bold;
            color: white;
            z-index: 3;
            text-shadow: 2px 2px 4px black;
            pointer-events: none;
            background: rgba(0,0,0,0.7);
            padding: 4px 8px;
            border-radius: 10px;
            min-width: 25px;
            text-align: center;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(10deg); }
        }
        
        .bomb-button {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 70px;
            height: 70px;
            background: radial-gradient(circle, #ff4444, #cc0000);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 35px;
            cursor: pointer;
            z-index: 5;
            box-shadow: 0 4px 12px rgba(255, 0, 0, 0.5);
            transition: all 0.3s;
        }
        
        .bomb-button:active {
            transform: scale(0.9);
        }
        
        .bomb-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .bomb-timer {
            position: fixed;
            bottom: 100px;
            left: 25px;
            color: white;
            font-size: 14px;
            z-index: 5;
            background: rgba(0, 0, 0, 0.7);
            padding: 6px 10px;
            border-radius: 10px;
        }
        
        .fuel-indicator {
            position: fixed;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            color: #00ff88;
            font-size: 16px;
            background: rgba(0, 0, 0, 0.7);
            padding: 8px 15px;
            border-radius: 10px;
            z-index: 5;
            animation: fuelPulse 2s infinite;
        }
        
        @keyframes fuelPulse {
            0%, 100% { box-shadow: 0 0 5px #00ff88; }
            50% { box-shadow: 0 0 15px #00ff88; }
        }

        .touch-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 120px;
            height: 120px;
            z-index: 5;
            display: none;
        }
        
        .joystick {
            position: absolute;
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(10px);
        }
        
        .joystick-handle {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #00ccff, #0066ff);
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(0, 204, 255, 0.5);
        }

        /* HUD Ø¨Ø§Ø²ÛŒ */
        .game-hud {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 20px;
            z-index: 4;
            display: flex;
            justify-content: space-between;
            pointer-events: none;
        }
        
        .hud-item {
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 15px;
            border-radius: 10px;
            color: white;
            font-size: 14px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .hud-value {
            color: #00ccff;
            font-weight: bold;
            font-size: 16px;
        }

        /* Ø±Ø³Ù¾Ø§Ù†Ø³ÛŒÙˆ */
        @media (max-width: 768px) {
            .main-buttons {
                grid-template-columns: 1fr;
                max-width: 300px;
            }
            
            .main-btn {
                min-height: 70px;
                padding: 15px 20px;
            }
            
            h1 {
                font-size: 2.5rem;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 2rem;
            }
            
            .main-btn {
                padding: 12px 15px;
                font-size: 1rem;
            }
            
            .btn-icon {
                font-size: 1.3rem;
            }
            
            .btn-text {
                font-size: 0.8rem;
            }
            
            .touch-controls {
                display: flex;
            }
        }
    </style>
</head>
<body>
    <!-- Ú©Ù‡Ú©Ø´Ø§Ù† Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ -->
    <div id="galaxyBackground"></div>
    
    <!-- ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ -->
    <div id="mainScreen">
        <div class="header">
            <h1>ğŸŒŒ Ø¨Ø§Ø²ÛŒ Ú©Ù‡Ú©Ø´Ø§Ù†ÛŒ</h1>
        </div>
        
        <div class="main-buttons">
            <button class="main-btn start" onclick="startGame()">
                <span class="btn-icon">ğŸ®</span>
                <span class="btn-text">Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</span>
            </button>
            <button class="main-btn" onclick="showAchievements()">
                <span class="btn-icon">ğŸ†</span>
                <span class="btn-text">Ù…Ø¯Ø§Ù„â€ŒÙ‡Ø§</span>
            </button>
            <button class="main-btn" onclick="showInstructions()">
                <span class="btn-icon">ğŸ“–</span>
                <span class="btn-text">Ø±Ø§Ù‡Ù†Ù…Ø§</span>
            </button>
            <button class="main-btn" onclick="showSettings()">
                <span class="btn-icon">âš™ï¸</span>
                <span class="btn-text">ØªÙ†Ø¸ÛŒÙ…Ø§Øª</span>
            </button>
            <button class="management-btn" onclick="showManagement()">
                <span class="btn-icon">ğŸ””</span>
                <span class="btn-text">Ø§Ø·Ù„Ø§Ø¹ÛŒÙ‡ Ù…Ø¯ÛŒØ±ÛŒØª</span>
            </button>
        </div>
        
        <div class="stats-panel">
            <div class="stats">
                <div class="stat-item">
                    <div>Ø¨Ø§Ù„Ø§ØªØ±ÛŒÙ† Ø§Ù…ØªÛŒØ§Ø²</div>
                    <div class="stat-value" id="highScore">0</div>
                </div>
                <div class="stat-item">
                    <div>Ø¨Ø§Ù„Ø§ØªØ±ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡</div>
                    <div class="stat-value" id="highLevel">1</div>
                </div>
                <div class="stat-item">
                    <div>Ù…Ø¯Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ú©Ø³Ø¨ Ø´Ø¯Ù‡</div>
                    <div class="stat-value" id="achievementsCount">0/100</div>
                </div>
                <div class="stat-item">
                    <div>Ú©Ù„ Ù…Ø¯Ø§Ù„â€ŒÙ‡Ø§</div>
                    <div class="stat-value" id="totalCoinsCollected">0</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ØµÙØ­Ù‡ Ø¨Ø§Ø²ÛŒ -->
    <div id="gameScreen" class="hidden">
        <div class="game-hud">
            <div class="hud-item">Ø§Ù…ØªÛŒØ§Ø²: <span class="hud-value" id="currentScore">0</span></div>
            <div class="hud-item">Ù…Ø±Ø­Ù„Ù‡: <span class="hud-value" id="currentLevel">1</span></div>
            <div class="hud-item">Ø³Ú©Ù‡: <span class="hud-value" id="currentCoins">0</span></div>
        </div>
    </div>
    
    <!-- Ù†Ø´Ø§Ù†Ú¯Ø± Ø³ÙˆØ®Øª -->
    <div class="fuel-indicator hidden">â›½ Ø³ÙˆØ®Øª: 100%</div>
    
    <!-- Ø¯Ú©Ù…Ù‡ Ø¨Ù…Ø¨ -->
    <button id="bombButton" class="bomb-button hidden" onclick="useBomb()">ğŸ’£</button>
    <div id="bombTimer" class="bomb-timer hidden">Ø¨Ù…Ø¨: 10s</div>
    
    <!-- Ú©Ù†ØªØ±Ù„ Ù„Ù…Ø³ÛŒ -->
    <div class="touch-controls hidden">
        <div class="joystick">
            <div class="joystick-handle"></div>
        </div>
    </div>

    <script src="camera-system.js"></script>
    <script src="galaxy-generator.js"></script>
    <script>
        // Ø³ÛŒØ³ØªÙ… Ø§ØµÙ„ÛŒ Ø¨Ø§Ø²ÛŒ
        let gameState = 'MENU';
        let score = 0;
        let level = 1;
        let coins = 0;
        let fuel = 100;
        let player = {};
        let enemies = [];
        let coins3D = [];
        let gameRunning = false;
        let bombCooldown = 0;
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§ÛŒ Ø®Ø§Ø±Ø¬ÛŒ
        let cameraSystem = new CameraSystem();
        let galaxyGenerator = new GalaxyGenerator();
        
        function initGame() {
            // Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù‡Ú©Ø´Ø§Ù†
            galaxyGenerator.createGalaxy();
            
            // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø¯ÙˆØ±Ø¨ÛŒÙ†
            cameraSystem.init();
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
            loadGameData();
            
            // ØªÙ†Ø¸ÛŒÙ… Ø¨Ø§Ø²ÛŒ
            setupGame();
        }
        
        function startGame() {
            gameState = 'PLAYING';
            document.getElementById('mainScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            document.querySelector('.fuel-indicator').classList.remove('hidden');
            document.getElementById('bombButton').classList.remove('hidden');
            document.getElementById('bombTimer').classList.remove('hidden');
            
            // Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ
            resetGame();
            gameLoop();
        }
        
        function resetGame() {
            score = 0;
            level = 1;
            coins = 0;
            fuel = 100;
            player = { x: window.innerWidth/2, y: window.innerHeight/2, size: 80 };
            enemies = [];
            coins3D = [];
            
            updateHUD();
            createPlayer();
            createCoins();
        }
        
        function createPlayer() {
            // Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ø§Ø²ÛŒÚ©Ù†
            const playerElement = document.createElement('div');
            playerElement.className = 'player pulse';
            playerElement.innerHTML = 'ğŸ›¸';
            playerElement.style.position = 'absolute';
            playerElement.style.left = (player.x - player.size/2) + 'px';
            playerElement.style.top = (player.y - player.size/2) + 'px';
            document.getElementById('gameScreen').appendChild(playerElement);
        }
        
        function createCoins() {
            // Ø§ÛŒØ¬Ø§Ø¯ Ø³Ú©Ù‡â€ŒÙ‡Ø§
            for (let i = 0; i < 10; i++) {
                const coin = document.createElement('div');
                coin.className = 'coin';
                coin.innerHTML = 'â­';
                coin.style.position = 'absolute';
                coin.style.left = (Math.random() * (window.innerWidth - 100) + 50) + 'px';
                coin.style.top = (Math.random() * (window.innerHeight - 100) + 50) + 'px';
                document.getElementById('gameScreen').appendChild(coin);
                
                coins3D.push({
                    element: coin,
                    x: parseInt(coin.style.left),
                    y: parseInt(coin.style.top),
                    collected: false
                });
            }
        }
        
        function updateHUD() {
            document.getElementById('currentScore').textContent = score;
            document.getElementById('currentLevel').textContent = level;
            document.getElementById('currentCoins').textContent = coins;
            document.querySelector('.fuel-indicator').textContent = `â›½ Ø³ÙˆØ®Øª: ${Math.round(fuel)}%`;
        }
        
        function useBomb() {
            if (bombCooldown <= 0) {
                // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¨Ù…Ø¨
                bombCooldown = 10;
                updateBombTimer();
                
                // Ù†Ø§Ø¨ÙˆØ¯ÛŒ Ø¯Ø´Ù…Ù†Ø§Ù†
                enemies.forEach(enemy => {
                    enemy.element.remove();
                });
                enemies = [];
            }
        }
        
        function updateBombTimer() {
            if (bombCooldown > 0) {
                bombCooldown -= 0.016; // Ú©Ø§Ù‡Ø´ Ø¨Ø± Ø§Ø³Ø§Ø³ ÙØ±ÛŒÙ…â€ŒØ±ÛŒØª
                document.getElementById('bombTimer').textContent = `Ø¨Ù…Ø¨: ${Math.ceil(bombCooldown)}s`;
                document.getElementById('bombButton').disabled = true;
            } else {
                document.getElementById('bombTimer').textContent = 'Ø¨Ù…Ø¨: Ø¢Ù…Ø§Ø¯Ù‡!';
                document.getElementById('bombButton').disabled = false;
            }
        }
        
        function gameLoop() {
            if (!gameRunning) return;
            
            // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¨Ø§Ø²ÛŒ
            updateGame();
            updateHUD();
            updateBombTimer();
            
            // Ø§Ø¯Ø§Ù…Ù‡ Ø­Ù„Ù‚Ù‡ Ø¨Ø§Ø²ÛŒ
            requestAnimationFrame(gameLoop);
        }
        
        function updateGame() {
            // Ú©Ø§Ù‡Ø´ Ø³ÙˆØ®Øª
            fuel = Math.max(0, fuel - 0.1);
            if (fuel <= 0) {
                gameOver();
            }
            
            // Ø­Ø±Ú©Øª Ø¯Ø´Ù…Ù†Ø§Ù†
            updateEnemies();
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø±Ø®ÙˆØ±Ø¯Ù‡Ø§
            checkCollisions();
        }
        
        function updateEnemies() {
            // Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø´Ù…Ù†Ø§Ù† Ø¬Ø¯ÛŒØ¯
            if (Math.random() < 0.02 && enemies.length < 5) {
                createEnemy();
            }
            
            // Ø­Ø±Ú©Øª Ø¯Ø´Ù…Ù†Ø§Ù† Ø¨Ù‡ Ø³Ù…Øª Ø¨Ø§Ø²ÛŒÚ©Ù†
            enemies.forEach(enemy => {
                const dx = player.x - enemy.x;
                const dy = player.y - enemy.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance > 0) {
                    enemy.x += (dx / distance) * enemy.speed;
                    enemy.y += (dy / distance) * enemy.speed;
                    
                    enemy.element.style.left = (enemy.x - 25) + 'px';
                    enemy.element.style.top = (enemy.y - 25) + 'px';
                }
            });
        }
        
        function createEnemy() {
            const enemyElement = document.createElement('div');
            enemyElement.className = 'enemy';
            enemyElement.innerHTML = 'ğŸŒ‹';
            enemyElement.style.position = 'absolute';
            
            const side = Math.floor(Math.random() * 4);
            let x, y;
            
            switch(side) {
                case 0: // Ø¨Ø§Ù„Ø§
                    x = Math.random() * window.innerWidth;
                    y = -50;
                    break;
                case 1: // Ø±Ø§Ø³Øª
                    x = window.innerWidth + 50;
                    y = Math.random() * window.innerHeight;
                    break;
                case 2: // Ù¾Ø§ÛŒÛŒÙ†
                    x = Math.random() * window.innerWidth;
                    y = window.innerHeight + 50;
                    break;
                case 3: // Ú†Ù¾
                    x = -50;
                    y = Math.random() * window.innerHeight;
                    break;
            }
            
            enemyElement.style.left = x + 'px';
            enemyElement.style.top = y + 'px';
            document.getElementById('gameScreen').appendChild(enemyElement);
            
            enemies.push({
                element: enemyElement,
                x: x,
                y: y,
                speed: 1 + level * 0.1
            });
        }
        
        function checkCollisions() {
            // Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¨Ø§ Ø³Ú©Ù‡â€ŒÙ‡Ø§
            coins3D.forEach((coin, index) => {
                if (!coin.collected) {
                    const distance = Math.sqrt(
                        Math.pow(player.x - coin.x, 2) + 
                        Math.pow(player.y - coin.y, 2)
                    );
                    
                    if (distance < player.size/2 + 22) {
                        coin.collected = true;
                        coin.element.remove();
                        coins++;
                        score += 10;
                        fuel = Math.min(100, fuel + 5);
                    }
                }
            });
            
            // Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¨Ø§ Ø¯Ø´Ù…Ù†Ø§Ù†
            enemies.forEach(enemy => {
                const distance = Math.sqrt(
                    Math.pow(player.x - enemy.x, 2) + 
                    Math.pow(player.y - enemy.y, 2)
                );
                
                if (distance < player.size/2 + 25) {
                    gameOver();
                }
            });
        }
        
        function gameOver() {
            gameRunning = false;
            saveGameData();
            
            setTimeout(() => {
                document.getElementById('mainScreen').classList.remove('hidden');
                document.getElementById('gameScreen').classList.add('hidden');
                document.querySelector('.fuel-indicator').classList.add('hidden');
                document.getElementById('bombButton').classList.add('hidden');
                document.getElementById('bombTimer').classList.add('hidden');
                
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒ
                document.querySelectorAll('.player, .enemy, .coin').forEach(el => el.remove());
            }, 1000);
        }
        
        function loadGameData() {
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
            const highScore = localStorage.getItem('highScore') || 0;
            const highLevel = localStorage.getItem('highLevel') || 1;
            const totalCoins = localStorage.getItem('totalCoins') || 0;
            
            document.getElementById('highScore').textContent = highScore;
            document.getElementById('highLevel').textContent = highLevel;
            document.getElementById('totalCoinsCollected').textContent = totalCoins;
        }
        
        function saveGameData() {
            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒ
            localStorage.setItem('highScore', Math.max(score, localStorage.getItem('highScore') || 0));
            localStorage.setItem('highLevel', Math.max(level, localStorage.getItem('highLevel') || 1));
            localStorage.setItem('totalCoins', (parseInt(localStorage.getItem('totalCoins')) || 0) + coins);
        }
        
        // ØªÙˆØ§Ø¨Ø¹ Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¯Ø§Ù„â€ŒÙ‡Ø§
        function showAchievements() {
            alert('Ø³ÛŒØ³ØªÙ… Ù…Ø¯Ø§Ù„â€ŒÙ‡Ø§ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!');
        }
        
        function showInstructions() {
            alert('Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¨Ø§Ø²ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!');
        }
        
        function showSettings() {
            alert('ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§Ø²ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!');
        }
        
        function showManagement() {
            alert('Ø§Ø·Ù„Ø§Ø¹ÛŒÙ‡ Ù…Ø¯ÛŒØ±ÛŒØª:\n\nØ¨Ø§Ø²ÛŒ Ú©Ù‡Ú©Ø´Ø§Ù†ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡\nÙ†Ø³Ø®Ù‡ 1.0\n\nÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:\nâ€¢ Ú¯Ø±Ø§ÙÛŒÚ© Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡\nâ€¢ Ø³ÛŒØ³ØªÙ… Ø¯ÙˆØ±Ø¨ÛŒÙ† Ø³ÛŒÙ†Ù…Ø§ØªÛŒÚ©\nâ€¢ Ú©Ù‡Ú©Ø´Ø§Ù† Ù¾ÙˆÛŒØ§\nâ€¢ ÙÛŒØ²ÛŒÚ© ÙˆØ§Ù‚Ø¹â€ŒÚ¯Ø±Ø§ÛŒØ§Ù†Ù‡');
        }
        
        // Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒ
        document.addEventListener('mousemove', (e) => {
            if (gameState === 'PLAYING') {
                player.x = e.clientX;
                player.y = e.clientY;
                
                // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¨Ø§Ø²ÛŒÚ©Ù†
                const playerElement = document.querySelector('.player');
                if (playerElement) {
                    playerElement.style.left = (player.x - player.size/2) + 'px';
                    playerElement.style.top = (player.y - player.size/2) + 'px';
                }
            }
        });
        
        // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        window.addEventListener('load', initGame);
        window.addEventListener('resize', setupGame);
        
        function setupGame() {
            // ØªÙ†Ø¸ÛŒÙ… Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒ
        }
    </script>
</body>
  </html>
